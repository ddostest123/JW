<?xml version="1.0" encoding="UTF-8"?>
<a:screen xmlns:a="http://www.aurora-framework.org/application" trace="true">
    <a:init-procedure outputPath="/parameter">
        <a:model-execute model="db.rpt_common_report_query_pkg.rpt_common_frequency_query"/>
        <a:model-query model="db.rpt_common_report_query_pkg.rpt_common_frequency_query" rootPath="rpt1010_bg_name"/>
        <!-- <a:model-query model="rpt.RPT1010.pur_po_rp_category_name" rootPath="rpt1010_category_name"/> -->
        <!-- <a:model-query model="rpt.RPT1010.pur_po_rp_vendor_name" rootPath="rpt1010_vendor_name"/> -->
    </a:init-procedure>
    <a:view>
        <!--css引入  -->
        <script language="JavaScript" src="${/request/@context_path}/index/js/jquery-1.8.3.min.js"/>
        <script><![CDATA[jQuery.noConflict();]]></script>
        <!-- <link href="${/request/@context_path}/css/main/main-user.css" rel="stylesheet" type="text/css"/> -->
        <!-- <link href="${/request/@context_path}/mainpage_facility/plugins/boostrapv3/css/bootstrap.min.css" rel="stylesheet" type="text/css"/> -->
        <link href="${/request/@context_path}/component/handListButton/handListButton.css" rel="stylesheet" type="text/css"/>
        <link href="${/request/@context_path}/index/css/rpt1010_view.css" rel="stylesheet" type="text/css"/>
        <script src="${/request/@context_path}/component/handListButton/handListButton.js"/>
        <!--点击报表打开的串口  -->
        <a:link id="rpt1010_5010_screen" url="${/request/@context_path}/modules/rpt/RPT1010/pur_po_item_rpt.screen"/>
        <a:link id="rpt1010_5020_screen" url="${/request/@context_path}/modules/rpt/RPT1010/pur_po_vender_rpt.screen"/>
        <a:link id="rpt1010_5030_screen" url="${/request/@context_path}/modules/rpt/RPT1010/pur_po_item_list_rpt.screen"/>
        <a:link id="rpt1010_5040_screen" url="${/request/@context_path}/modules/rpt/RPT1010/pur_po_vender_list.screen"/>
        <a:link id="rpt1010_5050_screen" url="${/request/@context_path}/modules/rpt/RPT1010/pur_po_item_org_form.screen"/>
        <a:link id="rpt1010_5060_screen" url="${/request/@context_path}/modules/rpt/RPT1010/pur_po_item_vender_form.screen"/>
        <a:link id="rpt1010_btn_refresh_link" model="db.rpt_common_report_query_pkg.rpt_common_frequency_query" modelaction="execute"/>
        <style type="text/css"><![CDATA[
           .body_class{
               width:100%;
               padding:20px;
               overflow:hidden; 
           }
           .column{
               width:46.5%;
               float:left;
               //margin-left:3.5%;
           }
           /* .column_right{
               width:45%;
               float:right;
           } */
           .widget{
               position:relative;
               display:block;
               width:100%;
               margin-top:0px;
               margin-bottom:20px;
               top:0;
               left:0;
               overflow:hidden;
           }
           .red{
               border:1px solid #DE577B
           }
           .yellow{
               border:1px solid #FFB400
           }
           .green{
               border:1px solid #74B749
           }
           .purple{
               border:1px solid #9D4A9C
           }
           .blue{
               border:1px solid #1B76AD
           }
           .black{
               border:1px solid #404040
           }
           .widget_title{
               position:relative;
               color:#fff;
               height:36px;
               width:100%;
               cursor:move;
               top:0;
               left:0;
           }
           .widget.red .widget_title{
               background-color:#DE577B;
           }
           .widget.yellow .widget_title{
               background-color:#FFB400;
           }
           .widget.green .widget_title{
               background-color:#74B749;
           }
           .widget.purple .widget_title{
               background-color:#9D4A9C;
           }
           .widget.blue .widget_title{
               background-color:#1B76AD;
           }
           .widget.black .widget_title{
               background-color:#404040;
           }
           .title_left{
               float:left;
               font-size:14px;
               padding:7.5px 5px 7.5px 10px
           }
           .title_left i{
               display:inline-block
           }
           .title_left div{
               display:inline-block;
               margin-left:5px
           }
           .title_right{
               float:right;
               padding:11px 5px 11px 10px;
               cursor:pointer
           }
           .title_right i{
               margin-right:8px;
               font-size:14px
           }
           .widget_body{
               padding:5px;
           }
           .dashed_div{
               position:relative;
               border:1px dashed #000;
               background-color:#E1E1DA;
           }
        ]]></style>
        <script><![CDATA[
            var rpt1010_btn_click_flag = 0;
            var rpt1010_category_name_index = -1;
            var rpt1010_vendor_name_index = -1;
            
            function rpt1010_lock_current_window() {
                Aurora.Masker.mask(Ext.getBody(), '${l:RPT.RPT_IS_OPERATING}');
            }
            
            function rpt1010_unlock_current_window() {
                Aurora.Masker.unmask(Ext.getBody());
            }
            
            function rpt1010_refrsh() {
                rpt1010_lock_current_window();
                rpt1010_btn_click_flag = 1;
                rpt1010_category_name_index = -1;
                rpt1010_vendor_name_index = -1;
                Aurora.request({
                    url: $('rpt1010_btn_refresh_link').getUrl() + '?p_btn_click_flag=' + rpt1010_btn_click_flag,
                    success: function() {
                        rpt1010_query_init();
                    },
                    scope: this
                });
            }
            
            function rpt1010_query_init() {
                var chart_ds;
                var name_ds;
                initTab();
                name_ds = $('rpt1010_5010_data_option');
                //name_ds.query();
                chart_ds = $('rpt1010_5010_chart_data_ds');
                chart_ds.query();
                name_ds = $('rpt1010_5020_data_option');
                //name_ds.query();
                chart_ds = $('rpt1010_5020_chart_data_ds');
                chart_ds.query();
                chart_ds = $('rpt1010_5030_chart_data_ds');
                chart_ds.query();
                chart_ds = $('rpt1010_5040_chart_data_ds');
                chart_ds.query();
                chart_ds = $('rpt1010_5050_chart_data_ds');
                chart_ds.query();
                chart_ds = $('rpt1010_5060_chart_data_ds');
                chart_ds.query();
                rpt1010_unlock_current_window();
            }
            
            //点击报表打开新窗口
            
            function rpt1010_btn1() {
                new Aurora.Window({
                    id: 'rpt1010_go5010_screen',
                    title: '${l:RPT.RPT1010_ITEM_DEVELOPE_ANALYSE_RPT}',
                    url: $('rpt1010_5010_screen').getUrl(),
                    fullScreen: true
                });
            }
            
            function rpt1010_btn2() {
                new Aurora.Window({
                    id: 'rpt1010_go5020_screen',
                    title: '${l:RPT.RPT1010_VENDOR_DEVELOPE_ANALYSE_RPT}',
                    url: $('rpt1010_5020_screen').getUrl(),
                    fullScreen: true
                });
            }
            
            function rpt1010_btn3() {
                new Aurora.Window({
                    id: 'rpt1010_go5030_screen',
                    title: '${l:RPT.RPT1010_ITEM_LIST_RPT}',
                    url: $('rpt1010_5030_screen').getUrl(),
                    fullScreen: true
                });
            }
            
            function rpt1010_btn4() {
                new Aurora.Window({
                    id: 'rpt1010_go5040_screen',
                    title: '${l:RPT.RPT1010_VENDOR_LIST_RPT}',
                    url: $('rpt1010_5040_screen').getUrl(),
                    fullScreen: true
                });
            }
            
            function rpt1010_btn5() {
                new Aurora.Window({
                    id: 'rpt1010_go5050_screen',
                    title: '${l:RPT.RPT1010_ITEM_ORG_FORM_RPT}',
                    url: $('rpt1010_5050_screen').getUrl(),
                    fullScreen: true
                });
            }
            
            function rpt1010_btn6() {
                new Aurora.Window({
                    id: 'rpt1010_go5060_screen',
                    title: '${l:RPT.RPT1010_VENDOR_ORG_FORM_RPT}',
                    url: $('rpt1010_5060_screen').getUrl(),
                    fullScreen: true
                });
            }
            
            //鼠标滑过报表内容时显示的信息
            
            function rpt1010_formatter2() {
                return '<b>' + rpt1010_substr(this.point.name, 0, 5) + '</b>: ' + Aurora.formatNumber(this.percentage, 2) + ' %';
            }
            
            function rpt1010_formatter1() {
                return '<b>' + this.x + '</b><br/>' + this.series.name + ': ' + this.y + '万';
            }
            
            function rpt1010_label_format1() {
                var name_ds = $('rpt1010_5010_data_option').getAll();
                rpt1010_category_name_index++;
                return rpt1010_substr(name_ds[rpt1010_category_name_index].get('category_name'), 0, 5);
            }
            
            function rpt1010_label_format2() {
                var name_ds = $('rpt1010_5020_data_option').getAll();
                rpt1010_vendor_name_index++;
                return rpt1010_substr(name_ds[rpt1010_vendor_name_index].get('vendor_name'), 0, 5);
            }
            
            //截取过长的字符串,第一个字符的起始位置为0
            
            function rpt1010_substr(str, begin, length) {
                if (str.length - begin > length) {
                    return str.substr(begin, length) + '...';
                } else {
                    return str.substr(begin);
                }
            }
            
            function rpt1010_column_label_format1() {
                return rpt1010_substr(this.value, 0, 5);
            }
            
            function rpt1010_toolFormat1() {
                var html = ['<table><caption>', this.x, '</caption><br>'];
                var name_ds = $('rpt1010_5010_data_option').getAll();
                var y;
                for (var i = 0;i < this.points.length;i++) {
                    html.push('<tr>', '<td style="color:', this.points[i].series.color, '">', rpt1010_substr(name_ds[i].get('category_name'), 0, 5), ': ', '</td>', '<td style="text-align:right"><b>', this.points[i].y, '万</b></td>', '</tr><br>');
                }
                html.push('</table>');
                return html.join('');
            }
            
            function rpt1010_toolFormat2() {
                var html = ['<table><caption>', this.x, '</caption><br>'];
                var name_ds = $('rpt1010_5020_data_option').getAll();
                for (var i = 0;i < this.points.length;i++) {
                    html.push('<tr>', '<td style="color:', this.points[i].series.color, '">', rpt1010_substr(name_ds[i].get('vendor_name'), 0, 5), ': ', '</td>', '<td style="text-align:right"><b>', this.points[i].y, '万</b></td>', '</tr><br>');
                }
                html.push('</table>');
                return html.join('');
            }
            
            var rpt1010_tabObj = {
                beforeDisplayTgr: null,
                CurrentDisplayTgr: null,
                titleTgr: null
            };
            
            function initTab() {
                rpt1010_tabObj.beforeDisplayTgr = window.document.getElementById("rpt1010_tab_son1");
                rpt1010_tabObj.CurrentDisplayTgr = window.document.getElementById("rpt1010_tab_son1");
                rpt1010_tabObj.titleTgr = window.document.getElementById("rpt1010_tab_son1_title");
            }
            
            function rpt1010_changeTabSon(e) {
                var tgr = e.target || e.srcElement;
                if (tgr.tagName == 'LI') {
                    var id = tgr.getAttribute('contentId');
                    rpt1010_tabObj.tabCurrentDisplayTgr = window.document.getElementById(id);
                    if (rpt1010_tabObj.beforeDisplayTgr == rpt1010_tabObj.tabCurrentDisplayTgr) {
                        return;
                    }
                    rpt1010_tabObj.beforeDisplayTgr.style.display = 'none';
                    rpt1010_tabObj.tabCurrentDisplayTgr.style.display = 'block';
                    rpt1010_tabObj.tabCurrentDisplayTgr.style.marginTop = '0';
                    rpt1010_tabObj.beforeDisplayTgr = rpt1010_tabObj.tabCurrentDisplayTgr;
            
                    //改变标题的边框
                    rpt1010_tabObj.titleTgr.style.borderTopWidth = "0px";
                    rpt1010_tabObj.titleTgr.style.borderBottomWidth = "0px";
                    rpt1010_tabObj.titleTgr.style.borderLeftWidth = "0px";
                    rpt1010_tabObj.titleTgr.style.borderRightWidth = "0px";
                    rpt1010_tabObj.titleTgr.style.color = "#fff";
                    rpt1010_tabObj.titleTgr.style.paddingTop = "13px";
                    rpt1010_tabObj.titleTgr.style.backgroundColor = "#E9683D";
                    tgr.style.paddingBottom = "0px";
            
                    tgr.style.borderBottomWidth = "0px";
                    tgr.style.borderTopWidth = "0px";
                    if (id == 'rpt1010_tab_son1') {
                        tgr.style.borderLeftWidth = "0px";
                    } else {
                        tgr.style.borderLeftWidth = "0px";
                    }
            
                    tgr.style.borderRightWidth = "0px";
                    tgr.style.backgroundColor = "#fff";
                    /* tgr.style.paddingTop = "9px";
                     tgr.style.paddingBottom = "6px"; */
                    tgr.style.color = "#F37B53";
                    rpt1010_tabObj.titleTgr = tgr;
                }
            }
            
            function rpt1010_rightButton_showList() {
                /* if (document.getElementById('rpt1010_right_click_table').style.display == 'none') {
                 document.getElementById('rpt1010_right_click_table').style.display = "block";
                 } else {
                 document.getElementById('rpt1010_right_click_table').style.display = 'none';
                 } */
                jQuery("#rpt1010_right_click_table").slideToggle("middle");
            }
            
            function rpt1010_leftTable_trList_click(element) {
                //alert(element.id);
                var display = document.getElementById(element.id + '_id').style.display;
                if (display == 'none') {
                    document.getElementById(element.id + '_id').style.display = 'table-row';
                    document.getElementById(element.id + '_icon1').className = 'fa fa-minus';
                } else {
                    document.getElementById(element.id + '_id').style.display = 'none';
                    document.getElementById(element.id + '_icon1').className = 'fa fa-plus';
                }
            }
            
            /*
             ***************************************************************
             *收展和关闭操作
             ***************************************************************
             */
            
            var rpt1010_Interval;
            var rpt1010_Inter_height;
            var rpt1010_all_height;
            var rpt1010_Interval_time;
            
            function rpt1010_small(id) {
                var _this = jQuery('#' + id).parent();
                var height = _this.height();
                if (height <= 36) {
                    clearInterval(rpt1010_Interval);
                } else {
                    _this.css('height', height - rpt1010_Inter_height + 'px');
                    rpt1010_move();
                }
            }
            
            function rpt1010_big(id) {
                var _this = jQuery('#' + id).parent();
                var height = _this.height();
                if (height >= rpt1010_all_height) {
                    clearInterval(rpt1010_Interval);
                } else {
                    _this.css('height', height + rpt1010_Inter_height + 'px');
                    rpt1010_move();
                }
            }
            
            //收展元素
            
            function rpt1010_list_func(element) {
                var id = 'rpt1010_columnRow_content_' + element.id.substr(18, 2);
                /* jQuery("#" + id).slideToggle("middle", function() {
                 rpt1010_move();
                 }); */
                if (element.className == 'fa fa-chevron-up') {
                    rpt1010_Inter_height = (jQuery('#' + id).parent().height() - 36) / 10;
                    rpt1010_all_height = jQuery('#' + id).parent().height();
                    rpt1010_Interval = setInterval(function() {
                        rpt1010_small(id);
                    }, 20);
                } else {
                    rpt1010_Interval = setInterval(function() {
                        rpt1010_big(id);
                    }, 20);
                }
                element.className = (element.className == 'fa fa-chevron-up') ? 'fa fa-chevron-down' : 'fa fa-chevron-up';
            }
            
            
            //删除元素
            
            function rpt1010_close_func(element) {
                var id = 'rpt1010_columnRow_' + element.id.substr(18, 2);
                jQuery("#" + id).css('display', 'none');
                //将删除的元素id在全局布局数组中的x置0,y之后的元素上移
                var index = rpt1010_search_indexInLocation_byId(id);
                var x = rpt1010_global_loaction[index].x;
                for (var i = 0;i < rpt1010_global_loaction.length;i++) {
                    if (rpt1010_global_loaction[i].x == x) {
                        rpt1010_global_loaction[i].y--;
                    }
                }
                rpt1010_global_loaction[index].x = 0;
                //rpt1010_global_loaction[index].close = true;
                rpt1010_move();
            }
            
            //元素收展后其他元素的布局准则
            
            function rpt1010_move() {
                var _top = jQuery('.body_class').offset().top + 20;
                var id;
                var top;
                var j;
                var m_index;
                var m_this;
                var m_height;
                for (var i = 0;i < rpt1010_global_loaction.length;i++) {
                    if (rpt1010_global_loaction[i].x == 1) {
                        //收展后其正下方元素上移
                        top = 0;
                        for (j = 1;j < rpt1010_global_loaction[i].y;j++) {
                            m_index = rpt1010_search_indexInLocation_byxy(1, j);
                            m_this = jQuery('#' + rpt1010_global_loaction[m_index].id);
                            top += m_this.height() + 22;
                        }
                        id = rpt1010_global_loaction[i].id;
                        jQuery('#' + id).offset({
                            top: _top + top
                        });
                    } else if (rpt1010_global_loaction[i].x == 2) {
                        //收展元素另外一列的下方元素不位移
                        top = 0;
                        for (j = 1;j < rpt1010_global_loaction[i].y;j++) {
                            m_index = rpt1010_search_indexInLocation_byxy(2, j);
                            m_this = jQuery('#' + rpt1010_global_loaction[m_index].id);
                            m_height = 22 + m_this.height();
                            top += m_height;
                        }
                        id = rpt1010_global_loaction[i].id;
                        jQuery('#' + id).offset({
                            top: _top + top
                        });
                    }
                }
            }
            
            /*
             ***************************************************************
             *实现网页元素可拖拽功能
             *可拖拽的目标为class=widget_title的父元素
             *可拖拽的地方为class=widget_title的元素
             *参数rpt1010_move_flag：判断是否可移动的标志
             *参数rpt1010_dragWidget_this：当前移动的网页元素
             ***************************************************************
             */
            var rpt1010_move_flag = true;
            var rpt1010_dragWidget_this;
            var rpt1010_dragTitle_height = 37;
            var rpt1010_dragWidget_document = jQuery('#rpt1010_tab_son1');
            var rpt1010_global_loaction = [];
            var rpt1010_dragMouse_moveLocation = [];
            var rpt1010_dragMouse_inLocation = [];
            rpt1010_init_global_loaction();
            rpt1010_dragWidget_mouseDown();
            rpt1010_dragWidget_mouseUp();
            
            //初始化全局可移动组件的定位数据
            function rpt1010_init_global_loaction() {
                jQuery('.column').children().each(function() {
                    var obj = jQuery(this);
                    var id = obj.attr('id');
                    rpt1010_global_loaction.push({
                        id: id,
                        x: parseInt(id.substr(18, 1)),
                        y: parseInt(id.substr(19, 1)),
                        close: false
                    });
                });
            }
            
            //根据id查找在rpt1010_swap_location的位置
            
            function rpt1010_search_indexInLocation_byId(id) {
                for (var i = 0;i < rpt1010_global_loaction.length;i++) {
                    if (rpt1010_global_loaction[i].id == id) {
                        return i;
                    }
                }
                return -1;
            }
            
            //根据想x，y位置查找在rpt1010_swap_location的位置
            
            function rpt1010_search_indexInLocation_byxy(x, y) {
                for (var i = 0;i < rpt1010_global_loaction.length;i++) {
                    if (rpt1010_global_loaction[i].x == x && rpt1010_global_loaction[i].y == y) {
                        return i;
                    }
                }
                return -1;
            }
            
            //交换位置时修改全局定位数据
            
            function rpt1010_swap_location(id_1, id_2) {
                var id_1_index = rpt1010_search_indexInLocation_byId(id_1);
                var id_2_index = rpt1010_search_indexInLocation_byId(id_2);
                var swap_x;
                var swap_y;
                swap_x = rpt1010_global_loaction[id_1_index].x;
                swap_y = rpt1010_global_loaction[id_1_index].y;
                rpt1010_global_loaction[id_1_index].x = rpt1010_global_loaction[id_2_index].x;
                rpt1010_global_loaction[id_1_index].y = rpt1010_global_loaction[id_2_index].y;
                rpt1010_global_loaction[id_2_index].x = swap_x;
                rpt1010_global_loaction[id_2_index].y = swap_y;
            }
            
            //鼠标按下时触发的事件
            
            function rpt1010_dragWidget_mouseDown() {
                jQuery('.widget_title').mousedown(function(e) {
                    //排除非鼠标左击情况
                    var tgr = e.target || e.srcElement;
                    if (e.which != 1 || tgr.tagName == 'I') {
                        return;
                    } else {
                        var id = jQuery(this).parent().attr('id');
                        var _this = jQuery(this).parent();
                        rpt1010_dragWidget_this = _this;
                        var x = e.pageX;
                        var y = e.pageY;
                        var offset_left = _this.offset().left;
                        var offset_top = _this.offset().top;
                        var width = _this.width();
                        var height = _this.height();
                        rpt1010_move_flag = true;
                        //在抬起的元素的位置上建立虚线框
                        rpt1010_dragWidget_setdashed_div(width, height, offset_left, offset_top);
                        //鼠标移动时操作
                        jQuery(document).mousemove(function(e) {
                            if (rpt1010_move_flag && rpt1010_dragWidget_beyond(e)) {
                                var _this = rpt1010_dragWidget_this;
                                var left = _this.offset().left;
                                var top = _this.offset().top;
                                var l = e.pageX - x; //移动后的相对容器的x距离
                                var t = e.pageY - y; //移动后的相对容器的y距离
                                //移动抬起的元素块
                                rpt1010_dragWidget_this.offset({
                                    left: l + offset_left,
                                    top: t + offset_top
                                });
                                var ml = offset_left + l + width / 2;
                                var mt = offset_top + t + height / 2;
                                //遍历所有子元素，判断在元素移动时时候挤压到其他元素。并进行交换位置操作
                                rpt1010_dragWidget_pushOther_div(_this, ml, mt);
                            }
                        });
                    }
                });
            }
            
            //在移动的元素的位置上加入虚线框
            
            function rpt1010_dragWidget_setdashed_div(width, height, offset_left, offset_top) {
                //设置虚线框样式
                var div = document.createElement("div");
                div.id = "rpt1010_mr_holder";
                div.className = 'dashed_div';
                div.style.height = height + 'px';
                div.style.width = width + 'px';
                div.style.marginBottom = '20px';
                rpt1010_dragWidget_this.after(div);
                var mr = jQuery('#rpt1010_mr_holder');
                //将虚线框的id代替移动的元素的id
                var index = rpt1010_search_indexInLocation_byId(rpt1010_dragWidget_this.attr('id'));
                rpt1010_global_loaction[index].id = 'rpt1010_mr_holder';
                //设置抬起元素的样式，及位置
                rpt1010_dragWidget_this.css({
                    'position': 'absolute',
                    'z-index': 99,
                    "opacity": "0.75",
                    'width': width,
                    'height': height
                });
                rpt1010_dragWidget_this.offset({
                    left: offset_left,
                    top: offset_top
                });
                //设置虚线框位置
                mr.offset({
                    left: offset_left,
                    top: offset_top
                });
            }
            
            //拖动元素块是发生挤压其他元素块
            
            function rpt1010_dragWidget_pushOther_div(_this, ml, mt) {
                jQuery('.column').children().not(_this).not(jQuery('#rpt1010_mr_holder')).each(function() {
                    var obj = jQuery(this);
                    var obj_id = obj.attr('id');
                    var p = obj.offset(); //块的相对坐标组
                    var a1 = p.left; //块相对左
                    var a2 = p.left + obj.width(); //块右下角相对左
                    var a3 = p.top; //块相对上
                    var a4 = p.top + obj.height(); //块右下角相对上
                    if (ml > a1 && ml < a2 && mt > a3 && mt < a4) {
                        if (rpt1010_dragMouse_moveLocation != '') {
                            //判断将要移动的元素在虚线框的方位
                            var index_mr = rpt1010_search_indexInLocation_byId('rpt1010_mr_holder');
                            var index_wg = rpt1010_search_indexInLocation_byId(obj_id);
                            var direc_mr = [rpt1010_global_loaction[index_mr].x, rpt1010_global_loaction[index_mr].y];
                            var direc_wg = [rpt1010_global_loaction[index_wg].x, rpt1010_global_loaction[index_wg].y];
                            if (!rpt1010_dragWidge_loaction(direc_mr, direc_wg, ml, mt)) {
                                return;
                            }
                        }
                        //挤压容器,和虚线框互换位置
                        rpt1010_change_position(obj);
                        //记录
                        rpt1010_dragMouse_moveLocation = [ml, mt];
                    }
                });
            }
            
            //判断挤压元素时，虚线框的移动方位（上下左右）对应1234
            function rpt1010_dragWidge_loaction(direc1, direc2, ml, mt) {
                var x_dis = direc2[0] - direc1[0];
                var y_dis = direc2[1] - direc1[1];
                var x_m = ml - rpt1010_dragMouse_moveLocation[0];
                var y_m = mt - rpt1010_dragMouse_moveLocation[1];
                if (x_dis * x_m >= 0 && y_dis * y_m >= 0) {
                    return true;
                }
            }
            
            //判断拖动时是否移出规定的页面，若是则返回
            
            function rpt1010_dragWidget_beyond(e) {
                var x = e.pageX;
                var y = e.pageY;
                var documentP = rpt1010_dragWidget_document.offset();
                var left = documentP.left;
                var right = documentP.left + rpt1010_dragWidget_document.width();
                var top = documentP.top;
                var bottom = documentP.top + rpt1010_dragWidget_document.height();
                if (x > right || x < left || y > bottom || y < top) {
                    rpt1010_drageWidget_back();
                    return false;
                } else {
                    return true;
                }
            }
            
            //选定元素与虚线框交换位置
            
            function rpt1010_change_position(obj) {
                var _this = jQuery('#rpt1010_mr_holder');
                var p_this = _this.offset();
                var p_obj = obj.offset();
                var p_turn = p_obj;
                obj.offset(p_this);
                _this.offset(p_turn);
                rpt1010_dragWidget_this.css('z-index', '99');
                rpt1010_swap_location(obj.attr('id'), 'rpt1010_mr_holder');
                rpt1010_move();
            }
            
            //元素抬起时触发的事件
            
            function rpt1010_dragWidget_mouseUp() {
                jQuery('.widget_title').mouseup(function(e) {
                    var tgr = e.target || e.srcElement;
                    if (e.which != 1 || tgr.tagName == 'I') {
                        return;
                    }
                    rpt1010_drageWidget_back();
                });
            }
            
            //设置被拖动的网页元素回归原位置（虚线框）
            
            function rpt1010_drageWidget_back() {
                var _this = rpt1010_dragWidget_this;
                var _mr_holder = jQuery('#rpt1010_mr_holder');
                rpt1010_move_flag = false;
                //将移动的元素放回虚线框内
                var p_mr = _mr_holder.offset();
                var p_mr_top = p_mr.top;
                var p_mr_left = p_mr.left;
                _this.attr('style', 'height:'+_this.height()+'px');
                _this.offset(p_mr);
                _mr_holder.remove();
                //在全局布局数据中将放下的元素id取代虚线框的id
                var index = rpt1010_search_indexInLocation_byId('rpt1010_mr_holder');
                rpt1010_global_loaction[index].id = rpt1010_dragWidget_this.attr('id');
                rpt1010_dragMouse_moveLocation = [];
            }
        ]]></script>
        <a:dataSets>
            <a:dataSet id="rpt1010_5010_chart_data_ds" fetchAll="true" queryUrl="modules/rpt/RPT1010/rpt_commom_report_category_query.svc">
                <a:fields>
                    <a:field name="period_name" prompt="RPT.RPT_PERIOD_NAME"/>
                </a:fields>
            </a:dataSet>
            <a:dataSet id="rpt1010_5010_data_option" autoQuery="true" fetchAll="true" model="rpt.RPT1010.pur_po_rp_category_name"/>
            <a:dataSet id="rpt1010_5020_chart_data_ds" fetchAll="true" queryUrl="modules/rpt/RPT1010/rpt_commom_report_vendor_query.svc">
                <a:fields>
                    <a:field name="period_name" prompt="RPT.RPT_PERIOD_NAME"/>
                </a:fields>
            </a:dataSet>
            <a:dataSet id="rpt1010_5020_data_option" autoQuery="true" fetchAll="true" model="rpt.RPT1010.pur_po_rp_vendor_name"/>
            <a:dataSet id="rpt1010_5030_chart_data_ds" fetchAll="true" model="rpt.RPT1010.pur_po_rp_column_chart_datas">
                <a:fields>
                    <a:field name="item_category_name" prompt="RPT.RPT_ITEM_CATEGORY_NAME"/>
                    <a:field name="total_amount" prompt="累计交易金额"/>
                </a:fields>
            </a:dataSet>
            <a:dataSet id="rpt1010_5040_chart_data_ds" fetchAll="true" model="rpt.RPT1010.pur_po_rp_vendor_column_chart_datas">
                <a:fields>
                    <a:field name="vendor_name" prompt="RPT.RPT_VENDOR_NAME"/>
                    <a:field name="total_amount" prompt="累计交易金额"/>
                </a:fields>
            </a:dataSet>
            <a:dataSet id="rpt1010_5050_chart_data_ds" fetchAll="true" model="rpt.RPT1010.pur_po_rp_pie_chart_datas">
                <a:fields>
                    <a:field name="company_short_name" prompt="公司"/>
                    <a:field name="total_ratio" prompt="占总采购额比重"/>
                </a:fields>
            </a:dataSet>
            <a:dataSet id="rpt1010_5060_chart_data_ds" fetchAll="true" model="rpt.RPT1010.pur_po_rp_vendor_pie_chart_datas">
                <a:fields>
                    <a:field name="vendor_name" prompt="供应商"/>
                    <a:field name="total_ratio" prompt="占总采购额比重"/>
                </a:fields>
            </a:dataSet>
        </a:dataSets>
        <div class="rpt1010_bg">
            <div style="width:100%;margin:0 auto">
                <div style="overflow:auto;height:100%;">
                    <table style="width:100%;border-collapse:collapse;">
                        <tr>
                            <td class="rpt1010_leftSide" style="padding:0">
                                <div class="rpt1010_leftSide_head">
                                    <img src="${/request/@context_path}/index/images/HandIcon-1.png" style="width:180px"/>
                                </div>
                                <div class="rpt1010_leftSide_body">
                                    <table id="rpt1010_left_click_table" class="rpt1010_leftSide_bodyTable">
                                        <tr id="rpt1010_leftTable_trList1" onclick="rpt1010_leftTable_trList_click(this)" style="height:60px">
                                            <td class="chart_icon_td">
                                                <i class="fa fa-line-chart"/>
                                            </td>
                                            <td class="content_td"><![CDATA[
                                                折线图报表
                                            ]]></td>
                                            <td class="list_icon_td">
                                                <i id="rpt1010_leftTable_trList1_icon1" class="fa fa-plus"/>
                                            </td>
                                        </tr>
                                        <tr id="rpt1010_leftTable_trList1_id" style="display:none">
                                            <td colspan="3">
                                                <table class="rpt1010_leftSide_bodyTable">
                                                    <tr>
                                                        <td style="width:28%;text-align:right">
                                                            <i class="fa fa-caret-right" style="font-size:14px;"/>
                                                        </td>
                                                        <td style="padding-left:10px"><![CDATA[折线图报表1]]></td>
                                                    </tr>
                                                    <tr>
                                                        <td style="width:28%;text-align:right">
                                                            <i class="fa fa-caret-right" style="font-size:14px;"/>
                                                        </td>
                                                        <td style="padding-left:10px"><![CDATA[折线图报表2]]></td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                        <tr style="height:60px">
                                            <td class="chart_icon_td">
                                                <i class="fa fa-bar-chart"/>
                                            </td>
                                            <td class="content_td"><![CDATA[
                                                柱状图报表
                                            ]]></td>
                                            <td class="list_icon_td">
                                                <i class="fa fa-plus"/>
                                            </td>
                                        </tr>
                                        <tr style="height:60px">
                                            <td class="chart_icon_td">
                                                <i class="fa fa-pie-chart"/>
                                            </td>
                                            <td class="content_td"><![CDATA[
                                                饼状图报表
                                            ]]></td>
                                            <td class="list_icon_td">
                                                <i class="fa fa-plus"/>
                                            </td>
                                        </tr>
                                        <tr style="height:60px">
                                            <td class="chart_icon_td">
                                                <i class="fa fa-area-chart"/>
                                            </td>
                                            <td class="content_td"><![CDATA[
                                                所有图报表
                                            ]]></td>
                                            <td class="list_icon_td">
                                                <i class="fa fa-plus"/>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                                <div class="rpt1010_leftSide_end">
                                    <table id="rpt1010_left_click_table2" class="rpt1010_leftSide_bodyTable">
                                        <tr style="height:60px;">
                                            <td class="chart_icon_td">
                                                <i class="fa fa-cog"/>
                                            </td>
                                            <td style="font-size:14px;text-align:left;width:75%"><![CDATA[
                                                仪表盘设置
                                            ]]></td>
                                        </tr>
                                    </table>
                                </div>
                            </td>
                            <td style="padding:0">
                                <div style="width:100%;">
                                    <div class="rpt1010_title">
                                        <div style="float:left">
                                            <table style="margin-left:10px">
                                                <tr style="height:80px;width:100%">
                                                    <td>
                                                        <i class="fa fa-users" style="font-size:60px;color:#fff"/>
                                                    </td>
                                                    <td>
                                                        <div style="height:30px;font-size:14px;color:#fff"><![CDATA[
                                                       ${/model/rpt1010_bg_name/record/@business_group_name}
                                                    ]]></div>
                                                    </td>
                                                </tr>
                                            </table>
                                        </div>
                                        <div class="rpt1010_title_refresh" onclick="rpt1010_refrsh()" style=""><![CDATA[
                                           <i class="fa fa-refresh" style="font-size:30px;color:#fff"></i>
                                           刷新
                                        ]]></div>
                                    </div>
                                    <div style="width:100%;overflow:hidden">
                                        <div class="rpt1010_body_left">
                                            <div style="width:100%;overflow:hidden">
                                                <div class="tab_title">
                                                    <ul onclick="rpt1010_changeTabSon(event);">
                                                        <li id="rpt1010_tab_son1_title" contentId="rpt1010_tab_son1"><![CDATA[报表概览]]></li>
                                                        <li contentId="rpt1010_tab_son2"><![CDATA[报表分析]]></li>
                                                        <li contentId="rpt1010_tab_son3"><![CDATA[报表类型3]]></li>
                                                    </ul>
                                                </div>
                                                <div id="rpt1010_tab_son1" class="tab_content" style="display:block;width:100%;overflow:hidden">
                                                    <div class="body_class">
                                                        <div class="column">
                                                            <div id="rpt1010_columnRow_11" class="widget red" style="opacity:1;">
                                                                <div id="rpt1010_widget_title" class="widget_title">
                                                                    <div class="title_left">
                                                                        <i class="fa fa-pencil-square-o"/>
                                                                        <div><![CDATA[报表]]></div>
                                                                    </div>
                                                                    <div class="title_right">
                                                                        <i id="rpt1010_columnRow_11_list_id" class="fa fa-chevron-up" onclick="rpt1010_list_func(this)"/>
                                                                        <i id="rpt1010_columnRow_11_close_id" class="fa fa-times" onclick="rpt1010_close_func(this)"/>
                                                                    </div>
                                                                </div>
                                                                <div id="rpt1010_columnRow_content_11" class="widget_body">
                                                                    <a:chart backgroundColor="" bindTarget="rpt1010_5010_chart_data_ds" borderWidth="0" height="260" plotBackgroundColor="" plotBorderWidth="0" style="width:100%" zoomType="x,y">
                                                                        <a:title style="font-weight:normal;font-size:14px;font-family:Microsoft YaHei" text="采购品交易额发展分析" x="25"/>
                                                                        <a:legend align="right" borderWidth="1" floating="true" labelFormatter="rpt1010_label_format1" layout="vertical" verticalAlign="top"/>
                                                                        <a:xAxis>
                                                                            <a:xAxi name="period_name" gridLineWidth="0" tickLength="0">
                                                                                <a:plotBands>
                                                                                    <a:plotBand color="rgba(68,170,213,.2)" from="4.5" to="6.5"/>
                                                                                </a:plotBands>
                                                                                <a:labels rotation="-45" style="font-weight:normal;font-size:12px;font-family:Microsoft YaHei"/>
                                                                            </a:xAxi>
                                                                        </a:xAxis>
                                                                        <a:yAxis>
                                                                            <a:yAxi name="category_name" bindTarget="rpt1010_5010_data_option" gridLineWidth="1" minorGridLineWidth="0" tickLength="0">
                                                                                <a:title style="font-size:12px;font-family:Microsoft YaHei" text="本期数量（万元）"/>
                                                                            </a:yAxi>
                                                                        </a:yAxis>
                                                                        <a:tooltip formatter="rpt1010_toolFormat1" shared="true" valueSuffix="RPT.RPT1010_TEN_THOUSANDS"/>
                                                                        <a:seriesList name="total_amount">
                                                                            <a:seriesItem>
                                                                                <a:fillColor linearGradient="0,0,0,300" stops="[0,Aurora.Charts.getOptions().colors[0]],                                            [1,Aurora.Charts.Color(Aurora.Charts.getOptions().colors[0]).setOpacity(0).get(&apos;rgba&apos;)]"/>
                                                                            </a:seriesItem>
                                                                        </a:seriesList>
                                                                        <a:events>
                                                                            <a:event name="click" handler="rpt1010_btn1"/>
                                                                        </a:events>
                                                                    </a:chart>
                                                                </div>
                                                            </div>
                                                            <div id="rpt1010_columnRow_12" class="widget yellow">
                                                                <div class="widget_title">
                                                                    <div class="title_left">
                                                                        <i class="fa fa-pencil-square-o"/>
                                                                        <div><![CDATA[报表]]></div>
                                                                    </div>
                                                                    <div class="title_right">
                                                                        <i id="rpt1010_columnRow_12_list_id" class="fa fa-chevron-up" onclick="rpt1010_list_func(this)"/>
                                                                        <i id="rpt1010_columnRow_12_close_id" class="fa fa-times" onclick="rpt1010_close_func(this)"/>
                                                                    </div>
                                                                </div>
                                                                <div id="rpt1010_columnRow_content_12" class="widget_body">
                                                                    <a:chart backgroundColor="" bindTarget="rpt1010_5030_chart_data_ds" borderWidth="0" height="260" plotBackgroundColor="" plotBorderWidth="0" style="width:100%" type="column">
                                                                        <a:title style="font-weight:normal;font-size:14px;font-family:Microsoft YaHei" text="采购品类交易额榜单"/>
                                                                        <a:xAxis>
                                                                            <a:xAxi name="item_category_name" gridLineWidth="0" tickLength="0">
                                                                                <a:labels rotation="-30" style="font-weight:normal;font-size:12px;font-family:Microsoft YaHei"/>
                                                                            </a:xAxi>
                                                                        </a:xAxis>
                                                                        <a:yAxis>
                                                                            <a:yAxi name="total_amount" allowDecimals="false" gridLineWidth="1" min="0" minorGridLineWidth="0" tickLength="0">
                                                                                <a:title style="font-size:12px;font-family:Microsoft YaHei" text="累计交易金额（万元）"/>
                                                                                <a:labels/>
                                                                            </a:yAxi>
                                                                        </a:yAxis>
                                                                        <a:tooltip formatter="rpt1010_formatter1"/>
                                                                        <a:plotOptions>
                                                                            <a:chartcolumn stacking="normal"/>
                                                                        </a:plotOptions>
                                                                        <a:events>
                                                                            <a:event name="click" handler="rpt1010_btn3"/>
                                                                        </a:events>
                                                                    </a:chart>
                                                                </div>
                                                            </div>
                                                            <div id="rpt1010_columnRow_13" class="widget green">
                                                                <div class="widget_title">
                                                                    <div class="title_left">
                                                                        <i class="fa fa-pencil-square-o"/>
                                                                        <div><![CDATA[报表]]></div>
                                                                    </div>
                                                                    <div class="title_right">
                                                                        <i id="rpt1010_columnRow_13_list_id" class="fa fa-chevron-up" onclick="rpt1010_list_func(this)"/>
                                                                        <i id="rpt1010_columnRow_13_close_id" class="fa fa-times" onclick="rpt1010_close_func(this)"/>
                                                                    </div>
                                                                </div>
                                                                <div id="rpt1010_columnRow_content_13" class="widget_body">
                                                                    <a:chart backgroundColor="" bindTarget="rpt1010_5050_chart_data_ds" borderWidth="0" height="260" plotBackgroundColor="" plotBorderWidth="null" plotShadow="false" style="width:100%" type="pie">
                                                                        <a:title style="font-weight:normal;font-size:14px;font-family:Microsoft YaHei" text="采购品各机构占比分析"/>
                                                                        <a:tooltip pointFormat="{series.name}: &lt;b&gt;{point.percentage:.1f}%&lt;/b&gt;"/>
                                                                        <a:plotOptions>
                                                                            <a:pie allowPointSelect="true" cursor="pointer">
                                                                                <a:dataLabels color="#000" connectorColor="#000" enabled="true" formatter="rpt1010_formatter2" style="font-weight:normal;font-size:12px;font-family:Microsoft YaHei"/>
                                                                            </a:pie>
                                                                        </a:plotOptions>
                                                                        <a:xAxis>
                                                                            <a:xAxi name="company_short_name"/>
                                                                        </a:xAxis>
                                                                        <a:yAxis>
                                                                            <a:yAxi name="total_ratio" allowDecimals="true"/>
                                                                        </a:yAxis>
                                                                        <a:seriesList>
                                                                            <a:seriesItem name="total_ratio">
                                                                                <a:seriesDatas>
                                                                                    <a:seriesData dataIndex="2" selected="true" sliced="true"/>
                                                                                </a:seriesDatas>
                                                                            </a:seriesItem>
                                                                        </a:seriesList>
                                                                        <a:plotOptions>
                                                                            <a:pie borderWidth="0"/>
                                                                        </a:plotOptions>
                                                                        <a:events>
                                                                            <a:event name="click" handler="rpt1010_btn5"/>
                                                                        </a:events>
                                                                    </a:chart>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="column" style="margin-left:2.7%">
                                                            <div id="rpt1010_columnRow_21" class="widget purple">
                                                                <div class="widget_title">
                                                                    <div class="title_left">
                                                                        <i class="fa fa-pencil-square-o"/>
                                                                        <div><![CDATA[报表]]></div>
                                                                    </div>
                                                                    <div class="title_right">
                                                                        <i id="rpt1010_columnRow_21_list_id" class="fa fa-chevron-up" onclick="rpt1010_list_func(this)"/>
                                                                        <i id="rpt1010_columnRow_21_close_id" class="fa fa-times" onclick="rpt1010_close_func(this)"/>
                                                                    </div>
                                                                </div>
                                                                <div id="rpt1010_columnRow_content_21" class="widget_body">
                                                                    <a:chart backgroundColor="" bindTarget="rpt1010_5020_chart_data_ds" borderWidth="0" height="260" plotBackgroundColor="" plotBorderWidth="0" style="width:100%">
                                                                        <a:title style="font-weight:normal;font-size:14px;font-family:Microsoft YaHei" text="供应商交易额发展分析"/>
                                                                        <a:legend align="right" borderWidth="1" floating="true" labelFormatter="rpt1010_label_format2" layout="vertical" verticalAlign="top"/>
                                                                        <a:xAxis>
                                                                            <a:xAxi name="period_name" gridLineWidth="0" tickLength="0">
                                                                                <a:plotBands>
                                                                                    <a:plotBand color="rgba(68,170,213,.2)" from="4.5" to="6.5"/>
                                                                                </a:plotBands>
                                                                                <a:labels rotation="-45" style="font-weight:normal;font-size:12px;font-family:Microsoft YaHei"/>
                                                                            </a:xAxi>
                                                                        </a:xAxis>
                                                                        <a:yAxis>
                                                                            <a:yAxi name="vendor_name" bindTarget="rpt1010_5020_data_option" gridLineWidth="1" minorGridLineWidth="0" tickLength="0">
                                                                                <a:title style="font-size:12px;font-family:Microsoft YaHei" text="本期数量（万元）"/>
                                                                                <a:labels/>
                                                                            </a:yAxi>
                                                                        </a:yAxis>
                                                                        <a:tooltip formatter="rpt1010_toolFormat2" shared="true" valueSuffix="RPT.RPT1010_TEN_THOUSANDS"/>
                                                                        <a:seriesList name="total_amount">
                                                                            <a:seriesItem>
                                                                                <a:fillColor linearGradient="0,0,0,300" stops="[0,Aurora.Charts.getOptions().colors[0]],                                            [1,Aurora.Charts.Color(Aurora.Charts.getOptions().colors[0]).setOpacity(0).get(&apos;rgba&apos;)]"/>
                                                                            </a:seriesItem>
                                                                        </a:seriesList>
                                                                        <a:events>
                                                                            <a:event name="click" handler="rpt1010_btn2"/>
                                                                        </a:events>
                                                                    </a:chart>
                                                                </div>
                                                            </div>
                                                            <div id="rpt1010_columnRow_22" class="widget blue">
                                                                <div class="widget_title">
                                                                    <div class="title_left">
                                                                        <i class="fa fa-pencil-square-o"/>
                                                                        <div><![CDATA[报表]]></div>
                                                                    </div>
                                                                    <div class="title_right">
                                                                        <i id="rpt1010_columnRow_22_list_id" class="fa fa-chevron-up" onclick="rpt1010_list_func(this)"/>
                                                                        <i id="rpt1010_columnRow_22_close_id" class="fa fa-times" onclick="rpt1010_close_func(this)"/>
                                                                    </div>
                                                                </div>
                                                                <div id="rpt1010_columnRow_content_22" class="widget_body">
                                                                    <a:chart backgroundColor="" bindTarget="rpt1010_5040_chart_data_ds" borderWidth="0" height="260" plotBackgroundColor="" plotBorderWidth="0" style="width:100%" type="column">
                                                                        <a:title style="font-weight:normal;font-size:14px;font-family:Microsoft YaHei" text="供应商交易额榜单"/>
                                                                        <a:xAxis>
                                                                            <a:xAxi name="vendor_name" gridLineWidth="0" tickLength="0">
                                                                                <a:labels formatter="rpt1010_column_label_format1" rotation="-30" style="font-weight:normal;font-size:12px;font-family:Microsoft YaHei"/>
                                                                            </a:xAxi>
                                                                        </a:xAxis>
                                                                        <a:yAxis>
                                                                            <a:yAxi name="total_amount" allowDecimals="false" gridLineWidth="1" min="0" minorGridLineWidth="0" tickLength="0">
                                                                                <a:title style="font-size:12px;font-family:Microsoft YaHei" text="累计交易金额（万元）"/>
                                                                                <a:labels/>
                                                                            </a:yAxi>
                                                                        </a:yAxis>
                                                                        <a:tooltip formatter="rpt1010_formatter1"/>
                                                                        <a:plotOptions>
                                                                            <a:chartcolumn stacking="normal"/>
                                                                        </a:plotOptions>
                                                                        <a:events>
                                                                            <a:event name="click" handler="rpt1010_btn4"/>
                                                                        </a:events>
                                                                    </a:chart>
                                                                </div>
                                                            </div>
                                                            <div id="rpt1010_columnRow_23" class="widget black">
                                                                <div class="widget_title">
                                                                    <div class="title_left">
                                                                        <i class="fa fa-pencil-square-o"/>
                                                                        <div><![CDATA[报表]]></div>
                                                                    </div>
                                                                    <div class="title_right">
                                                                        <i id="rpt1010_columnRow_23_list_id" class="fa fa-chevron-up" onclick="rpt1010_list_func(this)"/>
                                                                        <i id="rpt1010_columnRow_23_close_id" class="fa fa-times" onclick="rpt1010_close_func(this)"/>
                                                                    </div>
                                                                </div>
                                                                <div id="rpt1010_columnRow_content_23" class="widget_body">
                                                                    <a:chart backgroundColor="" bindTarget="rpt1010_5060_chart_data_ds" borderWidth="0" height="260" plotBackgroundColor="" plotBorderWidth="null" plotShadow="false" style="width:100%" type="pie">
                                                                        <a:title style="font-weight:normal;font-size:14px;font-family:Microsoft YaHei" text="采购品供应商占比分析"/>
                                                                        <a:tooltip pointFormat="{series.name}: &lt;b&gt;{point.percentage:.1f}%&lt;/b&gt;"/>
                                                                        <a:plotOptions>
                                                                            <a:pie allowPointSelect="true" cursor="pointer">
                                                                                <a:dataLabels color="#000" connectorColor="#000" enabled="true" formatter="rpt1010_formatter2" style="font-weight:normal;font-size:12px;font-family:Microsoft YaHei"/>
                                                                            </a:pie>
                                                                        </a:plotOptions>
                                                                        <a:xAxis>
                                                                            <a:xAxi name="vendor_name"/>
                                                                        </a:xAxis>
                                                                        <a:yAxis>
                                                                            <a:yAxi name="total_ratio" allowDecimals="true"/>
                                                                        </a:yAxis>
                                                                        <a:seriesList>
                                                                            <a:seriesItem name="total_ratio">
                                                                                <a:seriesDatas>
                                                                                    <a:seriesData dataIndex="2" selected="true" sliced="true"/>
                                                                                </a:seriesDatas>
                                                                            </a:seriesItem>
                                                                        </a:seriesList>
                                                                        <a:events>
                                                                            <a:event name="click" handler="rpt1010_btn6"/>
                                                                        </a:events>
                                                                    </a:chart>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!-- <a:vBox>
                                                        <a:hBox>
                                                            <a:chart backgroundColor="" bindTarget="rpt1010_5010_chart_data_ds" borderWidth="0" height="260" plotBackgroundColor="" plotBorderWidth="0" style="width:30%" zoomType="x,y">
                                                                <a:title style="font-weight:normal;font-size:14px;font-family:Microsoft YaHei" text="采购品交易额发展分析" x="25"/>
                                                                <a:legend align="left" borderWidth="1" floating="true" labelFormatter="rpt1010_label_format1" layout="vertical" verticalAlign="top" x="400" y="40"/>
                                                                <a:xAxis>
                                                                    <a:xAxi name="period_name" gridLineWidth="0" tickLength="0">
                                                                        <a:plotBands>
                                                                            <a:plotBand color="rgba(68,170,213,.2)" from="4.5" to="6.5"/>
                                                                        </a:plotBands>
                                                                        <a:labels rotation="-45" style="font-weight:normal;font-size:12px;font-family:Microsoft YaHei"/>
                                                                    </a:xAxi>
                                                                </a:xAxis>
                                                                <a:yAxis>
                                                                    <a:yAxi name="category_name" bindTarget="rpt1010_5010_data_option" gridLineWidth="1" minorGridLineWidth="0" tickLength="0">
                                                                        <a:title style="font-size:12px;font-family:Microsoft YaHei" text="本期数量（万元）"/>
                                                                    </a:yAxi>
                                                                </a:yAxis>
                                                                <a:tooltip formatter="rpt1010_toolFormat1" shared="true" valueSuffix="RPT.RPT1010_TEN_THOUSANDS"/>
                                                                <a:seriesList name="total_amount">
                                                                    <a:seriesItem>
                                                                        <a:fillColor linearGradient="0,0,0,300" stops="[0,Aurora.Charts.getOptions().colors[0]],                                            [1,Aurora.Charts.Color(Aurora.Charts.getOptions().colors[0]).setOpacity(0).get(&apos;rgba&apos;)]"/>
                                                                    </a:seriesItem>
                                                                </a:seriesList>
                                                                <a:events>
                                                                    <a:event name="click" handler="rpt1010_btn1"/>
                                                                </a:events>
                                                            </a:chart>
                                                            <a:chart backgroundColor="" bindTarget="rpt1010_5020_chart_data_ds" borderWidth="0" height="260" plotBackgroundColor="" plotBorderWidth="0" style="width:30%">
                                                                <a:title style="font-weight:normal;font-size:14px;font-family:Microsoft YaHei" text="供应商交易额发展分析"/>
                                                                <a:legend align="left" borderWidth="1" floating="true" labelFormatter="rpt1010_label_format2" layout="vertical" verticalAlign="top" x="400" y="40"/>
                                                                <a:xAxis>
                                                                    <a:xAxi name="period_name" gridLineWidth="0" tickLength="0">
                                                                        <a:plotBands>
                                                                            <a:plotBand color="rgba(68,170,213,.2)" from="4.5" to="6.5"/>
                                                                        </a:plotBands>
                                                                        <a:labels rotation="-45" style="font-weight:normal;font-size:12px;font-family:Microsoft YaHei"/>
                                                                    </a:xAxi>
                                                                </a:xAxis>
                                                                <a:yAxis>
                                                                    <a:yAxi name="vendor_name" bindTarget="rpt1010_5020_data_option" gridLineWidth="1" minorGridLineWidth="0" tickLength="0">
                                                                        <a:title style="font-size:12px;font-family:Microsoft YaHei" text="本期数量（万元）"/>
                                                                        <a:labels/>
                                                                    </a:yAxi>
                                                                </a:yAxis>
                                                                <a:tooltip formatter="rpt1010_toolFormat2" shared="true" valueSuffix="RPT.RPT1010_TEN_THOUSANDS"/>
                                                                <a:seriesList name="total_amount">
                                                                    <a:seriesItem>
                                                                        <a:fillColor linearGradient="0,0,0,300" stops="[0,Aurora.Charts.getOptions().colors[0]],                                            [1,Aurora.Charts.Color(Aurora.Charts.getOptions().colors[0]).setOpacity(0).get(&apos;rgba&apos;)]"/>
                                                                    </a:seriesItem>
                                                                </a:seriesList>
                                                                <a:events>
                                                                    <a:event name="click" handler="rpt1010_btn2"/>
                                                                </a:events>
                                                            </a:chart>
                                                        </a:hBox>
                                                        <a:hBox>
                                                            <a:chart backgroundColor="" bindTarget="rpt1010_5030_chart_data_ds" borderWidth="0" height="260" plotBackgroundColor="" plotBorderWidth="0" style="width:30%" type="column">
                                                                <a:title style="font-weight:normal;font-size:14px;font-family:Microsoft YaHei" text="采购品类交易额榜单"/>
                                                                <a:xAxis>
                                                                    <a:xAxi name="item_category_name" gridLineWidth="0" tickLength="0">
                                                                        <a:labels rotation="-30" style="font-weight:normal;font-size:12px;font-family:Microsoft YaHei"/>
                                                                    </a:xAxi>
                                                                </a:xAxis>
                                                                <a:yAxis>
                                                                    <a:yAxi name="total_amount" allowDecimals="false" gridLineWidth="1" min="0" minorGridLineWidth="0" tickLength="0">
                                                                        <a:title style="font-size:12px;font-family:Microsoft YaHei" text="累计交易金额（万元）"/>
                                                                        <a:labels/>
                                                                    </a:yAxi>
                                                                </a:yAxis>
                                                                <a:tooltip formatter="rpt1010_formatter1"/>
                                                                <a:plotOptions>
                                                                    <a:chartcolumn stacking="normal"/>
                                                                </a:plotOptions>
                                                                <a:events>
                                                                    <a:event name="click" handler="rpt1010_btn3"/>
                                                                </a:events>
                                                            </a:chart>
                                                            <a:chart backgroundColor="" bindTarget="rpt1010_5040_chart_data_ds" borderWidth="0" height="260" plotBackgroundColor="" plotBorderWidth="0" style="width:30%" type="column">
                                                                <a:title style="font-weight:normal;font-size:14px;font-family:Microsoft YaHei" text="供应商交易额榜单"/>
                                                                <a:xAxis>
                                                                    <a:xAxi name="vendor_name" gridLineWidth="0" tickLength="0">
                                                                        <a:labels formatter="rpt1010_column_label_format1" rotation="-30" style="font-weight:normal;font-size:12px;font-family:Microsoft YaHei"/>
                                                                    </a:xAxi>
                                                                </a:xAxis>
                                                                <a:yAxis>
                                                                    <a:yAxi name="total_amount" allowDecimals="false" gridLineWidth="1" min="0" minorGridLineWidth="0" tickLength="0">
                                                                        <a:title style="font-size:12px;font-family:Microsoft YaHei" text="累计交易金额（万元）"/>
                                                                        <a:labels/>
                                                                    </a:yAxi>
                                                                </a:yAxis>
                                                                <a:tooltip formatter="rpt1010_formatter1"/>
                                                                <a:plotOptions>
                                                                    <a:chartcolumn stacking="normal"/>
                                                                </a:plotOptions>
                                                                <a:events>
                                                                    <a:event name="click" handler="rpt1010_btn4"/>
                                                                </a:events>
                                                            </a:chart>
                                                        </a:hBox>
                                                        <a:hBox>
                                                            <a:chart backgroundColor="" bindTarget="rpt1010_5050_chart_data_ds" borderWidth="0" height="260" plotBackgroundColor="" plotBorderWidth="null" plotShadow="false" style="width:30%" type="pie">
                                                                <a:title style="font-weight:normal;font-size:14px;font-family:Microsoft YaHei" text="采购品各机构占比分析"/>
                                                                <a:tooltip pointFormat="{series.name}: &lt;b&gt;{point.percentage:.1f}%&lt;/b&gt;"/>
                                                                <a:plotOptions>
                                                                    <a:pie allowPointSelect="true" cursor="pointer">
                                                                        <a:dataLabels color="#000" connectorColor="#000" enabled="true" formatter="rpt1010_formatter2" style="font-weight:normal;font-size:12px;font-family:Microsoft YaHei"/>
                                                                    </a:pie>
                                                                </a:plotOptions>
                                                                <a:xAxis>
                                                                    <a:xAxi name="company_short_name"/>
                                                                </a:xAxis>
                                                                <a:yAxis>
                                                                    <a:yAxi name="total_ratio" allowDecimals="true"/>
                                                                </a:yAxis>
                                                                <a:seriesList>
                                                                    <a:seriesItem name="total_ratio">
                                                                        <a:seriesDatas>
                                                                            <a:seriesData dataIndex="2" selected="true" sliced="true"/>
                                                                        </a:seriesDatas>
                                                                    </a:seriesItem>
                                                                </a:seriesList>
                                                                <a:plotOptions>
                                                                    <a:pie borderWidth="0"/>
                                                                </a:plotOptions>
                                                                <a:events>
                                                                    <a:event name="click" handler="rpt1010_btn5"/>
                                                                </a:events>
                                                            </a:chart>
                                                            <a:chart backgroundColor="" bindTarget="rpt1010_5060_chart_data_ds" borderWidth="0" height="260" plotBackgroundColor="" plotBorderWidth="null" plotShadow="false" style="width:30%" type="pie">
                                                                <a:title style="font-weight:normal;font-size:14px;font-family:Microsoft YaHei" text="采购品供应商占比分析"/>
                                                                <a:tooltip pointFormat="{series.name}: &lt;b&gt;{point.percentage:.1f}%&lt;/b&gt;"/>
                                                                <a:plotOptions>
                                                                    <a:pie allowPointSelect="true" cursor="pointer">
                                                                        <a:dataLabels color="#000" connectorColor="#000" enabled="true" formatter="rpt1010_formatter2" style="font-weight:normal;font-size:12px;font-family:Microsoft YaHei"/>
                                                                    </a:pie>
                                                                </a:plotOptions>
                                                                <a:xAxis>
                                                                    <a:xAxi name="vendor_name"/>
                                                                </a:xAxis>
                                                                <a:yAxis>
                                                                    <a:yAxi name="total_ratio" allowDecimals="true"/>
                                                                </a:yAxis>
                                                                <a:seriesList>
                                                                    <a:seriesItem name="total_ratio">
                                                                        <a:seriesDatas>
                                                                            <a:seriesData dataIndex="2" selected="true" sliced="true"/>
                                                                        </a:seriesDatas>
                                                                    </a:seriesItem>
                                                                </a:seriesList>
                                                                <a:events>
                                                                    <a:event name="click" handler="rpt1010_btn6"/>
                                                                </a:events>
                                                            </a:chart>
                                                        </a:hBox>
                                                    </a:vBox> -->
                                                    <!-- <a:button click="rpt1010_refrsh" style="margin-left:400px" text="RPT.RPT_REFRESH" width="100"/> -->
                                                </div>
                                                <div id="rpt1010_tab_son2" class="tab_content"><![CDATA[
											]]></div>
                                                <div id="rpt1010_tab_son3" class="tab_content"><![CDATA[
											]]></div>
                                            </div>
                                        </div>
                                        <div name="handListButton" buttontext="下拉菜单栏" style="width:20%">
                                            <!-- <div class="rpt1010_list_button">
                                                <div class="left_button">
                                                    <div style="font-size:14px;color:#fff;padding-top:10px"><![CDATA[全部报表(回收站)]]></div>
                                                </div>
                                                <div class="right_button" onclick="rpt1010_rightButton_showList()">
                                                    <i class="fa fa-caret-down" style="font-size:20px;color:#fff;padding-top:10px"/>
                                                </div>
                                            </div> -->
                                            <ul id="rpt1010_right_click_table">
                                                <li>
                                                    <div class="icon_td" style="float:left;">
                                                        <i class="fa fa-line-chart"/>
                                                    </div>
                                                    <div class="content_td" style="float:right"><![CDATA[
                                              采购品交易额发展
                                            ]]></div>
                                                </li>
                                                <li>
                                                    <div class="icon_td" style="float:left">
                                                        <i class="fa fa-line-chart"/>
                                                    </div>
                                                    <div class="content_td" style="float:right;"><![CDATA[
                                              供应商交易额发展分析报表
                                            ]]></div>
                                                </li>
                                                <li>
                                                    <div class="icon_td" style="float:left">
                                                        <i class="fa fa-bar-chart"/>
                                                    </div>
                                                    <div class="content_td" style="float:right;"><![CDATA[
                                              采购品交易额榜单报表
                                            ]]></div>
                                                </li>
                                                <li>
                                                    <div class="icon_td" style="float:left">
                                                        <i class="fa fa-bar-chart"/>
                                                    </div>
                                                    <div class="content_td" style="float:right;"><![CDATA[
                                              供应商交易额榜单报表
                                            ]]></div>
                                                </li>
                                                <li>
                                                    <div class="icon_td" style="float:left">
                                                        <i class="fa fa-pie-chart"/>
                                                    </div>
                                                    <div class="content_td" style="float:right;"><![CDATA[
                                              采购品各机构占比报表
                                            ]]></div>
                                                </li>
                                                <li>
                                                    <div class="icon_td" style="float:left">
                                                        <i class="fa fa-pie-chart"/>
                                                    </div>
                                                    <div class="content_td" style="float:right;"><![CDATA[
                                              采购品供应商占比报表
                                            ]]></div>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
        <script><![CDATA[
            Aurora.onReady(function() {
                rpt1010_lock_current_window();
                rpt1010_query_init();
            });
        ]]></script>
    </a:view>
</a:screen>
