<?xml version="1.0" encoding="UTF-8"?>
<a:screen xmlns:a="http://www.aurora-framework.org/application">
    <a:init-procedure>
        <a:model-query model="wfl.WFL1001.wfl_fnd_company_info_query" rootPath="company_data"/>
        <a:model-query model="sys.sys_user_last_login_info" rootPath="default_role_name"/>
        <!-- <a:model-query fetchAll="true" model="sys.SYS_WFL.sys_message_count" rootPath="sys_messge_count"/> -->
        <a:model-query fetchAll="true" model="sys.SYS_WFL.sys_favaorite_messageConfig" rootPath="sys_messge_config"/>
        <a:model-query fetchAll="true" model="sys.sys_user_infor" rootPath="sys_user_infor_ds"/>
        <a:model-query model="wfl.WFL1001.fnd_business_notification_count" rootPath="wfl1001_business_notification_count"/>
        <a:model-query fetchAll="true" model="pay.PAY5010.pay_user_info" rootPath="user_pay_info"/>
        <!-- <a:model-query fetchAll="true" model="wfl.WFL1001.fnd_config_vendor_agreement" rootPath="vendor_agreement_info"/> -->
        <!-- <a:model-query model="wfl.newWFL.workflow_count" rootPath="workflow_count"/> -->
    </a:init-procedure>
    <a:view>
        <meta CONTENT="no-cache" HTTP-EQUIV="Pragma"/>
        <meta CONTENT="no-cache" HTTP-EQUFIV="Cache-Control"/>
        <meta CONTENT="0" HTTP-EQUIV="Expires"/>
        <meta charset="UTF-8"/>
        <title/>
        <a:link id="wfl1001_create_bulletin_browsing_history_link" model="blt.BLT1010.create_bulletin_browsing_history" modelaction="execute"/>
        <a:link id="wfl1001_blt_bulletin_detail_link" url="${/request/@context_path}/modules/blt/BLT1010/blt_bulletin_details_no_login.screen"/>
        <a:link id="wfl1001_rfx_detail_link" url="${/request/@context_path}/modules/pur/PUR7130/pur_rfx_details.screen"/>
        <a:link id="wfl1001_sys_user_message_read_link" model="sys.sys_user_messages" modelaction="update"/>
        <a:link id="wfl1001_sys_user_message_delete_link" model="sys.sys_user_messages" modelaction="execute"/>
        <a:link id="wfl1001_sys_schedule_message_insert_link" model="sys.sys_schedule_messages" modelaction="insert"/>
        <a:link id="wfl1001_sys_schedule_message_delete_link" model="sys.sys_schedule_messages" modelaction="delete"/>
        <a:link id="wfl1001_sys_schedule_types_insert_link" model="sys.SYS7020.sys_schedule_types" modelaction="insert"/>
        <a:link id="wfl1001_sys_schedule_message_detail_link" url="${/request/@context_path}/modules/wfl/WFL1001/sys_schedule_message_detail.screen"/>
        <a:link id="wfl1001_fnd_user_todo_list_insert_link" model="fnd.fnd_user_todo_list" modelaction="insert"/>
        <a:link id="wfl1001_fnd_user_todo_list_update_link" model="fnd.fnd_user_todo_list" modelaction="update"/>
        <a:link id="wfl1001_fnd_user_todo_list_delete_link" model="fnd.fnd_user_todo_list" modelaction="delete"/>
        <link href="${/request/@context_path}/css/main/main_user.css?v=201712181500" rel="stylesheet" type="text/css"/>
        <a:script><![CDATA[
            //未签收业务通知单数量
            // var businessNotificationCount = '${/model/wfl1001_business_notification_count/record/@business_notification_count}';
            // if(businessNotificationCount!=0){
            // document.getElementById("wfl1001_businessNotificationCount").style.color = 'red';
            // document.getElementById("wfl1001_businessNotificationCount").innerHTML = businessNotificationCount;
            // }
            // var myFunctionFlag = '${/model/wfl1001_business_notification_count/record/@my_function_flag}';
            
            Aurora.onReady(function() {
                 initValidateVendorInfofor();
                //消息列表权限
                init_messageListConfig();
                //初始化，校验用户的手机和邮箱
                //initValidateUserInfor();
            
                //校验余额
                initValidateUserPayInfor();
                
               //
              
                
                //是否需要展示供应商协议
                //initVendorAgreementInfor();
            
                //和角色类型相关的信息
                init_role_info();
                //初始化日程
                // handCalendar.initHandCalendar("cldTest", getHandCalendarEvents($('wfl1001_user_schedule_messages_ds')), showUserEventW);
            
            });
            
            // function init(){
            // var m = Aurora.getCookie('tradeDefault');
            // if(m === 'true'){
            // wfl1001_all_message_search();
            // document.getElementById('trade-btn-bg').classList.remove('hide');
            // document.getElementById('trade-btn-bg').classList.add('show');
            // document.getElementById('trade-btn').style.left = '15px';
            // }else{
            // document.getElementById('trade-btn-bg').classList.remove('show');
            // document.getElementById('trade-btn-bg').classList.add('hide');
            // document.getElementById('trade-btn').style.left = '0';
            // }
            // }
            
            function onLoadUserMessageEvent(ds) {
                handCalendar.updateHandCalendarData(getHandCalendarEvents(ds));
            }
            
            function showUserEventW(eventData) {
                if (Aurora.isEmpty(eventData)) {
                    return;
                }
                var id = eventData.schedule_message_id;
                if (Aurora.isEmpty(id)) {
                    Aurora.showMessage('${l:PROMPT}', '${l:WFL_HOME_PAGE.NO_CONTENT_ON_THE_AGENDA}');
                    return;
                }
                var url = "${/request/@context_path}/modules/wfl/WFL1001/sys_schedule_message_detail.screen?schedule_message_id=" + id;
                new Aurora.Window({
                    id: 'wfl1001_sys_schedule_message_detail_window',
                    title: '${l:WFL_HOME_PAGE.SCHEDULE_DETAILS}',
                    url: url,
                    height: 200,
                    width: 300
                });
            }
            
            function getHandCalendarEvents(ds) {
                var userScheduleMessages = ds.getAll();
                var record;
                var userEvents = [];
                var startYear, startMonth, startDay, startHour, startMinute, endYear, endMonth, endDay, endHour, endMinute;
                for (var i = 0;i < userScheduleMessages.length;i++) {
                    userEvents[i] = record = userScheduleMessages[i].data;
                    userEvents[i].backgroundColor = colorPicker(record.schedule_color);
                    userEvents[i].borderColor = colorPicker(record.schedule_color);
                }
                return userEvents;
            }
            
            
            function init_role_info() {
            
                var servicesRecords = $('services_permission_ds').getAll();
                var service, domArrays = new Array();
                var l = servicesRecords.length;
                var ds, url;
                for (var i = 0;i < l;i++) {
                    service = servicesRecords[i].data.service_name;
                    //采购方，收到的报价单
                    if (service == 'modules/pur/PUR5130/pur_rfx_headers_query.screen') {
                        url = "javascript:wfl1001_sidebarOnclick('modules/pur/PUR5130/pur_rfx_headers_query.screen?function_code=PUR5130','" + servicesRecords[i].data.function_name + "');";
                        window.document.getElementById('receivedInquirySheetForBuyerLink').setAttribute('href', url);
            
                        //采购方，加急订单
                    } else if (service == 'modules/pur/PUR7010/pur_purchase_order_query.screen') {
                        url = "javascript:wfl1001_sidebarOnclick('modules/pur/PUR7010/pur_purchase_order_query.screen?function_code=PUR7010','" + servicesRecords[i].data.function_name + "','Y');";
                        window.document.getElementById('purchaseOrderLink').setAttribute('href', url);
            
            
                        //采购方，待收货
                    } else if (service == 'modules/inv/INV7010/inv_asn_query.screen') {
                        url = "javascript:wfl1001_sidebarOnclick('modules/pur/PUR7010/pur_purchase_order_query.screen?function_code=PUR7010','" + '我发出的订单' + "');";
                        window.document.getElementById('asnReceiveStatisticsForRequireLink').setAttribute('href', url);
            
            
                        //采购方，待对账，创建开票通知
                    } else if (service == 'modules/acp/ACP5210/acp_bill.screen') {
                        url = "javascript:wfl1001_sidebarOnclick('modules/acp/ACP5210/acp_bill.screen?function_code=ACP5210','" + servicesRecords[i].data.function_name + "');";
                        window.document.getElementById('billCreateForRequireLink').setAttribute('href', url);
            
            
                        //采购方，待确认对账单，开票申请审批
                    } else if (service == 'modules/acp/ACP5270/acp_bill_query.screen') {
                        url = "javascript:wfl1001_sidebarOnclick('modules/acp/ACP5270/acp_bill_query.screen?function_code=ACP5270','" + servicesRecords[i].data.function_name + "');";
                        window.document.getElementById('billApproveForRequireLink').setAttribute('href', url);
            
            
                        //供应商，收到的询价单，发出的报价单
                    } else if (service == 'modules/pur/SACPUR5210/pur_rfx_feedback.screen') {
                        url = "javascript:wfl1001_sidebarOnclick('modules/pur/SACPUR5210/pur_rfx_feedback.screen?function_code=SACPUR5210','" + servicesRecords[i].data.function_name + "');";
                        window.document.getElementById('receivedInquirySheetForSupplyLink').setAttribute('href', url);
                        window.document.getElementById('quotationForSupplyLink').setAttribute('href', url);
            
            
                        //供应商，加急订单，待确认
                    } else if (service == 'modules/pur/PUR3010/pur_purchase_order_confirm.screen') {
                        url = "javascript:wfl1001_sidebarOnclick('modules/pur/PUR3010/pur_purchase_order_confirm.screen?function_code=PUR3010','" + servicesRecords[i].data.function_name + "');";
                        window.document.getElementById('purchaseOrderUrgentStatisticsForSupplyLink').setAttribute('href', url);
                        window.document.getElementById('purchaseOrderConfirmStatisticsForSupplyLink').setAttribute('href', url);
            
            
                        //供应商，待发货
                    } else if (service == 'modules/inv/INV5010/inv_asn_query.screen') {
                        url = "javascript:wfl1001_sidebarOnclick('modules/inv/INV5010/inv_asn_query.screen?function_code=INV5010','" + servicesRecords[i].data.function_name + "');";
                        window.document.getElementById('salesSendForSupplyLink').setAttribute('href', url);
            
            
                        //供应商，待买家收货
                    } else if (service == 'modules/inv/INV7020/inv_asn_query.screen') {
                        url = "javascript:wfl1001_sidebarOnclick('modules/pur/PUR7030/pur_purchase_vendor_query.screen?function_code=PUR7030','" + '我收到的订单' + "');";
                        window.document.getElementById('toPurchaseReceiveForSupplyLink').setAttribute('href', url);
            
            
                        //供应商，待对账（创建开票申请）
                    } else if (service == 'modules/acp/ACP5260/acp_bill_query.screen') {
                        url = "javascript:wfl1001_sidebarOnclick('modules/acp/ACP5260/acp_bill_query.screen?function_code=ACP5260','" + servicesRecords[i].data.function_name + "');";
                        window.document.getElementById('billCreateForSupplyLink').setAttribute('href', url);
            
            
                        //供应商，待确认对账单（确认开票通知）
                    } else if (service == 'modules/acp/ACP5230/acp_bill_query.screen') {
                        url = "javascript:wfl1001_sidebarOnclick('modules/acp/ACP5230/acp_bill_query.screen?function_code=ACP5230','" + servicesRecords[i].data.function_name + "');";
                        window.document.getElementById('billApproveForSupplyLink').setAttribute('href', url);
            
                        //供应商，待开票对账单
                    } else if (service == 'modules/acp/ACP5220/acp_web_invoice.screen') {
                        url = "javascript:wfl1001_sidebarOnclick('modules/acp/ACP5220/acp_web_invoice.screen?function_code=ACP5220','" + servicesRecords[i].data.function_name + "');";
                        window.document.getElementById('invoiceForStatementForSupplyLink').setAttribute('href', url);
            
                        //组织架构
                    } else if (service == 'modules/hrm/HRM1021/hrm_structure_define.screen') {
                        url = "javascript:wfl1001_sidebarOnclick('modules/hrm/HRM1021/hrm_structure_define.screen?function_code=HRM1021','" + servicesRecords[i].data.function_name + "');";
                        window.document.getElementById('company').setAttribute('onclick', url);
                        window.document.getElementById('company').style.cursor = 'pointer';
                    }
                    //采购方，收到的报价单
                    var receivedInquirySheetForBuyerLink = window.document.getElementById('receivedInquirySheetForBuyerLink').getAttribute("href");
                    //采购方，加急订单
                    var purchaseOrderLink = window.document.getElementById('purchaseOrderLink').getAttribute("href");
                    //采购方，待收货
                    var asnReceiveStatisticsForRequireLink = window.document.getElementById('asnReceiveStatisticsForRequireLink').getAttribute("href");
                    //采购方，待对账，创建开票通知
                    var billCreateForRequireLink = window.document.getElementById('billCreateForRequireLink').getAttribute("href");
                    //采购方，待确认对账单，开票申请审批
                    var billApproveForRequireLink = window.document.getElementById('billApproveForRequireLink').getAttribute("href");
                    //供应商，收到的询价单，发出的报价单
                    var receivedInquirySheetForSupplyLink = window.document.getElementById('receivedInquirySheetForSupplyLink').getAttribute("href");
                    var quotationForSupplyLink = window.document.getElementById('quotationForSupplyLink').getAttribute("href");
                    //供应商，加急订单，待确认
                    var purchaseOrderUrgentStatisticsForSupplyLink = window.document.getElementById('purchaseOrderUrgentStatisticsForSupplyLink').getAttribute("href");
                    var purchaseOrderConfirmStatisticsForSupplyLink = window.document.getElementById('purchaseOrderConfirmStatisticsForSupplyLink').getAttribute("href");
                    //供应商，待发货
                    var salesSendForSupplyLink = window.document.getElementById('salesSendForSupplyLink').getAttribute("href");
                    //供应商，待买家收货
                    var toPurchaseReceiveForSupplyLink = window.document.getElementById('toPurchaseReceiveForSupplyLink').getAttribute("href");
                    //供应商，待对账（创建开票申请）
                    var billCreateForSupplyLink = window.document.getElementById('billCreateForSupplyLink').getAttribute("href");
                    //供应商，待确认对账单（确认开票通知）
                    var billApproveForSupplyLink = window.document.getElementById('billApproveForSupplyLink').getAttribute("href");
                    //供应商，待开票对账单
                    var invoiceForStatementForSupplyLink = window.document.getElementById('invoiceForStatementForSupplyLink').getAttribute("href");
                    if (receivedInquirySheetForBuyerLink == '#') { //采购方，收到的报价单
                        window.document.getElementById('receivedInquirySheetForBuyerLink').style.display = 'none';
                    } else {
                        window.document.getElementById('receivedInquirySheetForBuyerLink').style.display = 'block';
                    }
                    if (purchaseOrderLink == '#') { //采购方，加急订单
                        window.document.getElementById('purchaseOrderLink').style.display = 'none';
                    } else {
                        window.document.getElementById('purchaseOrderLink').style.display = 'block';
                    }
                    if (asnReceiveStatisticsForRequireLink == '#') { //采购方，待收货
                        window.document.getElementById('asnReceiveStatisticsForRequireLink').style.display = 'none';
                    } else {
                        window.document.getElementById('asnReceiveStatisticsForRequireLink').style.display = 'block';
                    }
                    if (billCreateForRequireLink == '#') { //采购方，待对账，创建开票通知
                        window.document.getElementById('billCreateForRequireLink').style.display = 'none';
                    } else {
                        window.document.getElementById('billCreateForRequireLink').style.display = 'block';
                    }
                    if (billApproveForRequireLink == '#') { //采购方，待确认对账单，开票申请审批
                        window.document.getElementById('billApproveForRequireLink').style.display = 'none';
                    } else {
                        window.document.getElementById('billApproveForRequireLink').style.display = 'block';
                    }
                    if (receivedInquirySheetForSupplyLink == '#') { //供应商，收到的询价单
                        window.document.getElementById('receivedInquirySheetForSupplyLink').style.display = 'none';
                    } else {
                        window.document.getElementById('receivedInquirySheetForSupplyLink').style.display = 'block';
                    }
                    if (quotationForSupplyLink == '#') { //供应商，发出的报价单
                        window.document.getElementById('quotationForSupplyLink').style.display = 'none';
                    } else {
                        window.document.getElementById('quotationForSupplyLink').style.display = 'block';
                    }
                    if (purchaseOrderUrgentStatisticsForSupplyLink == '#') { //供应商，加急订单
                        window.document.getElementById('purchaseOrderUrgentStatisticsForSupplyLink').style.display = 'none';
                    } else {
                        window.document.getElementById('purchaseOrderUrgentStatisticsForSupplyLink').style.display = 'block';
                    }
                    if (purchaseOrderConfirmStatisticsForSupplyLink == '#') { //供应商，待确认
                        window.document.getElementById('purchaseOrderConfirmStatisticsForSupplyLink').style.display = 'none';
                    } else {
                        window.document.getElementById('purchaseOrderConfirmStatisticsForSupplyLink').style.display = 'block';
                    }
                    if (salesSendForSupplyLink == '#') { //供应商，待发货
                        window.document.getElementById('salesSendForSupplyLink').style.display = 'none';
                    } else {
                        window.document.getElementById('salesSendForSupplyLink').style.display = 'block';
                    }
                    if (toPurchaseReceiveForSupplyLink == '#') { //供应商，待买家收货
                        window.document.getElementById('toPurchaseReceiveForSupplyLink').style.display = 'none';
                    } else {
                        window.document.getElementById('toPurchaseReceiveForSupplyLink').style.display = 'block';
                    }
                    if (billCreateForSupplyLink == '#') { //供应商，待对账（创建开票申请）
                        window.document.getElementById('billCreateForSupplyLink').style.display = 'none';
                    } else {
                        window.document.getElementById('billCreateForSupplyLink').style.display = 'block';
                    }
                    if (billApproveForSupplyLink == '#') { //供应商，待确认对账单（确认开票通知）
                        window.document.getElementById('billApproveForSupplyLink').style.display = 'none';
                    } else {
                        window.document.getElementById('billApproveForSupplyLink').style.display = 'block';
                    }
                    if (invoiceForStatementForSupplyLink == '#') { //供应商，待开票对账单
                        window.document.getElementById('invoiceForStatementForSupplyLink').style.display = 'none';
                    } else {
                        window.document.getElementById('invoiceForStatementForSupplyLink').style.display = 'block';
                    }
                    if ((receivedInquirySheetForBuyerLink == '#') && (purchaseOrderLink == '#') && (asnReceiveStatisticsForRequireLink == '#') && (billCreateForRequireLink == '#') && (billApproveForRequireLink == '#')) {
                        window.document.getElementById('require-state-label').style.display = 'none';
                    } else {
                        window.document.getElementById('require-state-label').style.display = 'block';
                    }
                    if ((receivedInquirySheetForSupplyLink == '#') && (quotationForSupplyLink == '#') && (purchaseOrderUrgentStatisticsForSupplyLink == '#') && (purchaseOrderConfirmStatisticsForSupplyLink == '#') && (salesSendForSupplyLink == '#') && (toPurchaseReceiveForSupplyLink == '#') && (billCreateForSupplyLink == '#') && (billApproveForSupplyLink == '#') && (invoiceForStatementForSupplyLink == '#')) {
                        window.document.getElementById('supply-state-label').style.display = 'none';
                        window.document.getElementById('require-state-label').style.borderBottom = 'none';
                    } else {
                        window.document.getElementById('supply-state-label').style.display = 'block';
                        window.document.getElementById('require-state-label').style.borderBottom = '1px solid #007fff';
                    }
                }
            }
            
            
            function colorPicker(s) {
                var r;
                switch (s) {
                case 'PRIMARY':
                    return '#3498db';
                case 'RED':
                    return '#f56954';
                case 'INFO':
                    return '#00afd1';
                case 'PURPLE':
                    return '#9b59b6';
                case 'DANGER':
                    return '#f6504d';
                case 'SUCCESS':
                    return '#27ae60';
                case 'WARNING':
                    return '#ffc61d';
                case 'GREEN':
                    return '#01b6ad';
                case 'PINK':
                    return '#ff3366';
                case 'INVERSE':
                    return '#2d2d2d';
                }
                return '#00ffff';
            }
            
            function userEventInsert(o) {
                if (!Aurora.isEmpty(o.id)) {
                    Aurora.request({
                        url: $('wfl1001_sys_schedule_message_insert_link').getUrl(),
                        para: {
                            'schedule_type_id': o.id,
                            'message_title': o.title,
                            'all_day': true,
                            'start_year': o.start.getFullYear(),
                            'start_month': o.start.getMonth(),
                            'start_day': o.start.getDate(),
                            'start_hour': o.start.getHours(),
                            'start_minute': o.start.getMinutes()
                        },
                        success: function(result) {},
                        scope: this
                    });
                }
            }
            
            function userEventDelete(id) {
                if (!Aurora.isEmpty(id)) {
                    Aurora.request({
                        url: $('wfl1001_sys_schedule_message_delete_link').getUrl(),
                        para: {
                            'schedule_message_id': id
                        },
                        success: function() {},
                        scope: this
                    });
                }
            }
        ]]></a:script>
        <script><![CDATA[
            /*
             * 全局参数定义
             */
            var g_userMessagesList_pageSize = 2; //默认显示消息数量
            //init_messageListConfig();
            
            //商友圈
            var g_coopMessagesList_pageNo = 1;
            var g_coopMessagesListPageAll = Math.ceil('${/model/sys_messge_count/record/@coop_count}' / g_userMessagesList_pageSize);
            var g_coopMessageFrom = 1;
            var coop_messages_list_div_view = document.getElementById('coop_messages_list_div_view').childNodes.length; //商友圈显示的消息数量
            wfl1001_messageListInit(coop_messages_list_div_view, 'wfl1001_coopMessagesListShowMoreDiv', g_coopMessagesListPageAll);
            
            //公司动态
            var g_ownerMessagesList_pageNo = 1;
            var g_ownerMessagesListPageAll = Math.ceil('${/model/sys_messge_count/record/@owner_count}' / g_userMessagesList_pageSize);
            var g_ownerMessageFrom = 1;
            var owner_messages_list_div_view = document.getElementById('owner_messages_list_div_view').childNodes.length;
            wfl1001_messageListInit(owner_messages_list_div_view, 'wfl1001_ownerMessagesListShowMoreDiv', g_ownerMessagesListPageAll);
            
            //求购动态
            var g_rfxMessagesList_pageNo = 1;
            var g_rfxMessagesListPageAll = Math.ceil('${/model/sys_messge_count/record/@rfx_count}' / g_userMessagesList_pageSize);
            var g_rfxMessageFrom = 1;
            var rfx_messages_list_div_view = document.getElementById('rfx_messages_list_div_view').childNodes.length;
            wfl1001_messageListInit(rfx_messages_list_div_view, 'wfl1001_rfxMessagesListShowMoreDiv', g_rfxMessagesListPageAll);
            
            //系统消息
            var g_sysMessagesList_pageNo = 1;
            var g_sysMessagesListPageAll = Math.ceil('${/model/sys_messge_count/record/@system_count}' / g_userMessagesList_pageSize);
            var g_sysMessageFrom = 1;
            var sys_messages_list_div_view = document.getElementById('sys_messages_list_div_view').childNodes.length;
            wfl1001_messageListInit(sys_messages_list_div_view, 'wfl1001_sysMessagesListShowMoreDiv', g_sysMessagesListPageAll);
            
            //行业资讯
            var g_platformMessagesList_pageNo = 1;
            var g_platformMessagesListPageAll = Math.ceil('${/model/sys_messge_count/record/@industry_count}' / g_userMessagesList_pageSize);
            var g_platformMessageFrom = 1;
            var platform_messages_list_div_view = document.getElementById('platform_messages_list_div_view').childNodes.length;
            wfl1001_messageListInit(g_platformMessagesListPageAll, 'wfl1001_platformMessagesListShowMoreDiv', g_platformMessagesListPageAll);
            /*
             * END
             */
            //全局参数初始化
            
            function wfl1001_sidebarOnclick(screen, prompt, flag) {
                if (screen == undefined || screen === '') {
                    return;
                }
                $('mainTab').openMainTab(screen, prompt, 'load_main_tab.screen');
            }
            
            function getId(id) {
                return document.getElementById(id);
            }
            
            //消息权限
            
            function init_messageListConfig() {
                var tab_title = document.getElementById("tab-title");
                var span = tab_title.getElementsByTagName("span");
                if ('${/model/sys_messge_config/record/@owner_config}' == 'N') {
                    messageListClear('tab-son2-title');
                    span[1].style.display = 'none';
                }
                if ('${/model/sys_messge_config/record/@rfx_config}' == 'N') {
                    messageListClear('tab-son3-title');
                    span[2].style.display = 'none';
                }
                if ('${/model/sys_messge_config/record/@coop_config}' == 'N') {
                    messageListClear('tab-son4-title');
                    span[3].style.display = 'none';
                }
                if ('${/model/sys_messge_config/record/@industry_config}' == 'N') {
                    messageListClear('tab-son5-title');
                    span[4].style.display = 'none';
                }
            
            }
            
            function messageListClear(id) {
                var div = getId(id);
                div.style.display = 'none';
            }
            
            //消息初始化(系统消息，公司动态，求购动态，商友圈，行业资讯)
            
            function wfl1001_messageListInit(pageNum, id, listPageAll) {
                var div = getId(id);
                if (listPageAll == pageNum || listPageAll == 0) {
                    div.style.display = "none";
                } else {
                    div.style.display = "block";
                }
            }
            //消息列表div渲染
            
            function wfl1001_messageListHTML(dataset, ul_id, pageNo, showMore_id, pageAll) {
                var records = dataset.getAll(),
                    record;
                var nextpagehtml, length = records.length,
                    li, count, decorate, messageFather;
                var ul = getId(ul_id);
                Aurora.Masker.mask(ul, '${l:WFL1001.LOADING}');
                for (var i = 0;i < length;i++) {
                    record = records[i];
                    count = i + (g_userMessagesList_pageSize * (g_sysMessagesList_pageNo - 1));
                    li = window.document.createElement('LI');
                    li.className = 'notification-messages info';
                    li.id = 'user_msg_info_div_' + count;
                    li.setAttribute('read_flag', 'false');
                    decorate = '<div class="decorate" >';
                    if (record.get('read_flag') == 'N') {
                        decorate += '<div class="radio">' + '</div>';
                    } else {
                        decorate += '<div class="radios">' + '</div>';
                    }
                    decorate += '<div class="line-wrap">' + '<div class="line">' + '</div>' + '</div>';
                    decorate += '</div>';
                    nextpagehtml = '<div class="message-wrapper" onclick="javascript:wfl1001_showUserMessageListDetail(this,' + count + ',' + record.get('message_id') + ',' + record.get('source_id') + ',\'' + record.get('source_table') + '\',\'' + record.get('url') + '\',\'' + record.get('read_flag') + '\');">';
                    if (record.get('read_flag') == 'N') {
                        nextpagehtml += '<div id="user_msg_head_div_' + count + '" class="heading" style="font-weight:bold;color:#111">' + record.get('message_title') + '</div>';
                        nextpagehtml += '<span class="messageIcon">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + '</span>';
                        nextpagehtml += '<div id="user_msg_desc_div_' + count + '" class="description" >' + record.get('message_content') + '</div>';
                        nextpagehtml += '<div class="dates">' + record.get('creation_date') + '</div>';
                    } else {
                        nextpagehtml += '<div id="user_msg_head_div_' + count + '" class="heading" style="font-weight:normal;">' + record.get('message_title') + '</div>';
                        nextpagehtml += '<span class="messageIconOver">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + '</span>';
                        nextpagehtml += '<div id="user_msg_desc_div_' + count + '" class="descriptions" >' + record.get('message_content') + '</div>';
                        nextpagehtml += '<div class="date">' + record.get('creation_date') + '</div>';
                    }
                    nextpagehtml += '</div>';
                    nextpagehtml += '<div class="msg-close">';
                    nextpagehtml += '<a class="remove fa fa-times icon-remove" onclick="javascript:wfl1001_deleteUserMessage(this,' + count + ',' + record.get('message_id') + ',\'' + record.get('source_table') + '\');"></a>';
                    nextpagehtml += '</div>';
                    li.innerHTML = decorate + nextpagehtml;
                    ul.appendChild(li);
                }
                Aurora.Masker.unmask(ul);
                wfl1001_messageListInit(g_sysMessagesList_pageNo, 'wfl1001_sysMessagesListShowMoreDiv', g_sysMessagesListPageAll);
            }
            
            function wfl1001_coopMessagesListDsLoad(dataset) {
                wfl1001_messageListHTML(dataset, 'coop_messages_list_div_view', g_coopMessagesList_pageNo, 'wfl1001_coopMessagesListShowMoreDiv', g_coopMessagesListPageAll);
            }
            
            function wfl1001_ownerMessagesListDsLoad(dataset) {
                wfl1001_messageListHTML(dataset, 'owner_messages_list_div_view', g_ownerMessagesList_pageNo, 'wfl1001_ownerMessagesListShowMoreDiv', g_ownerMessagesListPageAll);
            }
            
            function wfl1001_rfxMessagesListDsLoad(dataset) {
                wfl1001_messageListHTML(dataset, 'rfx_messages_list_div_view', g_rfxMessagesList_pageNo, 'wfl1001_rfxMessagesListShowMoreDiv', g_rfxMessagesListPageAll);
            }
            
            function wfl1001_sysMessagesListDsLoad(dataset) {
                wfl1001_messageListHTML(dataset, 'sys_messages_list_div_view', g_sysMessagesList_pageNo, 'wfl1001_sysMessagesListShowMoreDiv', g_sysMessagesListPageAll);
            }
            
            function wfl1001_platformMessagesListDsLoad(dataset) {
                wfl1001_messageListHTML(dataset, 'platform_messages_list_div_view', g_platformMessagesList_pageNo, 'wfl1001_platformMessagesListShowMoreDiv', g_platformMessagesListPageAll);
            }
            
            function wfl1001_showMoreCoopMessagesList() {
                var ds = $('wfl1001_coop_messages_list_ds');
                g_coopMessagesList_pageNo++;
                g_coopMessageFrom += g_userMessagesList_pageSize * 1;
                ds.setQueryParameter('pagenum_from', g_coopMessageFrom);
                ds.query();
            }
            
            function wfl1001_showMoreOwnerMessagesList() {
                var ds = $('wfl1001_owner_messages_list_ds');
                g_ownerMessagesList_pageNo++;
                g_ownerMessageFrom += g_userMessagesList_pageSize * 1;
                ds.setQueryParameter('pagenum_from', g_ownerMessageFrom);
                ds.query();
            }
            
            function wfl1001_showMoreRfxMessagesList() {
                var ds = $('wfl1001_rfx_messages_list_ds');
                g_rfxMessagesList_pageNo++;
                g_rfxMessageFrom += g_userMessagesList_pageSize * 1;
                ds.setQueryParameter('pagenum_from', g_rfxMessageFrom);
                ds.query();
            }
            
            function wfl1001_showMoreSysMessagesList() {
                var ds = $('wfl1001_sys_messages_list_ds');
                g_sysMessagesList_pageNo++;
                g_sysMessageFrom += g_userMessagesList_pageSize * 1;
                ds.setQueryParameter('pagenum_from', g_sysMessageFrom);
                ds.query();
            }
            
            function wfl1001_showMorePlatformMessagesList() {
                var ds = $('wfl1001_platform_messages_list_ds');
                g_platformMessagesList_pageNo++;
                g_platformMessageFrom += g_userMessagesList_pageSize * 1;
                ds.setQueryParameter('pagenum_from', g_platformMessageFrom);
                ds.query();
            }
            
            function wfl1001_showBltBulletinDetail(id, url) {
                Aurora.request({
                    url: $('wfl1001_create_bulletin_browsing_history_link').getUrl(),
                    para: {
                        'bulletin_id': id
                    },
                    success: function() {
                        var new_url = $('wfl1001_blt_bulletin_detail_link').getUrl() + '?bulletin_id=' + id;
                        window.open(new_url, 'WFL_USER_MESSAGE_SHOW_WINDOWS', "left=" + 0 + ",top=" + 0 + ",width=" + (window.screen.availWidth - 10) + ",height=" + (window.screen.availHeight - 50) + ",status=0,toolbar=0,menubar=0,location=0,scrollbars=" + 1 + ",resizable=" + 1, false);
                    },
                    scope: this
                });
            }
            
            function wfl1001_showUserMessageDetail(id, url) {
                var new_url = url + id;
                window.open(new_url, 'WFL_USER_MESSAGE_SHOW_WINDOWS', "left=" + 0 + ",top=" + 0 + ",width=" + (window.screen.availWidth - 10) + ",height=" + (window.screen.availHeight - 50) + ",status=0,toolbar=0,menubar=0,location=0,scrollbars=" + 1 + ",resizable=" + 1, false);
            }
            
            function wfl1001_showSurveyReleaseDetail(id, url) {
                var new_url = url + id;
                window.open(new_url, 'WFL_USER_MESSAGE_SHOW_WINDOWS', "left=" + 0 + ",top=" + 0 + ",width=" + (window.screen.availWidth - 10) + ",height=" + (window.screen.availHeight - 50) + ",status=0,toolbar=0,menubar=0,location=0,scrollbars=" + 1 + ",resizable=" + 1, false);
                /*                 new Aurora.Window({
                 id: 'pur5730_vendor_survey_detail_win',
                 title: '${l:PUR_VENDOR_SURVEY.SURVEY_DETAIL}',
                 url: new_url,
                 width: 1500,
                 height:500
                 }); */
            }
            
            function wfl1001_showSurveySubmitDetail(id, url) {
                var new_url = url + id;
                window.open(new_url, 'WFL_USER_MESSAGE_SHOW_WINDOWS', "left=" + 0 + ",top=" + 0 + ",width=" + (window.screen.availWidth - 10) + ",height=" + (window.screen.availHeight - 50) + ",status=0,toolbar=0,menubar=0,location=0,scrollbars=" + 1 + ",resizable=" + 1, false);
            }
            
            
            function wfl1001_showUserMessageListDetail(_this, count, message_id, source_id, source_table, url, read_flag) {
                if (source_table != 'BLT_BULLETIN' && source_table != 'FND_COOP_PRATNER_REQ' && source_table != 'FND_COOP_PARTNER_REQ') {
                    var text_div = _this.children[2],
                        text = '';
                    if (text_div.innerText) {
                        text = text_div.innerText;
                    } else if (text_div.textContent) {
                        text = text_div.textContent;
                    }
                    //设置读取的样式
                    var parent = _this.parentNode;
                    var radio = parent.childNodes;
            
                    if (parent.getAttribute('read_flag') == 'false') {
                        _this.className = 'message-wrapper read';
                        var height = text_div.offsetHeight;
                        _this.style.height = height + 40 + 'px';
                        parent.style.height = height + 50 + 'px';
                        radio[0].childNodes[0].className = 'radios';
                        radio[1].childNodes[1].className = 'messageIconOver';
                        radio[1].childNodes[2].className = 'descriptions';
                        radio[1].childNodes[3].className = 'date';
                        parent.setAttribute('read_flag', 'true');
                    } else {
                        _this.className = 'message-wrapper';
                        parent.style.height = 80 + 'px';
                        _this.style.height = 80 + 'px';
                        radio[0].childNodes[0].className = 'radios';
                        radio[1].childNodes[1].className = 'messageIconOver';
                        radio[1].childNodes[2].className = 'descriptions';
                        radio[1].childNodes[3].className = 'date';
                        parent.setAttribute('read_flag', 'false');
                    }
            
                }
                Aurora.request({
                    url: $('wfl1001_sys_user_message_read_link').getUrl(),
                    para: {
                        'message_id': message_id
                    },
                    success: function() {
                        //点击“未读”的用户消息后，修改用户消息的样式，去掉标题和内容的加粗样式
                        if (read_flag == 'N') {
                            _this.children[0].setAttribute("style", "font-weight:normal;color:#666");
                        }
            
                        //打开用户消息
                        if (url != 'URL_NULL') {
                            if (source_table == 'BLT_BULLETIN') {
                                wfl1001_showBltBulletinDetail(source_id, url);
                            } else if (source_table == 'FND_COOP_PRATNER_REQ' || source_table == 'FND_COOP_PARTNER_REQ') {
                                wfl1001_showUserMessageDetail(source_id, url);
                            } else if (source_table == 'PUR_VENDOR_SURVEY_RELEASE') {
                                wfl1001_showSurveyReleaseDetail(source_id, url);
                            } else if (source_table == 'PUR_VENDOR_SURVEY_SUBMIT') {
                                wfl1001_showSurveySubmitDetail(source_id, url);
                            }
                        }
                    },
                    scope: this
                });
            }
            
            function wfl1001_deleteUserMessage(thisDiv, count, message_id, source_table) {
                var parent = thisDiv.parentNode;
                Aurora.request({
                    url: $('wfl1001_sys_user_message_delete_link').getUrl(),
                    para: {
                        'message_id': message_id,
                        'source_table': source_table
                    },
                    success: function() {
                        while (parent.nodeName != 'LI') {
                            parent = parent.parentNode;
                        }
                        parent.parentNode.removeChild(parent);
                    },
                    scope: this
                });
            }
            
            // 所有数据查询
            
            function wfl1001_all_message_search() {
                Aurora.request({
                    url: '${/request/@context_path}/modules/wfl/WFL1001/sys_favorite_function_view_new.svc',
                    para: {},
                    success: function(res) {
                        showRedStar(res);
                    }
                });
            }
            
            function showRedStar(record) {
                var result = record.result;
                if (result.data1 === 'Y') {
                    getElement('wfl_receivedInquirySheetForBuyer_span').style.display = 'inline-block';
                }
                if (result.data2 === 'Y') {
                    getElement('wfl_salesOrderUrgentStatisticsForRequire_span').style.display = 'inline-block';
                }
                if (result.data3 === 'Y') {
                    getElement('wfl_purchaseOrderUrgentStatisticsForSupply_span').style.display = 'inline-block';
                }
                if (result.data4 === 'Y') {
                    getElement('wfl_receivedInquirySheetForSupply_span').style.display = 'inline-block';
                }
                if (result.data5 === 'Y') {
                    getElement('wfl_purchaseOrderConfirmStatisticsForSupply_span').style.display = 'inline-block';
                }
                if (result.data6 === 'Y') {
                    getElement('wfl_purchaseOrderDeliverStatisticsForSupply_span').style.display = 'inline-block';
                }
                if (result.data7 === 'Y') {
                    getElement('wfl_quotationForSupply_span').style.display = 'inline-block';
                }
                if (result.data8 === 'Y') {
                    getElement('wfl_billApproveForRequire_span').style.display = 'inline-block';
                }
                if (result.data9 === 'Y') {
                    getElement('wfl_billApproveForSupply_span').style.display = 'inline-block';
                }
                if (result.data10 === 'Y') {
                    getElement('wfl_billCreateForSupply_span').style.display = 'inline-block';
                }
                if (result.data11 === 'Y') {
                    getElement('wfl_salesAsnEnabledToReceiveStatisticsForRequire_span').style.display = 'inline-block';
                }
                if (result.data12 === 'Y') {
                    getElement('wfl_asnEnabledToReceiveStatisticsForSupply_span').style.display = 'inline-block';
                }
                if (result.data13 === 'Y') {
                    getElement('wfl_billCreateForRequire_span').style.display = 'inline-block';
                }
                if (result.data14 === 'Y') {
                    getElement('wfl_invoiceForStatementForSupply_span').style.display = 'inline-block';
                }
            }
            
            function getElement(id) {
                return document.getElementById(id);
            }
            //采购方与供应商所有的非寄销数据汇总
            
            function wfl_AllOfThem_non_ds_loadFun(ds) {
                debugger;
                document.getElementById("wfl_receivedInquirySheetForBuyer_span").innerHTML = ds.getAt(0).get('received_quotation_count'); //采购方，收到的报价单
                document.getElementById("wfl_salesOrderUrgentStatisticsForRequire_span").innerHTML = ds.getAt(0).get('urgent_order_number_r'); //采购方，加急订单
                document.getElementById("wfl_salesAsnEnabledToReceiveStatisticsForRequire_span").innerHTML = ds.getAt(0).get('asn_count_require'); //采购方，待收货
                document.getElementById("wfl_quotationForSupply_span").innerHTML = ds.getAt(0).get('released_quotation_count'); //供应商，发出的报价单
                document.getElementById("wfl_purchaseOrderUrgentStatisticsForSupply_span").innerHTML = ds.getAt(0).get('urgent_order_number_s'); //供应商，加急订单
                document.getElementById("wfl_purchaseOrderConfirmStatisticsForSupply_span").innerHTML = ds.getAt(0).get('confirm_order_number'); //供应商，待确认
                document.getElementById("wfl_purchaseOrderDeliverStatisticsForSupply_span").innerHTML = ds.getAt(0).get('deliver_order_number'); //供应商，待发货
                document.getElementById("wfl_asnEnabledToReceiveStatisticsForSupply_span").innerHTML = ds.getAt(0).get('asn_count_supply'); //供应商，待买家收货
                //document.getElementById("wfl_billCreateForRequire_span").innerHTML = (document.getElementById("wfl_billCreateForRequire_span").innerText * 1) + ds.getAt(0).get('bill_create_count_csgn_r'); //采购方，待对账
                document.getElementById("wfl_billCreateForRequire_span").innerHTML = 0;
                document.getElementById("wfl_billApproveForRequire_span").innerHTML = 0;
                //document.getElementById("wfl_billApproveForRequire_span").innerHTML = (document.getElementById("wfl_billApproveForRequire_span").innerText * 1) + ds.getAt(0).get('bill_approve_count_csgn_r'); //采购方，待确认对账单
                document.getElementById("wfl_receivedInquirySheetForSupply_span").innerHTML = (document.getElementById("wfl_receivedInquirySheetForSupply_span").innerText * 1) + ds.getAt(0).get('received_inquiry_count_notin'); //供应商，收到的询价单,未参与
                //document.getElementById("wfl_billCreateForSupply_span").innerHTML = (document.getElementById("wfl_billCreateForSupply_span").innerText * 1) + ds.getAt(0).get('bill_create_count_csgn_s'); //供应商，待对账，寄销
                document.getElementById("wfl_billCreateForSupply_span").innerHTML = 0;
                document.getElementById("wfl_billApproveForSupply_span").innerHTML = (document.getElementById("wfl_billApproveForSupply_span").innerText * 1) + ds.getAt(0).get('bill_approve_count_csgn_s'); //供应商，待确认对账单，寄销
                document.getElementById("wfl_invoiceForStatementForSupply_span").innerHTML = (document.getElementById("wfl_invoiceForStatementForSupply_span").innerText * 1) + ds.getAt(0).get('invoice_create_count_csgn'); //供应商，待开票对账单，寄销
                if ((ds.getAt(0).get('bill_create_count_csgn_r') != 0) && (ds.getAt(0).get('bill_create_count_non_csgn_r') != 0)) { //采购方，待对账，寄销
                    document.getElementById("wfl_billCreateForRequire_span").style.color = 'red';
                }
                if ((ds.getAt(0).get('bill_approve_count_csgn_r') != 0) && (ds.getAt(0).get('bill_approve_count_non_csgn_r') != 0)) { //采购方，待确认对账单
                    document.getElementById("wfl_billApproveForRequire_span").style.color = 'red';
                }
                if (ds.getAt(0).get('received_inquiry_count_notin') != 0) { //供应商，收到的询价单,未参与
                    document.getElementById("wfl_receivedInquirySheetForSupply_span").style.color = 'red';
                }
                if ((ds.getAt(0).get('bill_create_count_csgn_s') != 0) && (ds.getAt(0).get('bill_create_count_non_csgn_s') != 0)) { //供应商，待对账，寄销
                    document.getElementById("wfl_billCreateForSupply_span").style.color = 'red';
                }
                // if ((ds.getAt(0).get('bill_approve_count_csgn_s') != 0) && (ds.getAt(0).get('bill_approve_count_non_csgn_s') != 0)) { //采购方，待对账
                // document.getElementById("wfl_billApproveForSupply_span").style.color = 'red';
                // }
                if ((ds.getAt(0).get('bill_approve_count_csgn_s') != 0)) { //采购方，待对账
                    document.getElementById("wfl_billApproveForSupply_span").style.color = 'red';
                }
                if ((ds.getAt(0).get('invoice_create_count_csgn') != 0) && (ds.getAt(0).get('invoice_create_count_non_csgn') != 0)) { //采购方，待确认对账单
                    document.getElementById("wfl_invoiceForStatementForSupply_span").style.color = 'red';
                }
                if (ds.getAt(0).get('received_quotation_count') != 0) { //采购方，收到的报价单
                    document.getElementById("wfl_receivedInquirySheetForBuyer_span").style.color = 'red';
                }
                if (ds.getAt(0).get('urgent_order_number_r') != 0) { //采购方，加急订单
                    document.getElementById("wfl_salesOrderUrgentStatisticsForRequire_span").style.color = 'red';
                }
                if (ds.getAt(0).get('asn_count_require') != 0) { //采购方，待收货
                    document.getElementById("wfl_salesAsnEnabledToReceiveStatisticsForRequire_span").style.color = 'red';
                }
                if (ds.getAt(0).get('released_quotation_count') != 0) { //供应商，发出的报价单
                    document.getElementById("wfl_quotationForSupply_span").style.color = 'red';
                }
                if (ds.getAt(0).get('confirm_order_number') != 0) { //供应商，待确认
                    document.getElementById("wfl_purchaseOrderConfirmStatisticsForSupply_span").style.color = 'red';
                }
                if (ds.getAt(0).get('urgent_order_number_s') != 0) { //供应商，加急订单
                    document.getElementById("wfl_purchaseOrderUrgentStatisticsForSupply_span").style.color = 'red';
                }
                if (ds.getAt(0).get('asn_count_supply') != 0) { //供应商，待买家收货
                    document.getElementById("wfl_asnEnabledToReceiveStatisticsForSupply_span").style.color = 'red';
                }
                if (ds.getAt(0).get('deliver_order_number') != 0) { //供应商，待对账，非寄销
                    document.getElementById("wfl_purchaseOrderDeliverStatisticsForSupply_span").style.color = 'red';
                }
            
            }
            //采购方与供应商所有的寄销数据汇总
            
            // function wfl_AllOfThem_ds_loadFun(ds) {
            // var m = $("wfl_AllOfThem_ds").getAll();
            // document.getElementById("wfl_billCreateForRequire_span").innerHTML = (document.getElementById("wfl_billCreateForRequire_span").innerText * 1) + ds.getAt(0).get('bill_create_count_csgn_r');//采购方，待对账
            // document.getElementById("wfl_billApproveForRequire_span").innerHTML = (document.getElementById("wfl_billApproveForRequire_span").innerText * 1) + ds.getAt(0).get('bill_approve_count_csgn_r');//采购方，待确认对账单
            // document.getElementById("wfl_receivedInquirySheetForSupply_span").innerHTML = (document.getElementById("wfl_receivedInquirySheetForSupply_span").innerText * 1) + ds.getAt(0).get('received_inquiry_count_notin');//供应商，收到的询价单,未参与
            // document.getElementById("wfl_billCreateForSupply_span").innerHTML = (document.getElementById("wfl_billCreateForSupply_span").innerText * 1) + ds.getAt(0).get('bill_create_count_csgn_s');//供应商，待对账，寄销
            // document.getElementById("wfl_billApproveForSupply_span").innerHTML = (document.getElementById("wfl_billApproveForSupply_span").innerText * 1) + ds.getAt(0).get('bill_approve_count_csgn_s');//供应商，待确认对账单，寄销
            // document.getElementById("wfl_invoiceForStatementForSupply_span").innerHTML = (document.getElementById("wfl_invoiceForStatementForSupply_span").innerText * 1) + ds.getAt(0).get('invoice_create_count_csgn');//供应商，待开票对账单，寄销
            // if(ds.getAt(0).get('bill_create_count_csgn_r')!=0){              //采购方，待对账，寄销
            // document.getElementById("wfl_billCreateForRequire_span").style.color = 'red';
            // } if(ds.getAt(0).get('bill_approve_count_csgn_r')!=0){           //采购方，待确认对账单
            // document.getElementById("wfl_billApproveForRequire_span").style.color = 'red';
            // } if(ds.getAt(0).get('received_inquiry_count_notin')!=0){        //供应商，收到的询价单,未参与
            // document.getElementById("wfl_receivedInquirySheetForSupply_span").style.color = 'red';
            // } if(ds.getAt(0).get('bill_create_count_csgn_s')!=0){            //供应商，待对账，寄销
            // document.getElementById("wfl_billCreateForSupply_span").style.color = 'red';
            // } if(ds.getAt(0).get('bill_approve_count_csgn_s')!=0){       //采购方，待对账
            // document.getElementById("wfl_billApproveForSupply_span").style.color = 'red';
            // } if(ds.getAt(0).get('invoice_create_count_csgn')!=0){       //采购方，待确认对账单
            // document.getElementById("wfl_invoiceForStatementForSupply_span").style.color = 'red';
            // }
            // }
            
            var user_phone = '${/model/sys_user_infor_ds/record/@mobile_phone}';
            var user_phone_verify = '${/model/sys_user_infor_ds/record/@mobile_phone_verify_flag}';
            var phone_bidding_flag = '${/model/sys_user_infor_ds/record/@phone_bidding_flag}';
            var user_email = '${/model/sys_user_infor_ds/record/@email}';
            var user_email_verify = '${/model/sys_user_infor_ds/record/@email_verify_flag}';
            var email_bidding_flag = '${/model/sys_user_infor_ds/record/@email_bidding_flag}';
            var email_check = '${/model/sys_user_infor_ds/record/@email_check}';
            
            function initValidateUserInfor() {
                // if ((!Aurora.isEmpty(user_phone) && user_phone_verify == 'Y' || phone_bidding_flag == 'N') && (!Aurora.isEmpty(user_email) && user_email_verify == 'Y' || email_bidding_flag == 'N')) {
                // return;
                // }
                if ((!Aurora.isEmpty(user_email) && user_email_verify == 'Y' || email_bidding_flag == 'N')) {
                    return;
                }
                sys_favorite_load();
            }
            
            function initValidateUserPayInfor() {
                var prompt_flag = '${/model/user_pay_info/record/@prompt_flag}';
                var last_date = ${/model/user_pay_info/record/@last_date};
                if (prompt_flag == 'N') {
                    initValidateUserInfor();
                } else {
                    if (prompt_flag == 'Y' && last_date <= 14) {
                        sys_favorite_pay_load(prompt_flag, last_date);
                    } else if (prompt_flag == 'S') {
                        sys_favorite_pay_load(prompt_flag, last_date);
                    } else {
                        initValidateUserInfor();
                    }
                }
            
            }
            
            function initVendorAgreementInfor() {
                var enable_flag = '${/model/vendor_agreement_info/record/@enable_flag}';
                var confirm_flag = '${/model/vendor_agreement_info/record/@confirm_flag}';
                if (enable_flag == 'Y' && confirm_flag == 'N') {
                    sys_favorite_agreement_load();
                }
            }
            
            function sys_favorite_back1() {
                var iframe = document.getElementById('ext_loadValidateIframe');
                iframe.parentNode.removeChild(iframe);
                var div = getId('ext-loadValidate');
                var _div = getId('ext-loadValidate_bg');
                div.parentNode.removeChild(div);
                _div.parentNode.removeChild(_div);
            }
            
            function sys_favorite_back2() {
                var iframe = document.getElementById('ext_loadValidateIframe2');
                iframe.parentNode.removeChild(iframe);
                var div = getId('ext-loadValidate2');
                var _div = getId('ext-loadValidate_bg2');
                div.parentNode.removeChild(div);
                _div.parentNode.removeChild(_div);
                //初始化，校验用户的手机和邮箱
                initValidateUserInfor();
            }
            
            function sys_favorite_back() {
                var iframe = document.getElementById('ext_loadValidateIframe');
                iframe.parentNode.removeChild(iframe);
                location.reload();
            }
            
            function sys_favorite_load() {
                var body = document.getElementById('ext-gen11');
                var div = document.createElement('div');
                div.id = 'ext-loadValidate';
                div.className = 'fGuide validate';
                body.appendChild(div);
                var _div = document.createElement('div');
                _div.className = 'fGuide validate_bg';
                _div.id = 'ext-loadValidate_bg';
                body.appendChild(_div);
                var html = '<iframe id="ext_loadValidateIframe" style="position: absolute;" allowtransparency="true" src="${/request/@context_path}/modules/wfl/WFL1001/sys_favorite_userInfor_validate.html" frameBorder="0" onload="main_iFrameHeight(\'ext_loadValidateIframe\',620,242)"></iframe>';
                div.innerHTML = html;
            }
            
            function sys_favorite_pay_load(prompt_flag, last_date) {
                var body = document.getElementById('ext-gen11');
                var div = document.createElement('div');
                div.id = 'ext-loadValidate2';
                div.className = 'fGuide validate';
                body.appendChild(div);
                var _div = document.createElement('div');
                _div.className = 'fGuide validate_bg';
                _div.id = 'ext-loadValidate_bg2';
                body.appendChild(_div);
                var html = '<iframe id="ext_loadValidateIframe2" style="position: absolute;"  allowtransparency="true" src="${/request/@context_path}/modules/pay/PAY5010/pay_validator.html?v=2.1' + '&prompt_flag=' + prompt_flag + '&last_date=' + last_date + '" frameBorder="0" onload="main_iFrameHeight(\'ext_loadValidateIframe2\',620,242)"></iframe>';
                div.innerHTML = html;
            }
            
              function initValidateVendorInfofor() {
              
                sys_favorite_vendor_info_load();
            }
           
                
             
		
		    
     
              function sys_favorite_vendor_info_load() {
                    var user_id='${/session/@user_id}';
                     console.log(user_id);
                  
                   var default_user_id='${/model/company_data/record/@default_user_id}';
		                /*  if(!Aurora.isEmpty(default_user_id)){
		                       var body = document.getElementById('ext-gen11');
				                var div = document.createElement('div');
				                div.id = 'ext-loadValidate3';
				                div.className = 'fGuide validate';
				                body.appendChild(div);
				                var _div = document.createElement('div');
				                _div.className = 'fGuide validate_bg';
				                _div.id = 'ext-loadValidate_bg3';
				                body.appendChild(_div);
				                var html = '<iframe id="ext_loadValidateIframe_atm" style="position: absolute;" allowtransparency="true" src="${/request/@context_path}/modules/wfl/WFL1001/sys_favorite_userAtm_validate.screen" frameBorder="0" onload="main_iFrameHeight(\'ext_loadValidateIframe_atm\',900,500)"></iframe>';
				                div.innerHTML = html; 
		                 }  */
		
                    console.log('1');
                    var company_id='${/session/@default_company_id}';
		            console.log(company_id);
                    var newVisitor = isNewVisitor();
                    var user_id='${/session/@user_id}';
                     console.log(user_id);
                    // 如果是新访客
		             if(newVisitor === true){
		                 var default_user_id='${/model/company_data/record/@default_user_id}';
		                 if(!Aurora.isEmpty(default_user_id)){
		                       var body = document.getElementById('ext-gen11');
				                var div = document.createElement('div');
				                div.id = 'ext-loadValidate3';
				                div.className = 'fGuide validate';
				                body.appendChild(div);
				                var _div = document.createElement('div');
				                _div.className = 'fGuide validate_bg';
				                _div.id = 'ext-loadValidate_bg3';
				                body.appendChild(_div);
				                var html = '<iframe id="ext_loadValidateIframe_atm" style="position: absolute;" allowtransparency="true" src="${/request/@context_path}/modules/wfl/WFL1001/sys_favorite_userAtm_validate.screen" frameBorder="0" onload="main_iFrameHeight(\'ext_loadValidateIframe_atm\',900,600)"></iframe>';
				                div.innerHTML = html; 
		                 }
		         // 动画弹出消息框
				       
		       // 标记：已经向该访客弹出过消息。30天之内不要再弹
		       setCookie("gznotes-visited"+user_id,"true", 31);
		       }   
            }
            
             function isNewVisitor() {
		     // 从cookie读取“已经向访客提示过消息”的标志位
		     
		       var user_id='${/session/@user_id}';
		       var flg = getCookie("gznotes-visited"+user_id);
		    
		        if (flg === "") {
		        return true;
		        } else {
		         return false;
		        }
		     }
		   // 写cookie
		     function setCookie(cname, cvalue, exdays) {
		       var d = new Date();
		       //d.setTime(d.getTime() + (exdays*24*60*60*1000));
		       var date=new Date(d.getFullYear(), d.getMonth()+1,0);
		       var expires = "expires="+date.toUTCString();
		       document.cookie = cname + "=" + cvalue + "; " + expires +";path=/";
		     } 
		     // 读cookie
		     function getCookie(cname) {
		       var name = cname + "=";
		       var ca = document.cookie.split(';');
		       for(var i=0; i<ca.length; i++) {
		          var c = ca[i];
		          while (c.charAt(0)==' ') c = c.substring(1);
		          if (c.indexOf(name) == 0) return c.substring(name.length,c.length);
		        }
		        return "";
		     }
            
             function sys_favorite_back3() {
                var iframe = document.getElementById('ext_loadValidateIframe_atm');
                iframe.parentNode.removeChild(iframe);
                var div = getId('ext-loadValidate3');
                var _div = getId('ext-loadValidate_bg3');
                div.parentNode.removeChild(div);
                _div.parentNode.removeChild(_div);
            }
            
            function sys_favorite_agreement_load() {
                var body = document.getElementById('ext-gen11');
                var div = document.createElement('div');
                div.id = 'ext-loadValidate2';
                div.className = 'fGuide validate';
                body.appendChild(div);
                var _div = document.createElement('div');
                _div.className = 'fGuide validate_bg';
                _div.id = 'ext-loadValidate_bg2';
                body.appendChild(_div);
                var html = '<iframe id="ext_loadValidateIframe2" style="position: absolute;"  allowtransparency="true" src="${/request/@context_path}/modules/wfl/WFL1001/fnd_config_cnt_agreement_confirm.screen?v=2.1' + '" frameBorder="0" onload="main_iFrameHeight(\'ext_loadValidateIframe2\',800,600)"></iframe>';
                div.innerHTML = html;
            }
            
            function functionGuide() {
                var body = document.getElementById('ext-gen11');
                var width = screen.availWidth;
                var div = document.createElement('div');
                div.id = 'ext-fGuide';
                div.className = 'fGuide';
                body.appendChild(div);
                var iframe = document.createElement("iframe");
                iframe.setAttribute("id", "ext_fGuideIframe");
                iframe.setAttribute("src", "${/request/@context_path}/modules/wfl/WFL1001/newrs_show.html");
                iframe.setAttribute("style", "height:100%;width:100%;border:0");
                iframe.setAttribute("onLoad", "main_iFrameHeight('ext-fGuid')");
                div.appendChild(iframe);
            }
            
            function main_iFrameHeight(id, width, height) {
                var ifm = document.getElementById(id);
                ifm.style.width = width + 'px';
                ifm.style.height = height + 'px';
                var screenHeight = ifm.parentNode.offsetHeight;
                var screenWidth = ifm.parentNode.offsetWidth;
                ifm.style.marginTop = (screenHeight - ifm.offsetHeight) / 2 + 'px';
                ifm.style.marginLeft = (screenWidth - ifm.offsetWidth) / 2 + 'px';
                ifm.style.backgroundColor = 'transparent';
            }
            
            function close_tip() {
                var div = document.getElementById('ext-fGuide');
                div.parentNode.removeChild(div);
            }
            
            function finance_url_request() {
                window.open($('finance_url_request_link').getUrl());
            }
        ]]></script>
        <script><![CDATA[
            //获取整个标签页里的所有元素
            var oDiv = document.getElementById("tab");
            //获取tab-title下的所有li元素
            var oLi = oDiv.getElementsByTagName("div")[0].getElementsByTagName("li");
            //获取整个标签页的第二个div下的所有直接子节点
            var oCon = document.getElementById("tab-content").childNodes;
            var timer = null;
            //为第一个div下的所有li元素添加点击事件
            for (var i = 0;i < oLi.length - 1;i++) {
                oLi[i].index = i;
                oLi[i].setAttribute('onclick_flag', 'flase');
                oLi[i].onclick = function() {
                    show(this.index);
                    this.setAttribute('onclick_flag', 'true');
                };
            }
            //点击事件的实现函数
            
            function show(a) {
                if (a != 5) {
                    index = a;
                    var alpha = 0;
                    for (var j = 0;j < oLi.length - 2;j++) {
                        //将li元素设为无样式
                        oLi[j].className = "tab-title-li";
                        //将内容显示区域的div的样式变为
                        oCon[j].className = "tab-content";
                    }
                    if (a == 0) {
                        document.getElementById('my-sys-message').style.display = 'block';
                    } else if (a == 1) {
                        document.getElementById('my-sys-message').style.display = 'none';
                        if (oLi[1].getAttribute('onclick_flag') == 'flase') {
                            $('wfl1001_owner_messages_list_ds').query();
                        }
                    } else if (a == 2) {
                        document.getElementById('my-sys-message').style.display = 'none';
                        if (oLi[2].getAttribute('onclick_flag') == 'flase') {
                            $('wfl1001_rfx_messages_list_ds').query();
                        }
                    } else if (a == 3) {
                        document.getElementById('my-sys-message').style.display = 'none';
                        if (oLi[3].getAttribute('onclick_flag') == 'flase') {
                            $('wfl1001_coop_messages_list_ds').query();
                        }
                    } else if (a == 4) {
                        document.getElementById('my-sys-message').style.display = 'none';
                        if (oLi[4].getAttribute('onclick_flag') == 'flase') {
                            $('wfl1001_platform_messages_list_ds').query();
                        }
                    }
                    oLi[index].className = "tab-title-li active";
                    oCon[index].className = 'tab-content show';
                    clearInterval(timer);
                }
            }
            
            function edit() {
                var url = "${/request/@context_path}/modules/wfl/WFL1001/sys_user_common_function.screen?function_id=" + id;
                new Aurora.Window({
                    id: 'wfl1001_sys_user_common_function_window',
                    title: '${l:WFL_HOME_PAGE.COMMON_FUNCTION}',
                    url: url,
                    height: 450,
                    width: 800
                });
            }
            
            function wfl1001_sysUserCommonFunctionListLoad(dataset) {
                wfl1001_sysUserCommonFunctionList(dataset);
            }
            
            function wfl1001_sysUserCommonFunctionList(dataset) {
                var records = dataset.getAll();
                var record, ul, TagI, TagA, rows, child;
                var length = records.length;
                var order_sequence = [];
                var icon = [];
                var function_byname = [];
                var service_name = [];
                var mod_row = [];
                var function_code = [];
                rows = Math.ceil(length / 4);
                var common_used_function = document.getElementById('common-used-function');
                var businessNotificationCount = '${/model/wfl1001_business_notification_count/record/@business_notification_count}';
                var approve_num = '${/model/wfl1001_business_notification_count/record/@approve_num}';
                ul = document.getElementById('common_used_function_list');
                ul.innerHTML = '';
                TagI = ul.getElementsByTagName('i');
                TagA = ul.getElementsByTagName('a');
                if (rows == 0) {
                    common_used_function.style.height = 105 + 'px';
                    li = window.document.createElement('LI');
                    TagA = '<span style="color:#999;cursor:text;padding:10px;text-align:center;text-decoration:none;font-size:16px;">' + '${l:WFL1001.NOT_CONFIGURED}' + '</span>';
                    li.innerHTML = TagA;
                    li.style.borderRight = 'none';
                    li.style.cursor = 'default';
                    ul.appendChild(li);
                } else {
                    for (var i = 0;i < length;i++) {
                        li = window.document.createElement('LI');
                        order_sequence[i] = records[i].data.order_sequence;
                        icon[i] = records[i].data.icon;
                        service_name[i] = records[i].data.service_name;
                        function_byname[i] = records[i].data.function_byname;
                        function_code[i] = records[i].data.function_code;
                        I = '<i class="icon icon-' + icon[i] + '"></i>';
                        mod_row[i] = records[i].data.mod_row;
                        if (mod_row[i] == 0) {
                            li.style.borderRight = 'none';
                        } else {
                            li.style.borderRight = '1px solid #f7f8fc';
                        }
                        TagI = '<i class="icon icon-' + icon[i] + '"></i>';
                        TagA = '<a onclick="javascript:wfl1001_sidebarOnclick(' + "'" + service_name[i] + '?function_code=' + function_code[i] + "'" + ',' + "'" + function_byname[i] + "'" + ' );">' + function_byname[i] + '</a>';
                        if (service_name[i] == 'modules/fnd/FND9510/fnd_business_notification_query_main.screen') {
                            TagA = '<a onclick="javascript:wfl1001_sidebarOnclick(' + "'" + service_name[i] + '?function_code=' + function_code[i]  + "'" + ',' + "'" + function_byname[i] + "'" + ' );">' + function_byname[i] + '（';
                            TagA += '<span id="wfl1001_businessNotificationCount">0';
                            TagA += '</span>）</a>';
                        }
                        if (service_name[i] == 'modules/wfl/WFL5010/wfl_instance_node_recipient.screen') {
                            TagA = '<a onclick="javascript:wfl1001_sidebarOnclick(' + "'" + service_name[i] + '?function_code=' + function_code[i]  + "'" + ',' + "'" + function_byname[i] + "'" + ' );">' + function_byname[i] + '（';
                            TagA += '<span id="wfl_workflowInstanceForTodoCount">0';
                            TagA += '</span>）</a>';
                        }
                        li.innerHTML = TagI + TagA;
                        ul.appendChild(li);
                        if ((businessNotificationCount != 0) && (service_name[i] == 'modules/fnd/FND9510/fnd_business_notification_query_main.screen')) {
                            document.getElementById("wfl1001_businessNotificationCount").style.color = 'red';
                            document.getElementById("wfl1001_businessNotificationCount").innerHTML = businessNotificationCount;
                        }
                        if ((approve_num != 0) && (service_name[i] == 'modules/wfl/WFL5010/wfl_instance_node_recipient.screen')) {
                            document.getElementById("wfl_workflowInstanceForTodoCount").style.color = 'red';
                            document.getElementById("wfl_workflowInstanceForTodoCount").innerHTML = approve_num;
                        }
                    }
                }
            }
            
            function refresh() {
                var list = document.getElementsByClassName('tab-title-li active');
                var list_index = list[0].index;
                var tab_index = list_index + 1;
                var ul = null;
                var timer = null;
                var tab_content = document.getElementById('tab-son' + tab_index);
                var show_more_btn = tab_content.getElementsByClassName('showmore')[0];
                show_more_btn.style.display = 'none';
                var scrollHeight = document.getElementsByClassName('hand-main-content')[1].scrollTop;
            
                if (list_index == 0) {
                    ul = document.getElementById('sys_messages_list_div_view');
                    ul.innerHTML = '';
                    $('wfl1001_sys_messages_list_ds').query();
                } else if (list_index == 1) {
                    ul = document.getElementById('owner_messages_list_div_view');
                    ul.innerHTML = '';
                    $('wfl1001_owner_messages_list_ds').query();
                } else if (list_index == 2) {
                    ul = document.getElementById('rfx_messages_list_div_view');
                    ul.innerHTML = '';
                    $('wfl1001_rfx_messages_list_ds').query();
                } else if (list_index == 3) {
                    ul = document.getElementById('coop_messages_list_div_view');
                    ul.innerHTML = '';
                    $('wfl1001_coop_messages_list_ds').query();
                } else if (list_index == 4) {
                    ul = document.getElementById('platform_messages_list_div_view');
                    ul.innerHTML = '';
                    $('wfl1001_platform_messages_list_ds').query();
                }
                timer = setTimeout(function() {
                    document.getElementsByClassName('hand-main-content')[1].scrollTop = scrollHeight;
                }, 500);
            
            }
            
            function tradeClick(_this){
                var classListName = _this.classList;
                if(classListName.contains('hide')){
                    _this.classList.remove('hide');
                    _this.classList.add('show');
                    wfl1001_all_message_search();
                    jQuery('#trade-btn').animate({
                        left: 15
                    },300);
                    Aurora.setCookie('tradeDefault','true',10000);
                }else{
                    _this.classList.remove('show');
                    _this.classList.add('hide');
                    jQuery('#trade-btn').animate({
                        left: 0
                    },300);
                    jQuery('.redStar').css('display','none');
                    Aurora.setCookie('tradeDefault','false', 10000);
                }
            }
        ]]></script>
        <body>
            <a:dataSets>
                <!-- 采购方与供应商的所有非寄销数据   -->
                <a:dataSet id="wfl_AllOfThemNon_ds" autoQuery="true" model="sys.SYS_WFL.all_of_them">
                    <a:events>
                        <a:event name="load" handler="wfl_AllOfThem_non_ds_loadFun"/>
                    </a:events>
                </a:dataSet>
                <!-- 采购方与供应商的所有寄销数据   -->
                <!--                 <a:dataSet id="wfl_AllOfThem_ds" autoQuery="true" model="sys.SYS_WFL.all_of_them">
                    <a:events>
                        <a:event name="load" handler="wfl_AllOfThem_ds_loadFun"/>
                    </a:events>
                </a:dataSet> -->
                <!-- 角色 -->
                <a:dataSet id="role_list_ds" autoQuery="true" fetchAll="true" model="sys.sys_user_role_groups"/>
                <a:dataSet id="role_ds" autoCreate="true">
                    <a:fields>
                        <a:field name="role_id" defaultValue="${/model/default_role_name/record/@role_id}"/>
                        <a:field name="role_code" defaultValue="${/model/default_role_name/record/@role_code}"/>
                        <a:field name="role_name" defaultValue="${/model/default_role_name/record/@role_name}" displayField="role_name" options="role_list_ds">
                            <a:mapping>
                                <a:map from="role_id" to="role_id"/>
                                <a:map from="role_code" to="role_code"/>
                            </a:mapping>
                        </a:field>
                    </a:fields>
                    <a:events>
                        <a:event name="update" handler="roleSelectUpdateFunction"/>
                    </a:events>
                </a:dataSet>
                <!-- 常用功能  -->
                <a:dataSet id="sys_user_common_function_list" autoQuery="true" fetchAll="true" model="sys.SYS_WFL.sys_user_common_function" queryUrl="${/request/@context_path}/autocrud/sys.SYS_WFL.sys_user_common_function/query">
                    <a:events>
                        <a:event name="load" handler="wfl1001_sysUserCommonFunctionListLoad"/>
                    </a:events>
                </a:dataSet>
                <!-- 商友圈 -->
                <a:dataSet id="wfl1001_coop_messages_list_ds" autoQuery="false" model="sys.SYS_WFL.sys_coop_bulletin_list" pageSize="5" queryUrl="${/request/@context_path}/autocrud/sys.SYS_WFL.sys_coop_bulletin_list/query?pagenum_from=1">
                    <a:events>
                        <a:event name="load" handler="wfl1001_coopMessagesListDsLoad"/>
                    </a:events>
                </a:dataSet>
                <!-- 公司动态 -->
                <a:dataSet id="wfl1001_owner_messages_list_ds" autoQuery="false" model="sys.SYS_WFL.sys_owner_bulletin_list" pageSize="5" queryUrl="${/request/@context_path}/autocrud/sys.SYS_WFL.sys_owner_bulletin_list/query?pagenum_from=1">
                    <a:events>
                        <a:event name="load" handler="wfl1001_ownerMessagesListDsLoad"/>
                    </a:events>
                </a:dataSet>
                <!-- 求购动态(rfx) -->
                <a:dataSet id="wfl1001_rfx_messages_list_ds" autoQuery="false" model="sys.SYS_WFL.sys_rfx_list" pageSize="5" queryUrl="${/request/@context_path}/autocrud/sys.SYS_WFL.sys_rfx_list/query?pagenum_from=1">
                    <a:events>
                        <a:event name="load" handler="wfl1001_rfxMessagesListDsLoad"/>
                    </a:events>
                </a:dataSet>
                <!-- 系统消息 -->
                <a:dataSet id="wfl1001_sys_messages_list_ds" autoQuery="true" model="sys.SYS_WFL.sys_system_message_list" pageSize="5" queryUrl="${/request/@context_path}/autocrud/sys.SYS_WFL.sys_system_message_list/query?pagenum_from=1">
                    <a:events>
                        <a:event name="load" handler="wfl1001_sysMessagesListDsLoad"/>
                    </a:events>
                </a:dataSet>
                <!-- 行业消息 -->
                <a:dataSet id="wfl1001_platform_messages_list_ds" autoQuery="false" model="sys.SYS_WFL.sys_platform_message_list" pageSize="5" queryUrl="${/request/@context_path}/autocrud/sys.SYS_WFL.sys_platform_message_list/query?pagenum_from=1">
                    <a:events>
                        <a:event name="load" handler="wfl1001_platformMessagesListDsLoad"/>
                    </a:events>
                </a:dataSet>
                <!-- 日历 -->
                <!--  <a:dataSet id="wfl1001_user_schedule_messages_ds" fetchAll="true" loadData="true" model="sys.sys_schedule_messages">
                <a:events>
                    <a:event name="load" handler="onLoadUserMessageEvent"/>
                </a:events>
            </a:dataSet> -->
                <!-- 首页单据数量 start -->
                <!-- 首页单据数量 end -->
            </a:dataSets>
            <!--内容概要-->
            <div id="content">
                <div id="head">
                    <div id="user_info">
                        <ul class="fr">
                            <li class="select-role">
                                <a:comboBox name="role_name" bindTarget="role_ds" style="font-size: 12px; width:150px;"/>
                            </li>
                            <!--combox标签-->
                            <div class="fl user_info_image" onclick="openFunction(&apos;modules/wfl/WFL1001/sys_user_personal_page.screen&apos;, &apos;${l:WFL1001.HOMEPAGE}&apos;)">
                                <img class="user-infor-img" src="${/request/@context_path}/images/headIcon.png" title="个人中心"/>
                            </div>
                            <li style="margin-top:17px;">
                                <a onclick="exitSystem()" style="font-weight:600"><![CDATA[${l:SYS.EXIT}]]></a>
                            </li>
                            <li style="margin-top:18px;"><![CDATA[|]]></li>
                            <li onclick="javascript:openFunction(&apos;modules/wfl/WFL1001/sys_user_personal_page.screen&apos;, &apos;${l:WFL1001.HOMEPAGE}&apos;)" style="margin-top:17px;"><![CDATA[
                                ${/model/sys_user_infor_ds/record/@description}
                            ]]></li>
                        </ul>
                        <ul class="fl">
                            <li style="float:left;margin:15px 0 0 30px;">
                                <span><![CDATA[${l:WFL1001.GROUP}：]]></span>
                                <span id="company" style="font-weight:900"><![CDATA[${/model/sys_user_infor_ds/record/@business_group_name}]]></span>
                            </li>
                        </ul>
                    </div>
                </div>
                <div id="common-used-function">
                    <div class="common-used-function-title">
                        <span><![CDATA[${l:WFL_HOME_PAGE.COMMON_FUNCTION}]]></span>
                        <a id="edit" href="javascript:edit()">
                            <i class="icon-gear"/>
                            <span style="position:relative;left:-6px;"><![CDATA[${l:WFL1001.CONFIGURATION}]]></span>
                        </a>
                    </div>
                    <div class="common-used-function-list">
                        <ul id="common_used_function_list"/>
                    </div>
                </div>
                <div class="trade-state-label">
                    <div class="trade-state-label-title">
                        <ul>
                            <li style="width:7%;margin-left:18%;"><![CDATA[${l:WFL_HOME_PAGE.BEFORE_TRADE}]]></li>
                            <li style="width:15%;padding-top:2px;margin-left:30px;">
                                <hr/>
                            </li>
                            <li style="width:7%;margin-left:4%;"><![CDATA[${l:WFL_HOME_PAGE.TRADING_IN}]]></li>
                            <li style="width:15%;padding-top:2px">
                                <hr/>
                            </li>
                            <li style="width:7%;margin-left:3%;"><![CDATA[${l:WFL_HOME_PAGE.AFTER_TRADE}]]></li>
                            <!-- <li style="width:100px;float:right;margin-right: 20px;">
                                <span class="trade-text"><![CDATA[交易提醒]]></span>
                                <span id="trade-btn-bg" class="trade-btn-bg hide" onclick="javascript:tradeClick(this);">
                                    <span id="trade-btn" class="trade-btn"/>
                                </span>
                            </li> -->
                        </ul>
                    </div>
                    <div id="require-state-label" class="require-state-label">
                        <div class="purchase"><![CDATA[${l:WFL1001.PURCHASE}]]></div>
                        <ul class="require-state-label-before">
                            <!--数字最多支持12位数-->
                            <li style="width:100px;">
                                <a id="receivedInquirySheetForBuyerLink" href="#">
                                    <span><![CDATA[${l:WFL_HOME_PAGE.RECEIVED_INQUIRY_SHEET_FOR_BUYER}（]]></span>
                                    <span id="wfl_receivedInquirySheetForBuyer_span"><![CDATA[0]]></span>
                                    <span><![CDATA[）]]></span>
                                </a>
                            </li>
                            <!--数字最多支持7位数-->
                            <li style="margin-left:10%;width:60px;text-align: center">
                                <a id="purchaseOrderLink" href="#">
                                    <span><![CDATA[${l:WFL_HOME_PAGE.URGENT_PO}（]]></span>
                                    <span id="wfl_salesOrderUrgentStatisticsForRequire_span"><![CDATA[0]]></span>
                                    <span><![CDATA[）]]></span>
                                </a>
                            </li>
                        </ul>
                        <ul class="require-state-label-during">
                            <!--数字最多支持7位数-->
                            <li style="width:60px;text-align: center;margin-left:37%;">
                                <a id="asnReceiveStatisticsForRequireLink" href="#">
                                    <spann><![CDATA[${l:WFL_HOME_PAGE.TO_BE_RECEIVED}（]]></spann>
                                    <span id="wfl_salesAsnEnabledToReceiveStatisticsForRequire_span"><![CDATA[0]]></span>
                                    <span><![CDATA[）]]></span>
                                </a>
                            </li>
                        </ul>
                        <ul class="require-state-label-after">
                            <!--数字最多支持12位数-->
                            <li style="margin-left:20%;width:84px;text-align: center">
                                <a id="billApproveForRequireLink" href="#">
                                    <spann><![CDATA[${l:WFL_HOME_PAGE.TO_BE_CONFIRM_BILL}（]]></spann>
                                    <span id="wfl_billApproveForRequire_span"><![CDATA[0]]></span>
                                    <span><![CDATA[）]]></span>
                                </a>
                            </li>
                            <!--数字最多支持7位数-->
                            <li style="margin-left:10%;width:60px;text-align: center">
                                <a id="billCreateForRequireLink" href="#">
                                    <spann><![CDATA[${l:WFL_HOME_PAGE.TO_BE_BILLED}（]]></spann>
                                    <span id="wfl_billCreateForRequire_span"><![CDATA[0]]></span>
                                    <span><![CDATA[）]]></span>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div id="supply-state-label" class="supply-state-label">
                        <div class="sale"><![CDATA[${l:WFL1001.SALES}]]></div>
                        <ul class="require-state-label-before">
                            <!--数字最多支持12位数-->
                            <li style="width:100px;text-align: center">
                                <a id="receivedInquirySheetForSupplyLink" href="#">
                                    <spann><![CDATA[${l:WFL_HOME_PAGE.RECEIVED_INQUIRY_SHEET_FOR_SALER}（]]></spann>
                                    <span id="wfl_receivedInquirySheetForSupply_span"><![CDATA[0]]></span>
                                    <span><![CDATA[）]]></span>
                                </a>
                            </li>
                            <!--数字最多支持7位数-->
                            <li style="width:60px;text-align: center">
                                <a id="purchaseOrderUrgentStatisticsForSupplyLink" href="#">
                                    <spann><![CDATA[${l:WFL_HOME_PAGE.URGENT_PO}（]]></spann>
                                    <span id="wfl_purchaseOrderUrgentStatisticsForSupply_span"><![CDATA[0]]></span>
                                    <span><![CDATA[）]]></span>
                                </a>
                            </li>
                            <!--数字最多支持7位数-->
                            <li style="width:60px;text-align: center">
                                <a id="salesSendForSupplyLink" href="#">
                                    <span><![CDATA[${l:WFL_HOME_PAGE.TO_BE_SHIPPED}（]]></span>
                                    <span id="wfl_purchaseOrderDeliverStatisticsForSupply_span"><![CDATA[0]]></span>
                                    <span><![CDATA[）]]></span>
                                </a>
                            </li>
                            <!--数字最多支持12位数-->
                            <li style="width:100px;text-align: center">
                                <a id="quotationForSupplyLink" href="#">
                                    <spann><![CDATA[${l:WFL_HOME_PAGE.QUOTATION}（]]></spann>
                                    <span id="wfl_quotationForSupply_span"><![CDATA[0]]></span>
                                    <span><![CDATA[）]]></span>
                                </a>
                            </li>
                            <!--数字最多支持7位数-->
                            <li style="width:60px;text-align: center">
                                <a id="purchaseOrderConfirmStatisticsForSupplyLink" href="#">
                                    <spann><![CDATA[${l:WFL_HOME_PAGE.TO_BE_CONFIRMED}（]]></spann>
                                    <span id="wfl_purchaseOrderConfirmStatisticsForSupply_span"><![CDATA[0]]></span>
                                    <span><![CDATA[）]]></span>
                                </a>
                            </li>
                        </ul>
                        <ul class="require-state-label-during">
                            <!--数字最多支持10位数-->
                            <li style="width:85px;text-align:center;margin-left:32%;">
                                <!-- 供应商，待买家收货 -->
                                <a id="toPurchaseReceiveForSupplyLink" href="#">
                                    <span><![CDATA[${l:WFL_HOME_PAGE.TO_BE_RECEIVED_BY_BUYER}（]]></span>
                                    <span id="wfl_asnEnabledToReceiveStatisticsForSupply_span"><![CDATA[0]]></span>
                                    <span><![CDATA[）]]></span>
                                </a>
                            </li>
                        </ul>
                        <ul class="require-state-label-after">
                            <li style="margin-left:20%;width:84px;text-align: center">
                                <!-- 供应商，待确认对账单 -->
                                <a id="billApproveForSupplyLink" href="#">
                                    <span><![CDATA[${l:WFL_HOME_PAGE.TO_BE_CONFIRM_BILL}（]]></span>
                                    <span id="wfl_billApproveForSupply_span"><![CDATA[0]]></span>
                                    <span><![CDATA[）]]></span>
                                </a>
                            </li>
                            <li style="margin-left:10%;width:60px;text-align: center">
                                <!-- 供应商，待对账，最多支持7位数字 -->
                                <a id="billCreateForSupplyLink" href="#">
                                    <span><![CDATA[${l:WFL_HOME_PAGE.TO_BE_BILLED}（]]></span>
                                    <span id="wfl_billCreateForSupply_span"><![CDATA[0]]></span>
                                    <span><![CDATA[）]]></span>
                                </a>
                            </li>
                            <li style="margin-left:20%;margin-top:20px;float: left;width:84px;text-align: center">
                                <!-- 供应商，待开票对账单 -->
                                <a id="invoiceForStatementForSupplyLink" href="#">
                                    <span><![CDATA[${l:WFL_HOME_PAGE.INVOICE_FOR_STATEMENT}（]]></span>
                                    <span id="wfl_invoiceForStatementForSupply_span"><![CDATA[0]]></span>
                                    <span><![CDATA[）]]></span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
                <div id="tab">
                    <div class="tab-title">
                        <ul id="tab-title">
                            <li id="tab-son1-title" class="tab-title-li active">
                                <a><![CDATA[${l:WFL1001.SYSTEM_NEWS}]]></a>
                            </li>
                            <span><![CDATA[|]]></span>
                            <li id="tab-son2-title" class="tab-title-li">
                                <a><![CDATA[${l:WFL1001.GROUP_NEWS}]]></a>
                            </li>
                            <span><![CDATA[|]]></span>
                            <li id="tab-son3-title" class="tab-title-li">
                                <a><![CDATA[${l:WFL1001.BUYING_NEWS}]]></a>
                            </li>
                            <span><![CDATA[|]]></span>
                            <li id="tab-son4-title" class="tab-title-li">
                                <a><![CDATA[${l:WFL1001.BUSINESS_CIRCLE}]]></a>
                            </li>
                            <span><![CDATA[|]]></span>
                            <li id="tab-son5-title" class="tab-title-li">
                                <a><![CDATA[${l:WFL1001.INDUSTRY_NEWS}]]></a>
                            </li>
                            <span><![CDATA[|]]></span>
                        </ul>
                        <ul class="refresh-ul">
                            <li class="refresh">
                                <a class="refresh-btn" onclick="refresh()">
                                    <i class="icon-refresh">
                                        <span class="refresh-span"><![CDATA[${l:WFL1001.REFRESH}]]></span>
                                    </i>
                                </a>
                            </li>
                            <li id="my-sys-message" class="my-sys-message">
                                <a class="refresh-btn" onclick="javascript:wfl1001_sidebarOnclick(&apos;modules/sys/SYS7040/sys_messages_query.screen?function_code=SYS7040&apos;,&apos;我的系统消息&apos;)">
                                    <i class="icon-reorder">
                                        <span class="refresh-span"><![CDATA[${l:WFL1001.NEWS_LISTS}]]></span>
                                    </i>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div id="tab-content">
                        <!--系统消息-->
                        <div id="tab-son1" class="tab-content show">
                            <div class="scroller" data-always-visible="1" data-height="450px" style="background-color: #fff">
                                <div class="tiles white">
                                    <div class="tiles-body">
                                        <div class="user_messages_list_content" style="padding-top: 20px">
                                            <!-- <ul id="user_messages_list_div_view"/> -->
                                            <ul id="sys_messages_list_div_view"/>
                                        </div>
                                    </div>
                                    <div id="wfl1001_sysMessagesListShowMoreDiv" class="showmore">
                                        <a class="handle" href="javascript:wfl1001_showMoreSysMessagesList()"><![CDATA[${l:WFL_HOME_PAGE.SHOW_MORE}]]></a>
                                    </div>
                                    <!-- <div id="wfl1001_userMessagesListShowMoreDiv" class="showmore">
                                                            <a class="handle" href="javascript:wfl1001_showMoreUserMessagesList()"><![CDATA[${l:WFL_HOME_PAGE.SHOW_MORE}]]></a>
                                                        </div> -->
                                    <div class="row spacing-bottom"/>
                                </div>
                            </div>
                        </div>
                        <div id="tab-son2" class="tab-content">
                            <div class="scroller" data-always-visible="1" data-height="450px" style="background-color: #fff">
                                <div class="tiles white">
                                    <div class="tiles-body">
                                        <div class="user_messages_list_content" style="padding-top: 20px">
                                            <ul id="owner_messages_list_div_view"/>
                                        </div>
                                    </div>
                                    <div id="wfl1001_ownerMessagesListShowMoreDiv" class="showmore">
                                        <a class="handle" href="javascript:wfl1001_showMoreOwnerMessagesList()"><![CDATA[${l:WFL_HOME_PAGE.SHOW_MORE}]]></a>
                                    </div>
                                    <div class="row spacing-bottom"/>
                                </div>
                            </div>
                        </div>
                        <div id="tab-son3" class="tab-content">
                            <div class="scroller" data-always-visible="1" data-height="450px" style="background-color: #fff">
                                <div class="tiles white">
                                    <div class="tiles-body">
                                        <div class="user_messages_list_content" style="padding-top: 20px">
                                            <ul id="rfx_messages_list_div_view"/>
                                        </div>
                                    </div>
                                    <div id="wfl1001_rfxMessagesListShowMoreDiv" class="showmore">
                                        <a class="handle" href="javascript:wfl1001_showMoreRfxMessagesList()"><![CDATA[${l:WFL_HOME_PAGE.SHOW_MORE}]]></a>
                                    </div>
                                    <div class="row spacing-bottom"/>
                                </div>
                            </div>
                        </div>
                        <div id="tab-son4" class="tab-content">
                            <div class="scroller" data-always-visible="1" data-height="450px" style="background-color: #fff">
                                <div class="tiles white">
                                    <div class="tiles-body">
                                        <div class="user_messages_list_content" style="padding-top: 20px">
                                            <ul id="coop_messages_list_div_view"/>
                                        </div>
                                    </div>
                                    <div id="wfl1001_coopMessagesListShowMoreDiv" class="showmore">
                                        <a class="handle" href="javascript:wfl1001_showMoreCoopMessagesList()"><![CDATA[${l:WFL_HOME_PAGE.SHOW_MORE}]]></a>
                                    </div>
                                    <div class="row spacing-bottom"/>
                                </div>
                            </div>
                        </div>
                        <div id="tab-son5" class="tab-content">
                            <div class="scroller" data-always-visible="1" data-height="450px" style="background-color: #fff">
                                <div class="tiles white">
                                    <div class="tiles-body">
                                        <!-- <div class="controller">
                                                                <a class="reload" href="javascript:wfl1001_userMessageListRefreshBusiness();"/>
                                                            </div>
                                                            <br/>
                                                            <div class="user_messages_viewBusiness_list_content">
                                                                <ul id="user_messages_list_div_viewBusiness"/>
                                                            </div> -->
                                        <div class="user_messages_list_content" style="padding-top: 20px">
                                            <ul id="platform_messages_list_div_view"/>
                                        </div>
                                    </div>
                                    <!--  <div id="wfl1001_userMessagesListShowMoreDivBusiness" class="showmore">
                                                            <a class="handle" href="javascript:wfl1001_showMoreUserMessagesListBusiness()"><![CDATA[${l:WFL_HOME_PAGE.SHOW_MORE}]]></a>
                                                        </div> -->
                                    <div id="wfl1001_platformMessagesListShowMoreDiv" class="showmore">
                                        <a class="handle" href="javascript:wfl1001_showMorePlatformMessagesList()"><![CDATA[${l:WFL_HOME_PAGE.SHOW_MORE}]]></a>
                                    </div>
                                    <div class="row spacing-bottom"/>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </body>
        <script><![CDATA[
            //init();
        ]]></script>
    </a:view>
</a:screen>
