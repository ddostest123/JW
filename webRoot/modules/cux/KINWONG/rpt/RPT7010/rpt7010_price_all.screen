<?xml version="1.0" encoding="UTF-8"?>
<a:screen xmlns:a="http://www.aurora-framework.org/application" xmlns:s="aurora.plugin.script" trace="true">
    <a:init-procedure>
        <a:model-query model="cux.KINWONG.rpt.RPT7010.rpt7010_category_all_query" rootPath="category_all"/>
        <a:model-query model="cux.KINWONG.rpt.RPT7010.rpt7010_chart_category_all_query" rootPath="chart_category_all"/>
        <a:model-query model="cux.KINWONG.rpt.RPT7010.rpt_year_query" rootPath="year_all"/>
        <a:model-query model="cux.KINWONG.rpt.RPT7010.rpt_month_query" rootPath="month_all"/>
        <a:model-query model="cux.KINWONG.rpt.RPT7010.rpt_year_query" rootPath="year_all"/>
        <a:model-query model="cux.KINWONG.rpt.RPT7010.rpt_current_year_month_query" rootPath="year_month_all"/>
        <s:server-script><![CDATA[
            var logger = $logger('server-script');
            
            function log(msg) {
                logger.info(msg);
            }
            log($ctx.toXML());
            var array = $ctx.get('/model/category_all').getChildren();
            var config = $config(); //取到config对象
            var columns = CompositeUtil.findChild(config, 'grid', 'id', 'rpt7010_result_grid').getChild('columns');
            
            var fields = CompositeUtil.findChild(config, 'dataSet', 'id', 'rpt7010_chart_result_ds').getChild('fields');
            for (var i = 0;i < array.length;i++) {
                if (i == 0 || array[i]['name_type'] != array[i - 1]['name_type']) {
                    var column = new CompositeMap('column');
                    // column['prompt'] = array[i]['name_type'];
                    // column['align'] = "center";
                    // column['resizable'] = "true";
                    // column['autoAdjust'] = "true";
                    // columns.addChild(column.getData());
                }
                var column = CompositeUtil.findChild(columns, 'column', 'prompt', array[i]['name_type']);
                var column_x = new CompositeMap('column');
                // column_x['name'] = array[i]['name_type'] + '_' + array[i]['website'];
                // column_x['prompt'] = array[i]['website'] + '(' + array[i]['unit'] + ')';
                // column_x['align'] = "right";
                // column_x['width'] = "40";
                // column_x['resizable'] = "true";
                // column_x['autoAdjust'] = "true";
                // column_x['renderer'] = 'display_price_render';
                // column_x['editor'] = 'rpt7010_result_grid_nub';
                // column.addChild(column_x.getData());
            
                var field = new CompositeMap('field');
                field['name'] = String(array[i]['name_type'] + '(' + array[i]['website'] + ')');
                if (array[i]['name_type'] == '黄金' || array[i]['name_type'] == '锡' || array[i]['name_type'] == '铝' || array[i]['name_type'] == '铜' || array[i]['name_type'] == '钯') {
                    if ((array[i]['website'] == '上海黄金(AU99.99)') || (array[i]['website'] == 'Kitco(人民币)' && array[i]['name_type'] == '钯') || (array[i]['website'] == '上海有色' && array[i]['name_type'] in {
                        '锡': '',
                        '铝': ''
                    }) || (array[i]['website'] == '长江有色' && array[i]['name_type'] == '铜')) {
                        field['prompt'] = String(array[i]['name_type'] + '(' + array[i]['website'] + ')');
                        fields.addChild(field.getData());
                    }
                } else {
                    field['prompt'] = array[i]['website'];
                    fields.addChild(field.getData());
                }
            }
            
            var year_grid = CompositeUtil.findChild(config, 'grid', 'id', 'rpt7010_year_result_grid').getChild('columns');
            for (var i = 1;i < 13;i++) {
                var column = new CompositeMap('column');
                column['name'] = String(i) + '_month';
                column['prompt'] = String(i) + '月';
                column['align'] = "right";
                column['width'] = "51";
                year_grid.addChild(column.getData());
            }
            
            var map_compare = {
                '伦敦期货': ['铜', '锡', '铝'],
                'Kitco(美元)': ['黄金', '钯'],
                'ECH环氧氯丙烷': ['树脂'],
                '双酚A': ['树脂']
            }
           // var grid_all = ['year_all_compare', 'month_all_compare','month_squ_compare'];
            var grid_all = ['year_all_compare'];            
            // for (i in grid_all) {
                // var year_compare_grid = CompositeUtil.findChild(config, 'grid', 'id', grid_all[i]).getChild('columns');
                // for (var name in map_compare) {
                    // var column = new CompositeMap('column');
                    // column['prompt'] = String(name);
                    // for (i = 0;i < map_compare[name].length;i++) {
                        // var column_x = new CompositeMap('column');
                        // column_x['prompt'] = String(map_compare[name][i]);
                        // column.addChild(column_x.getData());
            
                        // var column_xx = new CompositeMap('column');
                        // column_xx['prompt'] = '价格';
                        // column_xx['name'] = map_compare[name][i] + name + '_price';
                        // column_xx['align'] = "right";
                        // column_xx['width'] = "51";
                        // column_xx['renderer'] = "back_ground_render";
                        // column_x.addChild(column_xx.getData());
            
                        // var column_xx = new CompositeMap('column');
                        // column_xx['prompt'] = '幅度';
                        // column_xx['name'] = map_compare[name][i] + name + '_compare';
                        // column_xx['align'] = "center";
                        // column_xx['width'] = "51";
                        // column_x.addChild(column_xx.getData());
                    // }
                    // year_compare_grid.addChild(column.getData());
                // }
            // }
        ]]></s:server-script>
    </a:init-procedure>
    <a:view>
        <script><![CDATA[
            var topBarHeight = 75;
            var screenWidth = Aurora.getViewportWidth();
            var screenHeight = Aurora.getViewportHeight();
            var bottomHeight = screenHeight - topBarHeight;
            
            function getCookie(name) {
                var arr, reg = new RegExp("(^| )" + name + "=([^;]*)(;|$)");
                arr = document.cookie.match(reg);
                console.log(document.cookie);
                if (arr) {
                    return (arr[2]);
                } else {
                    return false;
                }
            }
            console.log(getCookie('vh'));
            if (!getCookie('vh')) {
                
                document.cookie = "vh=" + (bottomHeight);
                document.cookie = "vw=" + (screenWidth);
                location.reload();
            }
        ]]></script>
        <a:link id="rpt7010_save_link" model="cux.KINWONG.rpt.RPT7010.rpt7010_price_query" modelaction="batch_update"/>
        <script><![CDATA[
            function display_price_render(val, rec, name) {
                var record = $('rpt7010_result_ds').findById(rec.id + 1);
                if (record) {
                    if (val > record.get(name)) {
                        return '<div class="status-text status-red">' + val + '</div>';
                    }
                }
                if (!val){
                    return '';
                }
                return val;
            }
            
            function chart_load_handler(ds) {
                var records = ds.getAll();
                var map = {};
                for (i = 0;i < records.length;i++) {
                    for (data in records[i].data) {
                        if (records[i].data[data]) {
                            map[data] = records[i].data[data];
                        }
                    }
                }
                $('y_uncertain_ds').removeAll();
                for (data in map) {
                    if (data != 'month') {
                        $('y_uncertain_ds').create({
                            'value': data
                        });
                    }
                }
                console.log(ds);
                
            }
            
            function chart_month_load_handler(ds) {
                var records = ds.getAll();
                var map = {};
                for (i = 0;i < records.length;i++) {
                    for (data in records[i].data) {
                        if (records[i].data[data]) {
                            map[data] = records[i].data[data];
                        }
                    }
                }
                $('y_uncertain_month_ds').removeAll();
                for (data in map) {
                    if (data != 'month') {
                        $('y_uncertain_month_ds').create({
                            'value': data
                        });
                    }
                }
                console.log(ds);
                
            }            
            
            function back_ground_render(val, rec, name) {
                // if (val &&  !rec.get('stand')) {
                    // return '<div style="background-color:red">' + val + '</div>';
                // }
                return val;
            }
            
            function test_row_render(record, rowindex){
                if(record.get('stand') == 'yes') {
                	return 'background-color:#95B3D7';
                }
            }           
            
            function test_fun(){
                debugger;
                $('rpt7010_result_grid')._export();
            }
          	
          	function save_all(){
          	    var datas = $('rpt7010_result_ds').getJsonData();
          	    console.log(datas);
          	    var send_datas = [];
          	    for(var i = 0 ; i < datas.length ; i++){
          	        var date = '';
          	        for(var j in datas[i]){
          	            var data = {};
          	            var temp = j.split('_');
          	            date = datas[i]['cur_date'];
          	            if (temp[1] != 'date' && temp[0]){
          	                data['date'] = date;
          	                data['name'] = temp[0];
          	                data['website'] = temp[1];
          	                data['price'] = datas[i][j];
          	                data['_status'] = 'update';
          	                send_datas.push(data);
          	            }
          	        }
          	    }
          	    console.log(send_datas);
          	    Aurora.Masker.mask(Ext.getBody(), '${l:LOADING}');
                Aurora.request({
                    url: $('rpt7010_save_link').getUrl(),
                    para: send_datas,
                    success: function(res) {
                        Aurora.Masker.unmask(Ext.getBody());
                        Aurora.showMessage('${l:PROMPT}', '生成成功', function() {
                            $('rpt7010_result_ds').query();
                        });
                    },
                    error: function(res) {
                        Aurora.Masker.unmask(Ext.getBody());
                    },
                    failure: function(res) {
                        Aurora.Masker.unmask(Ext.getBody());
                    },
                    scope: this
                });
          	}       	          	
        ]]></script>
        <a:dataSets>
            <a:dataSet id="test_ds">
                <a:datas dataSource="/model/chart_category_all"/>
            </a:dataSet>
            <a:dataSet id="year_ds">
                <a:datas dataSource="/model/year_all"/>
            </a:dataSet>
            <a:dataSet id="month_ds">
                <a:datas dataSource="/model/month_all"/>
            </a:dataSet>
            <a:dataSet id="rpt7010_query_ds">
                <a:fields>
                    <a:field name="cur_month" displayField="flex_value" options="month_ds" returnField="stand_year" valueField="flex_value"/>
                    <a:field name="cur_date_f" defaultValue="${/model/year_month_all/record/@cur_date_f}"/>
                    <a:field name="cur_date_t" defaultValue="${/model/year_month_all/record/@cur_date_t}"/>
                </a:fields>
            </a:dataSet>
            <!-- <a:dataSet id="rpt7010_result_ds" autoCount="true" autoCreate="true" autoQuery="true" queryDataSet="rpt7010_query_ds" queryUrl="${/request/@context_path}/modules/cux/KINWONG/rpt/RPT7010/rpt7010_get_price_query.svc"/> -->
            <a:dataSet id="rpt7010_result_ds" autoCount="true" autoCreate="true" autoQuery="true" model="cux.KINWONG.rpt.RPT7010.rpt7010_price_query_new" pageSize="50" queryDataSet="rpt7010_query_ds">
                <a:fields>
                    <a:field name="cur_date" readOnly="true"/>
                    <a:field name="price1" readOnly="false"/>
                    <a:field name="price2" readOnly="false"/>
                    <a:field name="price3" readOnly="false"/>
                    <a:field name="price4" readOnly="false"/>
                    <a:field name="price5" readOnly="false"/>
                    <a:field name="price6" readOnly="false"/>
                    <a:field name="price7" readOnly="false"/>
                    <a:field name="price8" readOnly="false"/>
                    <a:field name="price9" readOnly="false"/>
                    <a:field name="price90" readOnly="false"/>
                    <a:field name="price10" readOnly="false"/>
                    <a:field name="price11" readOnly="false"/>
                    <a:field name="price12" readOnly="false"/>
                    <a:field name="price13" readOnly="false"/>
                    <a:field name="price14" readOnly="false"/>
                    <a:field name="price15" readOnly="false"/>
                    <a:field name="price16" readOnly="false"/>
                    <a:field name="price17" readOnly="false"/>
                    <a:field name="price18" readOnly="false"/>
                    <a:field name="price19" readOnly="false"/>
                    <a:field name="price20" readOnly="false"/>
                    <a:field name="price21" readOnly="false"/>
                    <a:field name="price22" readOnly="false"/>
                    <a:field name="price23" readOnly="false"/>
                    <a:field name="price24" readOnly="false"/>
                </a:fields>
            </a:dataSet>
            <a:dataSet id="rpt7010_chart_query_ds">
                <a:fields>
                    <!-- <a:field name="cur_year" required="true"/> -->
                    <a:field name="from_year" autoComplete="true" autoCompleteField="from_year" defaultValue="${/model/year_month_all/record/@last_year_fm}" lovHeight="500" lovService="cux.JINKO.VES.JK_VES5010.jk_ves_monthly_lov" lovWidth="530" required="true" title="时间">
                        <a:mapping>
                            <a:map from="flex_value" to="from_year"/>
                        </a:mapping>
                    </a:field>
                    <a:field name="to_year" autoComplete="true" autoCompleteField="to_year" defaultValue="${/model/year_month_all/record/@current_month}" lovHeight="500" lovService="cux.JINKO.VES.JK_VES5010.jk_ves_monthly_lov" lovWidth="530" required="true" title="时间">
                        <a:mapping>
                            <a:map from="flex_value" to="to_year"/>
                        </a:mapping>
                    </a:field>
                    <a:field name="name_website" defaultValue="铜(上海有色)" displayField="name_website" options="test_ds" returnField="name_website" valueField="name_website">
                        <a:mapping>
                            <a:map from="name_type" to="name_type"/>
                            <a:map from="unit" to="unit"/>
                            <a:map from="website" to="website"/>
                        </a:mapping>
                    </a:field>
                    <a:field name="name_type" defaultValue="铜" options="test_ds" returnField="name_type" valueField="name_type"/>
                    <a:field name="website" defaultValue="上海有色" options="test_ds" returnField="website" valueField="website"/>
                </a:fields>
            </a:dataSet>
            <a:dataSet id="rpt7010_chart_result_ds" autoQuery="true" queryDataSet="rpt7010_chart_query_ds" queryUrl="${/request/@context_path}/modules/cux/KINWONG/rpt/RPT7010/rpt7010_chart_query.svc">
                <a:fields>
                    <a:field name="month" prompt="月"/>
                    <a:field name="unit"/>
                </a:fields>
                <a:events>
                    <a:event name="load" handler="chart_load_handler"/>
                </a:events>
            </a:dataSet>
            <a:dataSet id="y_uncertain_ds">
                <a:datas>
                    <a:record value="series1"/>
                </a:datas>
            </a:dataSet>
            <!--新增begin   -->
            <a:dataSet id="rpt7010_chart_query_month_ds">
                <a:fields>
                    <!-- <a:field name="cur_year" required="true"/> -->
                    <!--                     <a:field name="from_year" autoComplete="true" autoCompleteField="from_year" defaultValue="${/model/year_month_all/record/@last_three_year}" lovHeight="500" lovService="cux.JINKO.VES.JK_VES5010.jk_ves_monthly_lov" lovWidth="530" required="true" title="时间">
                        <a:mapping>
                            <a:map from="flex_value" to="from_year"/>
                        </a:mapping>
                    </a:field> -->
                    <a:field name="from_year" defaultValue="${/model/year_month_all/record/@last_three_year}" displayField="flex_value" options="year_ds" required="true" returnField="stand_year" valueField="flex_value"/>
                    <a:field name="to_year" defaultValue="${/model/year_month_all/record/@current_year}" displayField="flex_value" options="year_ds" required="true" returnField="stand_year" valueField="flex_value"/>
                    <!--                     <a:field name="to_year" autoComplete="true" autoCompleteField="to_year" defaultValue="${/model/year_month_all/record/@current_year}" lovHeight="500" lovService="cux.JINKO.VES.JK_VES5010.jk_ves_monthly_lov" lovWidth="530" required="true" title="时间">
                        <a:mapping>
                            <a:map from="flex_value" to="to_year"/>
                        </a:mapping>
                    </a:field> -->
                    <a:field name="name_website" defaultValue="铜(上海有色)" displayField="name_website" options="test_ds" returnField="name_website" valueField="name_website">
                        <a:mapping>
                            <a:map from="name_type" to="name_type"/>
                            <a:map from="unit" to="unit"/>
                            <a:map from="website" to="website"/>
                        </a:mapping>
                    </a:field>
                    <a:field name="name_type" defaultValue="铜" options="test_ds" returnField="name_type" valueField="name_type"/>
                    <a:field name="website" defaultValue="上海有色" options="test_ds" returnField="website" valueField="website"/>
                </a:fields>
            </a:dataSet>
            <a:dataSet id="rpt7010_chart_result_month_ds" autoQuery="true" queryDataSet="rpt7010_chart_query_month_ds" queryUrl="${/request/@context_path}/modules/cux/KINWONG/rpt/RPT7010/rpt7010_chart_month_query.svc">
                <a:fields>
                    <a:field name="month" prompt="月"/>
                    <a:field name="unit"/>
                </a:fields>
                <a:events>
                    <a:event name="load" handler="chart_month_load_handler"/>
                </a:events>
            </a:dataSet>
            <a:dataSet id="y_uncertain_month_ds">
                <a:datas>
                    <a:record value="series1"/>
                </a:datas>
            </a:dataSet>
            <!--新增end   -->
            <a:dataSet id="rpt7010_year_query_ds">
                <a:fields>
                    <a:field name="cur_year" defaultValue="${/model/year_month_all/record/@current_year}" displayField="flex_value" options="year_ds" required="true" returnField="stand_year" valueField="flex_value"/>
                    <a:field name="cur_month" displayField="flex_value" options="month_ds" returnField="stand_year" valueField="flex_value"/>
                </a:fields>
            </a:dataSet>
            <a:dataSet id="rpt7010_year_result_ds" autoCount="true" autoQuery="true" queryDataSet="rpt7010_year_query_ds" queryUrl="${/request/@context_path}/modules/cux/KINWONG/rpt/RPT7010/rpt7010_year_query.svc"/>
            <a:dataSet id="year_all_compare_query_ds">
                <a:fields>
                    <a:field name="stand_year" defaultValue="2016" displayField="flex_value" options="year_ds" required="true" returnField="stand_year" valueField="flex_value"/>
                </a:fields>
            </a:dataSet>
            <!-- <a:dataSet id="year_all_compare_ds" autoCount="true" autoQuery="true" queryDataSet="year_all_compare_query_ds" queryUrl="${/request/@context_path}/modules/cux/KINWONG/rpt/RPT7010/rpt7010_year_compare.svc"/> -->
            <a:dataSet id="year_all_compare_ds" autoCount="true" autoQuery="true" model="cux.KINWONG.rpt.RPT7010.rpt7010_price_compare_new" queryDataSet="year_all_compare_query_ds">
                <a:fields>
                    <a:field name="cur_year" readOnly="true"/>
                    <a:field name="cur_year_new" readOnly="true"/>
                    <a:field name="price1_1" readOnly="true"/>
                    <a:field name="price1_2" readOnly="true"/>
                    <a:field name="price2_1" readOnly="true"/>
                    <a:field name="price2_2" readOnly="true"/>
                    <a:field name="price3_1" readOnly="true"/>
                    <a:field name="price3_2" readOnly="true"/>
                    <a:field name="price4_1" readOnly="true"/>
                    <a:field name="price4_2" readOnly="true"/>
                    <a:field name="price5_1" readOnly="true"/>
                    <a:field name="price5_2" readOnly="true"/>
                    <a:field name="price6_1" readOnly="true"/>
                    <a:field name="price6_2" readOnly="true"/>
                    <a:field name="price7_1" readOnly="true"/>
                    <a:field name="price7_2" readOnly="true"/>
                    <a:field name="price8_1" readOnly="true"/>
                    <a:field name="price8_2" readOnly="true"/>
                    <a:field name="price9_1" readOnly="true"/>
                    <a:field name="price9_2" readOnly="true"/>
                    <a:field name="price10_1" readOnly="true"/>
                    <a:field name="price10_2" readOnly="true"/>
                    <a:field name="price11_1" readOnly="true"/>
                    <a:field name="price11_2" readOnly="true"/>
                    <a:field name="price12_1" readOnly="true"/>
                    <a:field name="price12_2" readOnly="true"/>
                    <a:field name="price13_1" readOnly="true"/>
                    <a:field name="price13_2" readOnly="true"/>
                    <a:field name="price14_1" readOnly="true"/>
                    <a:field name="price14_2" readOnly="true"/>
                    <a:field name="price15_1" readOnly="true"/>
                    <a:field name="price15_2" readOnly="true"/>
                    <a:field name="price16_1" readOnly="true"/>
                    <a:field name="price16_2" readOnly="true"/>
                    <a:field name="price17_1" readOnly="true"/>
                    <a:field name="price17_2" readOnly="true"/>
                    <a:field name="price18_1" readOnly="true"/>
                    <a:field name="price18_2" readOnly="true"/>
                    <a:field name="price19_1" readOnly="true"/>
                    <a:field name="price19_2" readOnly="true"/>
                    <a:field name="price20_1" readOnly="true"/>
                    <a:field name="price20_2" readOnly="true"/>
                    <a:field name="price17_1" readOnly="true"/>
                    <a:field name="price21_1" readOnly="true"/>
                    <a:field name="price21_2" readOnly="true"/>
                    <a:field name="price22_1" readOnly="true"/>
                    <a:field name="price22_2" readOnly="true"/>
                    <a:field name="price23_1" readOnly="true"/>
                    <a:field name="price23_2" readOnly="true"/>
                    <a:field name="price24_1" readOnly="true"/>
                    <a:field name="price24_2" readOnly="true"/>
                </a:fields>
                <!--                 <a:events>
                    <a:event name="submitsuccess" handler="ves1070_quality_price_ds_submitsuccessFun"/>
                </a:events> -->
            </a:dataSet>
            <a:dataSet id="month_all_compare_query_ds">
                <a:fields>
                    <a:field name="stand_year" defaultValue="2016" displayField="flex_value" options="year_ds" required="true" returnField="stand_year" valueField="flex_value"/>
                </a:fields>
            </a:dataSet>
            <!-- <a:dataSet id="month_all_compare_ds" autoCount="true" autoQuery="true" queryDataSet="month_all_compare_query_ds" queryUrl="${/request/@context_path}/modules/cux/KINWONG/rpt/RPT7010/rpt7010_year_month_compare.svc"/> -->
            <a:dataSet id="month_all_compare_ds" autoCount="true" autoQuery="true" model="cux.KINWONG.rpt.RPT7010.rpt7010_price_year_month_new" queryDataSet="month_all_compare_query_ds">
                <a:fields>
                    <a:field name="cur_year" readOnly="true"/>
                    <a:field name="cur_year_new" readOnly="true"/>
                    <a:field name="price1_1" readOnly="true"/>
                    <a:field name="price1_2" readOnly="true"/>
                    <a:field name="price2_1" readOnly="true"/>
                    <a:field name="price2_2" readOnly="true"/>
                    <a:field name="price3_1" readOnly="true"/>
                    <a:field name="price3_2" readOnly="true"/>
                    <a:field name="price4_1" readOnly="true"/>
                    <a:field name="price4_2" readOnly="true"/>
                    <a:field name="price5_1" readOnly="true"/>
                    <a:field name="price5_2" readOnly="true"/>
                    <a:field name="price6_1" readOnly="true"/>
                    <a:field name="price6_2" readOnly="true"/>
                    <a:field name="price7_1" readOnly="true"/>
                    <a:field name="price7_2" readOnly="true"/>
                    <a:field name="price8_1" readOnly="true"/>
                    <a:field name="price8_2" readOnly="true"/>
                    <a:field name="price9_1" readOnly="true"/>
                    <a:field name="price9_2" readOnly="true"/>
                    <a:field name="price10_1" readOnly="true"/>
                    <a:field name="price10_2" readOnly="true"/>
                    <a:field name="price11_1" readOnly="true"/>
                    <a:field name="price11_2" readOnly="true"/>
                    <a:field name="price12_1" readOnly="true"/>
                    <a:field name="price12_2" readOnly="true"/>
                    <a:field name="price13_1" readOnly="true"/>
                    <a:field name="price13_2" readOnly="true"/>
                    <a:field name="price14_1" readOnly="true"/>
                    <a:field name="price14_2" readOnly="true"/>
                    <a:field name="price15_1" readOnly="true"/>
                    <a:field name="price15_2" readOnly="true"/>
                    <a:field name="price16_1" readOnly="true"/>
                    <a:field name="price16_2" readOnly="true"/>
                    <a:field name="price17_1" readOnly="true"/>
                    <a:field name="price17_2" readOnly="true"/>
                    <a:field name="price18_1" readOnly="true"/>
                    <a:field name="price18_2" readOnly="true"/>
                    <a:field name="price19_1" readOnly="true"/>
                    <a:field name="price19_2" readOnly="true"/>
                    <a:field name="price20_1" readOnly="true"/>
                    <a:field name="price20_2" readOnly="true"/>
                    <a:field name="price17_1" readOnly="true"/>
                    <a:field name="price21_1" readOnly="true"/>
                    <a:field name="price21_2" readOnly="true"/>
                    <a:field name="price22_1" readOnly="true"/>
                    <a:field name="price22_2" readOnly="true"/>
                    <a:field name="price23_1" readOnly="true"/>
                    <a:field name="price23_2" readOnly="true"/>
                    <a:field name="price24_1" readOnly="true"/>
                    <a:field name="price24_2" readOnly="true"/>
                </a:fields>
            </a:dataSet>
            <a:dataSet id="month_squ_compare_query_ds">
                <a:fields>
                    <a:field name="stand_year" defaultValue="2016" displayField="flex_value" options="year_ds" required="true" returnField="stand_year" valueField="flex_value"/>
                </a:fields>
            </a:dataSet>
            <!-- <a:dataSet id="month_squ_compare_ds" autoCount="true" autoQuery="true" queryDataSet="month_squ_compare_query_ds" queryUrl="${/request/@context_path}/modules/cux/KINWONG/rpt/RPT7010/rpt7010_squ_month_compare.svc"/> -->
            <a:dataSet id="month_squ_compare_ds" autoCount="true" autoQuery="true" model="cux.KINWONG.rpt.RPT7010.rpt7010_price_compare_month_new" queryDataSet="month_squ_compare_query_ds">
                <a:fields>
                    <a:field name="year" readOnly="true"/>
                    <a:field name="cur_year" readOnly="true"/>
                    <a:field name="price1_1" readOnly="true"/>
                    <a:field name="price1_2" readOnly="true"/>
                    <a:field name="price2_1" readOnly="true"/>
                    <a:field name="price2_2" readOnly="true"/>
                    <a:field name="price3_1" readOnly="true"/>
                    <a:field name="price3_2" readOnly="true"/>
                    <a:field name="price4_1" readOnly="true"/>
                    <a:field name="price4_2" readOnly="true"/>
                    <a:field name="price5_1" readOnly="true"/>
                    <a:field name="price5_2" readOnly="true"/>
                    <a:field name="price6_1" readOnly="true"/>
                    <a:field name="price6_2" readOnly="true"/>
                    <a:field name="price7_1" readOnly="true"/>
                    <a:field name="price7_2" readOnly="true"/>
                    <a:field name="price8_1" readOnly="true"/>
                    <a:field name="price8_2" readOnly="true"/>
                    <a:field name="price9_1" readOnly="true"/>
                    <a:field name="price9_2" readOnly="true"/>
                    <a:field name="price10_1" readOnly="true"/>
                    <a:field name="price10_2" readOnly="true"/>
                    <a:field name="price11_1" readOnly="true"/>
                    <a:field name="price11_2" readOnly="true"/>
                    <a:field name="price12_1" readOnly="true"/>
                    <a:field name="price12_2" readOnly="true"/>
                    <a:field name="price13_1" readOnly="true"/>
                    <a:field name="price13_2" readOnly="true"/>
                    <a:field name="price14_1" readOnly="true"/>
                    <a:field name="price14_2" readOnly="true"/>
                    <a:field name="price15_1" readOnly="true"/>
                    <a:field name="price15_2" readOnly="true"/>
                    <a:field name="price16_1" readOnly="true"/>
                    <a:field name="price16_2" readOnly="true"/>
                    <a:field name="price17_1" readOnly="true"/>
                    <a:field name="price17_2" readOnly="true"/>
                    <a:field name="price18_1" readOnly="true"/>
                    <a:field name="price18_2" readOnly="true"/>
                    <a:field name="price19_1" readOnly="true"/>
                    <a:field name="price19_2" readOnly="true"/>
                    <a:field name="price20_1" readOnly="true"/>
                    <a:field name="price20_2" readOnly="true"/>
                    <a:field name="price17_1" readOnly="true"/>
                    <a:field name="price21_1" readOnly="true"/>
                    <a:field name="price21_2" readOnly="true"/>
                    <a:field name="price22_1" readOnly="true"/>
                    <a:field name="price22_2" readOnly="true"/>
                    <a:field name="price23_1" readOnly="true"/>
                    <a:field name="price23_2" readOnly="true"/>
                    <a:field name="price24_1" readOnly="true"/>
                    <a:field name="price24_2" readOnly="true"/>
                </a:fields>
            </a:dataSet>
        </a:dataSets>
        <a:screenBody>
            <a:tabPanel marginHeight="50" marginWidth="80">
                <a:tabs>
                    <a:tab prompt="价格详情" width="100">
                        <a:queryForm bindTarget="rpt7010_query_ds" resultTarget="rpt7010_result_ds">
                            <a:formToolBar>
                                <a:datePicker name="cur_date" prompt="时间"/>
                                <a:comboBox name="cur_month" prompt="当前月份"/>
                            </a:formToolBar>
                        </a:queryForm>
                        <a:grid id="rpt7010_result_grid" bindTarget="rpt7010_result_ds" marginHeight="120" marginWidth="100" navBar="true">
                            <a:toolBar>
                                <!-- <a:button click="test_fun" text="test"/> -->
                                <a:button click="save_all" text="保存"/>
                                <a:button type="excel"/>
                            </a:toolBar>
                            <a:columns>
                                <a:column name="cur_date" align="center" autoAdjust="true" lock="true" prompt="时间" width="90"/>
                                <a:column align="center" prompt="铜">
                                    <a:column name="price1" align="right" autoAdjust="true" editor="rpt7010_result_grid_nub" prompt="长江有色（元/吨）" renderer="display_price_render" resizable="true" width="40"/>
                                    <a:column name="price2" align="right" autoAdjust="true" editor="rpt7010_result_grid_nub" prompt="上海有色（元/吨）" renderer="display_price_render" resizable="true" width="40"/>
                                    <a:column name="price3" align="right" autoAdjust="true" editor="rpt7010_result_grid_nub" prompt="伦敦期货（美元/吨）" renderer="display_price_render" resizable="true" width="40"/>
                                </a:column>
                                <a:column align="center" prompt="锡">
                                    <a:column name="price4" align="right" autoAdjust="true" editor="rpt7010_result_grid_nub" prompt="长江有色（元/吨）" renderer="display_price_render" resizable="true" width="40"/>
                                    <a:column name="price5" align="right" autoAdjust="true" editor="rpt7010_result_grid_nub" prompt="上海有色（元/吨）" renderer="display_price_render" resizable="true" width="40"/>
                                    <a:column name="price6" align="right" autoAdjust="true" editor="rpt7010_result_grid_nub" prompt="伦敦期货（美元/吨）" renderer="display_price_render" resizable="true" width="40"/>
                                </a:column>
                                <a:column align="center" prompt="铝">
                                    <a:column name="price7" align="right" autoAdjust="true" editor="rpt7010_result_grid_nub" prompt="长江有色（元/吨）" renderer="display_price_render" resizable="true" width="40"/>
                                    <a:column name="price8" align="right" autoAdjust="true" editor="rpt7010_result_grid_nub" prompt="上海有色（元/吨）" renderer="display_price_render" resizable="true" width="40"/>
                                    <a:column name="price9" align="right" autoAdjust="true" editor="rpt7010_result_grid_nub" prompt="伦敦期货（美元/吨）" renderer="display_price_render" resizable="true" width="40"/>
                                    <a:column name="price90" align="right" autoAdjust="true" editor="rpt7010_result_grid_nub" prompt="上海金属(最低价)（元/吨）" renderer="display_price_render" resizable="true" width="40"/>
                                </a:column>
                                <a:column align="center" prompt="镍">
                                    <a:column name="price25" align="right" autoAdjust="true" editor="rpt7010_result_grid_nub" prompt="长江有色（元/吨）" renderer="display_price_render" resizable="true" width="40"/>
                                    <a:column name="price26" align="right" autoAdjust="true" editor="rpt7010_result_grid_nub" prompt="伦敦期货（美元/吨）" renderer="display_price_render" resizable="true" width="40"/>
                                </a:column>
                                <a:column align="center" prompt="黄金">
                                    <a:column name="price10" align="right" autoAdjust="true" editor="rpt7010_result_grid_nub" prompt="上海黄金（AU99.99）（元/克）" renderer="display_price_render" resizable="true" width="40"/>
                                    <a:column name="price11" align="right" autoAdjust="true" editor="rpt7010_result_grid_nub" prompt="Kitco（人民币）（元/克）" renderer="display_price_render" resizable="true" width="40"/>
                                    <a:column name="price12" align="right" autoAdjust="true" editor="rpt7010_result_grid_nub" prompt="Kitco（美元）（美元/盎司）" renderer="display_price_render" resizable="true" width="40"/>
                                </a:column>
                                <a:column align="center" prompt="钯">
                                    <a:column name="price13" align="right" autoAdjust="true" editor="rpt7010_result_grid_nub" prompt="Kitco（人民币）（元/克）" renderer="display_price_render" resizable="true" width="40"/>
                                    <a:column name="price14" align="right" autoAdjust="true" editor="rpt7010_result_grid_nub" prompt="Kitco（美元）（美元/盎司）" renderer="display_price_render" resizable="true" width="40"/>
                                </a:column>
                                <a:column align="center" prompt="树脂">
                                    <a:column name="price15" align="right" autoAdjust="true" editor="rpt7010_result_grid_nub" prompt="ECH环氧氯丙烷（元/吨）" renderer="display_price_render" resizable="true" width="40"/>
                                    <a:column name="price16" align="right" autoAdjust="true" editor="rpt7010_result_grid_nub" prompt="环氧树脂（元/吨）" renderer="display_price_render" resizable="true" width="40"/>
                                    <a:column name="price17" align="right" autoAdjust="true" editor="rpt7010_result_grid_nub" prompt="双酚A（元/吨）" renderer="display_price_render" resizable="true" width="40"/>
                                </a:column>
                                <a:column align="center" prompt="化工原料">
                                    <a:column name="price18" align="right" autoAdjust="true" editor="rpt7010_result_grid_nub" prompt="硫酸（元/吨））" renderer="display_price_render" resizable="true" width="40"/>
                                    <a:column name="price19" align="right" autoAdjust="true" editor="rpt7010_result_grid_nub" prompt="硝酸（元/吨）" renderer="display_price_render" resizable="true" width="40"/>
                                    <a:column name="price20" align="right" autoAdjust="true" editor="rpt7010_result_grid_nub" prompt="盐酸（元/吨）" renderer="display_price_render" resizable="true" width="40"/>
                                    <a:column name="price21" align="right" autoAdjust="true" editor="rpt7010_result_grid_nub" prompt="重质纯碱（元/吨）" renderer="display_price_render" resizable="true" width="40"/>
                                    <a:column name="price22" align="right" autoAdjust="true" editor="rpt7010_result_grid_nub" prompt="烧碱（元/吨）" renderer="display_price_render" resizable="true" width="40"/>
                                </a:column>
                                <a:column align="center" prompt="橡塑">
                                    <a:column name="price23" align="right" autoAdjust="true" editor="rpt7010_result_grid_nub" prompt="LDPE（元/吨）" renderer="display_price_render" resizable="true" width="40"/>
                                </a:column>
                                <a:column align="center" prompt="原油">
                                    <a:column name="price24" align="right" autoAdjust="true" editor="rpt7010_result_grid_nub" prompt="布伦特（美元/桶）" renderer="display_price_render" resizable="true" width="40"/>
                                </a:column>
                            </a:columns>
                            <a:editors>
                                <a:numberField id="rpt7010_result_grid_nub" allowDecimals="true" decimalPrecision="2"/>
                            </a:editors>
                        </a:grid>
                    </a:tab>
                    <a:tab prompt="年度价格趋势表" width="120">
                        <a:queryForm bindTarget="rpt7010_year_query_ds" resultTarget="rpt7010_year_result_ds">
                            <a:formToolBar>
                                <a:datePicker name="cur_date" prompt="日期"/>
                                <a:comboBox name="cur_month" prompt="当前月份"/>
                                <a:comboBox name="cur_year" prompt="年份"/>
                            </a:formToolBar>
                        </a:queryForm>
                        <a:grid id="rpt7010_year_result_grid" bindTarget="rpt7010_year_result_ds" marginHeight="120" marginWidth="100" navBar="true">
                            <a:columns>
                                <a:column name="item_desc" align="center" autoAdjust="true" lock="true" prompt="物料" width="90"/>
                                <a:column name="unit_desc" align="center" autoAdjust="true" lock="true" prompt="单位" width="90"/>
                            </a:columns>
                        </a:grid>
                    </a:tab>
                    <a:tab prompt="月均对比价格趋势图" selected="true" width="120">
                        <a:queryForm bindTarget="rpt7010_chart_query_month_ds" resultTarget="rpt7010_chart_result_month_ds" style="width:100%;">
                            <a:formToolBar>
                                <a:comboBox name="from_year" prompt="年份从"/>
                                <a:comboBox name="to_year" prompt="年份至"/>
                                <!-- <a:lov name="from_year" bindTarget="rpt7010_chart_query_month_ds" prompt="时间从"/> -->
                                <!-- <a:lov name="to_year" bindTarget="rpt7010_chart_query_month_ds" prompt="时间至"/> -->
                                <a:comboBox name="name_website" prompt="名称"/>
                            </a:formToolBar>
                        </a:queryForm>
                        <a:chart id="rpt7010_chart_result_month_ds_chart" bindTarget="rpt7010_chart_result_month_ds">
                            <a:title text="月均对比趋势"/>
                            <a:subtitle align="left" text="${/model/rpt_chart_all/record/@unit}"/>
                            <a:xAxis>
                                <a:xAxi name="month"/>
                            </a:xAxis>
                            <a:yAxis>
                                <a:yAxi name="value" bindTarget="y_uncertain_month_ds">
                                    <a:title text="价格"/>
                                </a:yAxi>
                            </a:yAxis>
                            <a:plotOptions showInLegend="false">
                                <a:spline showInLegend="false">
                                    <a:marker lineColor="#666666" lineWidth="2" radius="4"/>
                                </a:spline>
                            </a:plotOptions>
                        </a:chart>
                    </a:tab>
                    <a:tab prompt="年度价格趋势图" selected="true" width="120">
                        <a:queryForm bindTarget="rpt7010_chart_query_ds" resultTarget="rpt7010_chart_result_ds" style="width:100%;">
                            <a:formToolBar>
                                <a:lov name="from_year" bindTarget="rpt7010_chart_query_ds" prompt="时间从"/>
                                <a:lov name="to_year" bindTarget="rpt7010_chart_query_ds" prompt="时间至"/>
                                <a:comboBox name="name_website" prompt="名称"/>
                            </a:formToolBar>
                        </a:queryForm>
                        <a:chart id="rpt7010_chart_result_ds_chart" bindTarget="rpt7010_chart_result_ds">
                            <a:title text="年份趋势"/>
                            <a:subtitle align="left" text="${/model/rpt_chart_all/record/@unit}"/>
                            <a:xAxis>
                                <a:xAxi name="month"/>
                            </a:xAxis>
                            <a:yAxis>
                                <a:yAxi name="value" bindTarget="y_uncertain_ds">
                                    <a:title text="价格"/>
                                </a:yAxi>
                            </a:yAxis>
                            <a:plotOptions showInLegend="false">
                                <a:spline showInLegend="false">
                                    <a:marker lineColor="#666666" lineWidth="2" radius="4"/>
                                </a:spline>
                            </a:plotOptions>
                        </a:chart>
                    </a:tab>
                    <a:tab prompt="年均对比表" width="120">
                        <a:queryForm bindTarget="year_all_compare_query_ds" resultTarget="year_all_compare_ds">
                            <a:formToolBar>
                                <a:comboBox name="stand_year" prompt="基准年份"/>
                            </a:formToolBar>
                        </a:queryForm>
                        <a:grid id="year_all_compare" bindTarget="year_all_compare_ds" marginHeight="120" marginWidth="100" navBar="true" rowRenderer="test_row_render">
                            <a:toolBar>
                                <a:button type="excel"/>
                            </a:toolBar>
                            <a:columns>
                                <a:column name="cur_year_new" align="center" lock="true" prompt="年份" width="80"/>
                                <a:column align="center" prompt="铜">
                                    <a:column align="center" prompt="长江有色（元/吨）">
                                        <a:column name="price1_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price1_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="上海有色（元/吨）">
                                        <a:column name="price2_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price2_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="伦敦期货（美元/吨）">
                                        <a:column name="price3_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price3_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                </a:column>
                                <a:column align="center" prompt="锡">
                                    <a:column align="center" prompt="长江有色（元/吨）">
                                        <a:column name="price4_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price4_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="上海有色（元/吨）">
                                        <a:column name="price5_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price5_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="伦敦期货（美元/吨）">
                                        <a:column name="price6_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price6_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                </a:column>
                                <a:column align="center" prompt="铝">
                                    <a:column align="center" prompt="长江有色（元/吨）">
                                        <a:column name="price7_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price7_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="上海有色（元/吨）">
                                        <a:column name="price8_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price8_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="伦敦期货（美元/吨）">
                                        <a:column name="price9_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price9_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                </a:column>
                                <a:column align="center" prompt="镍">
                                    <a:column align="center" prompt="长江有色（元/吨）">
                                        <a:column name="price25_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price25_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="伦敦期货（美元/吨）">
                                        <a:column name="price26_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price26_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                </a:column>
                                <a:column align="center" prompt="黄金">
                                    <a:column align="center" prompt="上海黄金（AU99.99）（元/克）">
                                        <a:column name="price10_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price10_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="Kitco（人民币）（元/克）">
                                        <a:column name="price11_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price11_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="Kitco（美元）（美元/盎司）">
                                        <a:column name="price12_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price12_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                </a:column>
                                <a:column align="center" prompt="钯">
                                    <a:column align="center" prompt="Kitco（人民币）（元/克）">
                                        <a:column name="price13_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price13_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="Kitco（美元）（美元/盎司）">
                                        <a:column name="price14_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price14_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                </a:column>
                                <a:column align="center" prompt="树脂">
                                    <a:column align="center" prompt="ECH环氧氯丙烷（元/吨）">
                                        <a:column name="price15_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price15_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="环氧树脂（元/吨）">
                                        <a:column name="price16_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price16_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="双酚A（元/吨）">
                                        <a:column name="price17_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price17_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                </a:column>
                                <a:column align="center" prompt="化工原料">
                                    <a:column align="center" prompt="硫酸（元/吨））">
                                        <a:column name="price18_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price18_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="硝酸（元/吨）">
                                        <a:column name="price19_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price19_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="盐酸（元/吨）">
                                        <a:column name="price20_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price20_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="重质纯碱（元/吨）">
                                        <a:column name="price21_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price21_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="烧碱（元/吨）">
                                        <a:column name="price22_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price22_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                </a:column>
                                <a:column align="center" prompt="橡塑">
                                    <a:column align="center" prompt="LDPE（元/吨）">
                                        <a:column name="price23_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price23_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                </a:column>
                                <a:column align="center" prompt="原油">
                                    <a:column align="center" prompt="布伦特（美元/桶）">
                                        <a:column name="price24_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price24_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                </a:column>
                            </a:columns>
                        </a:grid>
                    </a:tab>
                    <a:tab prompt="月均对比表" width="120">
                        <a:queryForm bindTarget="month_all_compare_query_ds" resultTarget="month_all_compare_ds">
                            <a:formToolBar>
                                <a:comboBox name="stand_year" prompt="基准年份"/>
                            </a:formToolBar>
                        </a:queryForm>
                        <a:grid id="month_all_compare" bindTarget="month_all_compare_ds" marginHeight="120" marginWidth="100" navBar="true" rowRenderer="test_row_render">
                            <a:toolBar>
                                <a:button type="excel"/>
                            </a:toolBar>
                            <a:columns>
                                <a:column name="cur_year_new" align="center" lock="true" prompt="时间" width="80"/>
                                <a:column align="center" prompt="铜">
                                    <a:column align="center" prompt="长江有色（元/吨）">
                                        <a:column name="price1_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price1_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="上海有色（元/吨）">
                                        <a:column name="price2_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price2_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="伦敦期货（美元/吨）">
                                        <a:column name="price3_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price3_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                </a:column>
                                <a:column align="center" prompt="锡">
                                    <a:column align="center" prompt="长江有色（元/吨）">
                                        <a:column name="price4_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price4_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="上海有色（元/吨）">
                                        <a:column name="price5_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price5_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="伦敦期货（美元/吨）">
                                        <a:column name="price6_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price6_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                </a:column>
                                <a:column align="center" prompt="铝">
                                    <a:column align="center" prompt="长江有色（元/吨）">
                                        <a:column name="price7_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price7_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="上海有色（元/吨）">
                                        <a:column name="price8_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price8_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="伦敦期货（美元/吨）">
                                        <a:column name="price9_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price9_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                </a:column>
                                <a:column align="center" prompt="镍">
                                    <a:column align="center" prompt="长江有色（元/吨）">
                                        <a:column name="price25_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price25_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="伦敦期货（美元/吨）">
                                        <a:column name="price26_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price26_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                </a:column>
                                <a:column align="center" prompt="黄金">
                                    <a:column align="center" prompt="上海黄金（AU99.99）（元/克）">
                                        <a:column name="price10_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price10_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="Kitco（人民币）（元/克）">
                                        <a:column name="price11_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price11_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="Kitco（美元）（美元/盎司）">
                                        <a:column name="price12_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price12_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                </a:column>
                                <a:column align="center" prompt="钯">
                                    <a:column align="center" prompt="Kitco（人民币）（元/克）">
                                        <a:column name="price13_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price13_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="Kitco（美元）（美元/盎司）">
                                        <a:column name="price14_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price14_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                </a:column>
                                <a:column align="center" prompt="树脂">
                                    <a:column align="center" prompt="ECH环氧氯丙烷（元/吨）">
                                        <a:column name="price15_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price15_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="环氧树脂（元/吨）">
                                        <a:column name="price16_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price16_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="双酚A（元/吨）">
                                        <a:column name="price17_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price17_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                </a:column>
                                <a:column align="center" prompt="化工原料">
                                    <a:column align="center" prompt="硫酸（元/吨））">
                                        <a:column name="price18_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price18_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="硝酸（元/吨）">
                                        <a:column name="price19_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price19_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="盐酸（元/吨）">
                                        <a:column name="price20_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price20_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="重质纯碱（元/吨）">
                                        <a:column name="price21_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price21_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="烧碱（元/吨）">
                                        <a:column name="price22_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price22_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                </a:column>
                                <a:column align="center" prompt="橡塑">
                                    <a:column align="center" prompt="LDPE（元/吨）">
                                        <a:column name="price23_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price23_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                </a:column>
                                <a:column align="center" prompt="原油">
                                    <a:column align="center" prompt="布伦特（美元/桶）">
                                        <a:column name="price24_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price24_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                </a:column>
                            </a:columns>
                        </a:grid>
                    </a:tab>
                    <tab prompt="月均同比表" width="120">
                        <a:queryForm bindTarget="month_squ_compare_query_ds" resultTarget="month_squ_compare_ds">
                            <a:formToolBar>
                                <a:comboBox name="stand_year" prompt="基准年份"/>
                            </a:formToolBar>
                        </a:queryForm>
                        <a:grid id="month_squ_compare" bindTarget="month_squ_compare_ds" marginHeight="120" marginWidth="100" navBar="true" rowRenderer="test_row_render">
                            <a:toolBar>
                                <a:button type="excel"/>
                            </a:toolBar>
                            <a:columns>
                                <a:column name="cur_year" align="center" lock="true" prompt="时间" width="80"/>
                                <a:column align="center" prompt="铜">
                                    <a:column align="center" prompt="长江有色（元/吨）">
                                        <a:column name="price1_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price1_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="上海有色（元/吨）">
                                        <a:column name="price2_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price2_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="伦敦期货（美元/吨）">
                                        <a:column name="price3_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price3_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                </a:column>
                                <a:column align="center" prompt="锡">
                                    <a:column align="center" prompt="长江有色（元/吨）">
                                        <a:column name="price4_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price4_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="上海有色（元/吨）">
                                        <a:column name="price5_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price5_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="伦敦期货（美元/吨）">
                                        <a:column name="price6_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price6_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                </a:column>
                                <a:column align="center" prompt="铝">
                                    <a:column align="center" prompt="长江有色（元/吨）">
                                        <a:column name="price7_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price7_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="上海有色（元/吨）">
                                        <a:column name="price8_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price8_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="伦敦期货（美元/吨）">
                                        <a:column name="price9_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price9_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                </a:column>
                                <a:column align="center" prompt="镍">
                                    <a:column align="center" prompt="长江有色（元/吨）">
                                        <a:column name="price25_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price25_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="伦敦期货（美元/吨）">
                                        <a:column name="price26_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price26_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                </a:column>
                                <a:column align="center" prompt="黄金">
                                    <a:column align="center" prompt="上海黄金（AU99.99）（元/克）">
                                        <a:column name="price10_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price10_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="Kitco（人民币）（元/克）">
                                        <a:column name="price11_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price11_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="Kitco（美元）（美元/盎司）">
                                        <a:column name="price12_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price12_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                </a:column>
                                <a:column align="center" prompt="钯">
                                    <a:column align="center" prompt="Kitco（人民币）（元/克）">
                                        <a:column name="price13_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price13_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="Kitco（美元）（美元/盎司）">
                                        <a:column name="price14_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price14_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                </a:column>
                                <a:column align="center" prompt="树脂">
                                    <a:column align="center" prompt="ECH环氧氯丙烷（元/吨）">
                                        <a:column name="price15_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price15_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="环氧树脂（元/吨）">
                                        <a:column name="price16_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price16_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="双酚A（元/吨）">
                                        <a:column name="price17_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price17_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                </a:column>
                                <a:column align="center" prompt="化工原料">
                                    <a:column align="center" prompt="硫酸（元/吨））">
                                        <a:column name="price18_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price18_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="硝酸（元/吨）">
                                        <a:column name="price19_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price19_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="盐酸（元/吨）">
                                        <a:column name="price20_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price20_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="重质纯碱（元/吨）">
                                        <a:column name="price21_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price21_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                    <a:column align="center" prompt="烧碱（元/吨）">
                                        <a:column name="price22_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price22_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                </a:column>
                                <a:column align="center" prompt="橡塑">
                                    <a:column align="center" prompt="LDPE（元/吨）">
                                        <a:column name="price23_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price23_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                </a:column>
                                <a:column align="center" prompt="原油">
                                    <a:column align="center" prompt="布伦特（美元/桶）">
                                        <a:column name="price24_1" align="center" prompt="价格" width="80"/>
                                        <a:column name="price24_2" align="center" prompt="幅度" width="70"/>
                                    </a:column>
                                </a:column>
                            </a:columns>
                        </a:grid>
                    </tab>
                </a:tabs>
            </a:tabPanel>
        </a:screenBody>
    </a:view>
</a:screen>
