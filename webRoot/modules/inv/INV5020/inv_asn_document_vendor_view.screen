<?xml version="1.0" encoding="UTF-8"?>
<!--
    $Author: Dru  
    $Date: 2014-7-18 上午11:09:41  
    $Revision: 1.0  
    $Purpose: 送货单整单只读查看
-->
<a:screen xmlns:a="http://www.aurora-framework.org/application">
    <a:init-procedure>
        <a:model-query defaultWhereClause="v.config_classify_code = &apos;ASN&apos; AND v.config_item_code = &apos;ASN_10&apos;" fetchAll="true" model="public.get_fnd_config_center_coop_bg_item_value" rootPath="bg_item_asn_10"/>
        <a:model-query fetchAll="true" model="inv.PUBLIC.inv_shtn_vendor_button_control" rootPath="inv7020_vendor_button_control_data"/>
    </a:init-procedure>
    <a:view>
        <div/>
        <a:link id="inv_asnDocumentViewOperationRecord_link" url="${/request/@context_path}/modules/inv/INV7020/inv_asn_operation_record.screen"/>
        <a:link id="inv_asnDocumentViewReceiveTransactionRecord_link" url="${/request/@context_path}/modules/inv/PUBLIC/inv_asn_vendor_receive_transactions.screen"/>
        <a:link id="inv_asnDocumentViewAttachmentFileDownload_link" url="${/request/@context_path}/attachment_file_download.screen"/>
        <a:link id="inv_asnDocumentViewPrintInsert_link" url="${/request/@context_path}/modules/inv/PRINT/inv_asn_print.svc"/>
        <a:link id="inv_asnDocumentViewPrint_link" url="${/request/@context_path}/modules/inv/PRINT/inv_asn_print_dispatch.screen"/>
        <a:link id="inv_asnDocumentViewReimport_link" model="inv.INV7020.inv_asn_import_record_reimport" modelaction="execute"/>
        <a:link id="inv_asn_vendor_view_po_bom_maintain_link" url="${/request/@context_path}/modules/cux/SHTN/inv/inv_asn_view_po_boms.screen"/>
        <a:link id="inv_asn_vendor_view_label_line_maintain_link" url="${/request/@context_path}/modules/cux/SHTN/inv/SHTN_INV5020/shtn_inv_label_lines.screen"/>
        <a:link id="inv_asn_vendor_view_shtn_confirm_attachments_link" url="${/request/@context_path}/modules/cux/SHTN/inv/shtn_inv_confirm_attachments.screen"/>
        <a:link id="inv_asn_express100_quary_link" url="${/request/@context_path}/modules/inv/PUBLIC/inv_asn_express100_quary.svc"/>
        <a:link id="inv_asn_logistics_information_inquiry_link" url="${/request/@context_path}/modules/inv/PUBLIC/inv_asn_logistics_information_inquiry.screen"/>
        <a:link id="inv_asnDocumentViewHeadSave_link" model="inv.PUBLIC.inv_asn_document_view_header_query" modelaction="update"/>
        <a:link id="inv_asn_delete_line_link" model="inv.INV5020.inv_asn_cancel" modelaction="batch_update"/>
        <script><![CDATA[
            //关闭窗口
            
            function inv_asnDocumentViewClose_fun() {
                $('inv_asn_document_view_window').close();
            }
            
            // 接收明细
            
            function inv_asnDocumentView_receiveDetail_render(value, record, name) {
                return '<a href="javascript:inv_asnDocumentView_receiveDetail_open(' + record.get('asn_line_id') + ');">${l:INV.ASN_RECEIVE_DETAIL}</a>';
            }
            
            function inv_asnDocumentView_receiveDetail_open(asn_line_id) {
                new Aurora.Window({
                    id: 'inv_asn_transaction_win',
                    title: '${l:INV.ASN_RECEIVE_DETAIL}',
                    url: $('inv_asnDocumentViewReceiveTransactionRecord_link').getUrl() + '?asn_line_id=' + asn_line_id,
                    height: 450,
                    width: 600
                });
            
            }
            
            
            // 操作记录
            
            function inv_asnDocumentView_operationRecords_render(value, record, name) {
                return '<a href="javascript:inv_asnDocumentView_operationRecords_open(' + record.get('asn_line_id') + ');">${l:MODULES/INV/INV5020/INV_ASN_OPERATION_RECORD.SCREEN.TITLE}</a>';
            }
            
            function inv_asnDocumentView_operationRecords_open(asn_line_id) {
                new Aurora.Window({
                    id: 'inv7020_asn_operation_record_win',
                    title: '${l:MODULES/INV/INV5020/INV_ASN_OPERATION_RECORD.SCREEN.TITLE}',
                    url: $('inv_asnDocumentViewOperationRecord_link').getUrl() + '?asn_line_id=' + asn_line_id,
                    height: 450,
                    width: 600
                });
            
            }
            
            function inv_asnDocumentView_AttachmentFileDownload() {
                var asn_header_id = '${/parameter/@asn_header_id}';
                if (asn_header_id) {
                    new Aurora.Window({
                        id: 'inv_asnDocumentViewAttachmentFileDownload_link_window',
                        title: '${l:FND_ATM_LINES.ATM_DOWNLOAD}',
                        url: $('inv_asnDocumentViewAttachmentFileDownload_link').getUrl() + '?pkvalue=' + asn_header_id + '&table_name=INV_ASN_HEADERS',
                        width: 500,
                        height: 500
                    });
                }
            }
            
            function inv_asnDocumentView_Print() {
                var ds = $('inv_asnDocumentViewLine_ds');
                var records = ds.getAll();
                if (records.length == 0) {
                    Aurora.showMessage('${l:PROMPT}', '${l:PROMPT.SELECT_ONE_RECORD_AT_LEAST}');
                    return false;
                }
                var datas = [];
                for (var i = 0;i < records.length;i++) {
                    records[i].set('asn_header_id', '${/parameter/@asn_header_id}');
                    records[i].set('asn_line_id', '');
                    datas.push(records[i].data);
                    break;
                }
                Aurora.Masker.mask($('inv_asn_document_view_window').wrap, '${l:LOADING}');
                Aurora.request({
                    url: $('inv_asnDocumentViewPrintInsert_link').getUrl(),
                    para: datas,
                    success: function(res) {
                        Aurora.Masker.unmask($('inv_asn_document_view_window').wrap);
                        window.open($('inv_asnDocumentViewPrint_link').getUrl(), '_blank');
                    },
                    failure: function(res) {
                        Aurora.Masker.unmask($('inv_asn_document_view_window').wrap);
                    },
                    error: function(res) {
                        Aurora.Masker.unmask($('inv_asn_document_view_window').wrap);
                    },
                    scope: this
                });
            }
            
            function inv_asnDocumentViewLineDsGridRenderer(value, record, name) {
                if (name == 'line_attachment') {
                    if (!Aurora.isEmpty(record.get('asn_line_id'))) {
                        return '<a href="javascript:inv_asnDocumentViewLineAttachmentDownloadFunction(' + record.get('asn_line_id') + ')">${l:PROMPT.VIEW_ATTACHMENT}</a>';
                    }
                }
            }
            
            function inv_asnDocumentViewLineAttachmentDownloadFunction(asn_line_id) {
                new Aurora.Window({
                    id: 'inv_asnDocumentViewAttachmentFileDownload_link_window',
                    title: '${l:FND_ATM_LINES.ATM_DOWNLOAD}',
                    url: $('inv_asnDocumentViewAttachmentFileDownload_link').getUrl() + '?pkvalue=' + asn_line_id + '&table_name=INV_ASN_LINES',
                    width: 500,
                    height: 500
                });
            }
            
            function inv_asnDocumentViewReimport() {
                Aurora.showConfirm('${l:PROMPT}', '${l:INV5020.RETRY_EXPORT_NOTE}', function() {
                    $('inv_asnDocumentView_AttachmentFileDownload_btn').disable();
                    $('inv_asnDocumentView_Print_btn').disable();
                    $('inv_asnDocumentViewReimport_btn').disable();
                    Aurora.Masker.mask($('inv_asn_document_view_window').wrap, '${l:LOADING}');
                    Aurora.request({
                        url: $('inv_asnDocumentViewReimport_link').getUrl(),
                        para: {
                            'asn_header_id': '${/parameter/@asn_header_id}'
                        },
                        success: function(res) {
                            $('inv_asnDocumentView_AttachmentFileDownload_btn').enable();
                            $('inv_asnDocumentView_Print_btn').enable();
                            $('inv_asnDocumentViewReimport_btn').enable();
                            Aurora.Masker.unmask($('inv_asn_document_view_window').wrap);
                        },
                        failure: function(res) {
                            $('inv_asnDocumentView_AttachmentFileDownload_btn').enable();
                            $('inv_asnDocumentView_Print_btn').enable();
                            $('inv_asnDocumentViewReimport_btn').enable();
                            Aurora.Masker.unmask($('inv_asn_document_view_window').wrap);
                        },
                        error: function(res) {
                            $('inv_asnDocumentView_AttachmentFileDownload_btn').enable();
                            $('inv_asnDocumentView_Print_btn').enable();
                            $('inv_asnDocumentViewReimport_btn').enable();
                            Aurora.Masker.unmask($('inv_asn_document_view_window').wrap);
                        },
                        scope: this
                    });
                });
            }
        
        //外协bom分配页面
            function inv_asn_vendor_view_po_bom_maintain(asn_line_id){
                new Aurora.Window({
                    id: 'inv_asn_view_po_bom_maintain_win',
                    title: '${l:INV_ASN_LINES_TEMP.PUR_PO_BOMS}',
                    url: $('inv_asn_vendor_view_po_bom_maintain_link').getUrl() + '?asn_line_id=' + asn_line_id,
                    width: 800,
                    height: 420
                });        
            }
        
         //外协核销数量分配
            function inv_asn_vendor_view_po_bom_renderer(value,record,name){
                if(record.get('asn_pom_count') > 0){
                    return '<a href="javascript:inv_asn_vendor_view_po_bom_maintain(' + value + ');">' + '${l:INV_ASN_LINES_TEMP.PUR_PO_BOMS}' + '</a>';   
                } else {
                    return '';   
                }
            }
            
             function inv_asn_vendor_view_label_line_maintain(asn_line_id){
                new Aurora.Window({
                    id: 'shtn_inv5020_edit_label_line_maintain_win',
                    title: '${l:SHTN_INV_ASN_LINES.LABEL_LINE_INFO}',
                    url: $('inv_asn_vendor_view_label_line_maintain_link').getUrl() + '?asn_line_id=' + asn_line_id,
                    width: 700,
                    height: 420
                });         
            }
            
             //包装分配行渲染
            function inv_asn_vendor_view_label_line_renderer(value,record,name){
                if(record.get('label_line_count') > 0){
                    return '<a href="javascript:inv_asn_vendor_view_label_line_maintain(' + record.get('asn_line_id') + ');">' + '${l:SHTN_INV_ASN_LINES.LABEL_LINE_INFO}' + '</a>';   
                } else {
                    return '';   
                }      
            }
            
            //拖内确认附件
            function inv_asnDocumentVendorView_confirm_attachments(asn_header_id){
                var asn_header_id = '${/parameter/@asn_header_id}';
                if(asn_header_id){
                    new Aurora.Window({
                        id: 'shtn_inv5050_asn_attachments__win',
                        title: '${l:PROMPT.VIEW_ATTACHMENT}',
                        url: $('inv_asn_vendor_view_shtn_confirm_attachments_link').getUrl() + '?pkvalue=' + asn_header_id + '&shtn_asn_confirm_files=SHTN_ASN_CONFIRM_FILES&shtn_rcv_confirm_files=SHTN_RCV_CONFIRM_FILES',
                        width: 850,
                        height: 480
                    }); 
                }      
            }
            
            function inv_asnViewHeaderExpressNumberQuery() {
                var headers_ds = $('inv_asnDocumentViewHeader_ds');
                var header_record = headers_ds.getCurrentRecord();
                var asn_header_id = header_record.get('asn_header_id');
                var logistics_company_code = header_record.get('logistics_company_code').toLowerCase(); //物流公司编码，LOV选的有，填的没有
                var express_number = header_record.get('express_number'); //快递单号

                if (Aurora.isEmpty(logistics_company_code)) {
                    Aurora.showMessage('${l:PROMPT}', '${l:PROMPT.LOGISTICS_COMPANY_NOT_NULL}');
                    return false;
                }

                if (Aurora.isEmpty(express_number)) {
                    Aurora.showMessage('${l:PROMPT}', '${l:PROMPT.EXPRESS_NUMBER_NOT_NULL}');
                    return false;
                }
                
                Aurora.Masker.mask($('inv_asn_document_view_window').wrap, '${l:LOADING}');
                Aurora.request({
                    url: $('inv_asn_express100_quary_link').getUrl(),
                    para: {
                        "asn_header_id": asn_header_id,
                        "logistics_company": logistics_company_code,
                        "express_number": express_number
                    },
                    success: function(res) {
                        Aurora.Masker.unmask($('inv_asn_document_view_window').wrap);
                        new Aurora.Window({
                            id: 'inv_asn_logistics_information_inquiry_link_window',
                            title: '${l:WFL_HOME_PAGE.LOGISTICS_DETAIL}',
                            url: $('inv_asn_logistics_information_inquiry_link').getUrl() + '?asn_header_id=' + asn_header_id,
                            width: 750,
                            height: 500
                        });
                    },
                    failure: function(res) {
                        Aurora.Masker.unmask($('inv_asn_document_view_window').wrap);
                    },
                    error: function(res) {
                        Aurora.Masker.unmask($('inv_asn_document_view_window').wrap);
                    },
                    scope: this
                });
            }
            
            function inv_asnDocumentViewSave(){
                var header_ds = $('inv_asnDocumentViewHeader_ds');
                if (!header_ds.validate()) {
                    return false;
                }
                var header_record = header_ds.getCurrentRecord();
                var datas = {
                    asn_header_id: '${/parameter/@asn_header_id}',
                    asn_type_code: header_record.get('asn_type_code'),
                    ship_date_fmt: header_record.get('ship_date_fmt'),
                    expected_date_fmt: header_record.get('expected_date_fmt'),
                    comments: header_record.get('comments'),
                    logistics_company: header_record.get('logistics_company'),
                    dispatching_staff: header_record.get('dispatching_staff'),
                    contact_information: header_record.get('contact_information'),
                    logistics_cost: header_record.get('logistics_cost'),
                    express_number: header_record.get('express_number')
                };
                Aurora.Masker.mask($('inv_asn_document_view_window').wrap, '${l:LOADING}');
                Aurora.request({
                    url: $('inv_asnDocumentViewHeadSave_link').getUrl(),
                    para: datas,
                    success: function() {
                        Aurora.Masker.unmask($('inv_asn_document_view_window').wrap);
                        header_ds.query();
                    },
                    failure: function() {
                        Aurora.Masker.unmask($('inv_asn_document_view_window').wrap);
                    },
                    error: function() {
                        Aurora.Masker.unmask($('inv_asn_document_view_window').wrap);
                    },
                    scope: this
                });
            }
            
            function inv_asnDocumentViewDelete(){
                var records = $('inv_asnDocumentViewLine_ds').getSelected();
                var datas = [];
                    for (var i = 0;i < records.length;i++) {
                        var data = {
                            'asn_header_id': '${/parameter/@asn_header_id}',
                            'asn_line_id': records[i].get('asn_line_id'),
                            '_status': 'delete'
                        };
                        datas.push(data);
                    }
                Aurora.Masker.mask($('inv_asn_document_view_window').wrap, '${l:LOADING}');
                Aurora.request({
                    url: $('inv_asn_delete_line_link').getUrl(),
                    para: datas,
                    success: function() {
                        Aurora.Masker.unmask($('inv_asn_document_view_window').wrap);
                        Aurora.showMessage('${l:PROMPT}', '${l:取消成功！}');
                        $('inv_asnDocumentViewLine_ds').query();
                    },
                    failure: function() {
                        Aurora.Masker.unmask($('inv_asn_document_view_window').wrap);
                    },
                    error: function() {
                        Aurora.Masker.unmask($('inv_asn_document_view_window').wrap);
                    },
                    scope: this
                });
            }
             function inv_asnDocumentViewLine_ds_load_fun(ds){
                var records = ds.getAll();
                 for (var i = 0;i < records.length;i++) {
                     if(records[i].get('part_cancel')=='Y'){
                         $('inv_asnDocumentViewLine_ds_grid').showColumn('cancel_quantity');
                         break;
                     }else{
                         $('inv_asnDocumentViewLine_ds_grid').hideColumn('cancel_quantity');
                     }
                }
            }
        ]]></script>
        <a:dataSets>
            <a:dataSet id="inv7020_vendor_button_control_ds">
                <a:datas dataSource="inv7020_vendor_button_control_data"/>
            </a:dataSet>
            <a:dataSet id="inv_asnDocumentViewHeader_ds" autoQuery="true" model="inv.PUBLIC.inv_asn_document_view_header_query" queryUrl="${/request/@context_path}/autocrud/inv.PUBLIC.inv_asn_document_view_header_query/query?asn_header_id=${/parameter/@asn_header_id}">
                <a:fields>
                    <a:field name="company_name" readOnly="true"/>
                    <a:field name="vendor_name" readOnly="true"/>
                    <a:field name="vendor_site_name" readOnly="true"/>
                    <a:field name="asn_number" prompt="INV_ASN_HEADERS.ASN_NUMBER" readOnly="true"/>
                    <a:field name="ship_date" prompt="INV_ASN_HEADERS.SHIP_DATE" readOnly="true"/>
                    <a:field name="expected_date" prompt="INV_ASN_HEADERS.EXPECTED_DATE" readOnly="true"/>
                    <a:field name="comments" prompt="INV_ASN_HEADERS.HEADER_DESC" readOnly="true"/>
                    <a:field name="ship_to_organization_name" prompt="INV_ASN_HEADERS.SHIP_TO_ORGANIZATION_ID" readOnly="true"/>
                    <a:field name="location_name" prompt="INV_ASN_HEADERS.LOCATION_ID" readOnly="true"/>
                    <a:field name="logistics_company" autoComplete="false" fetchRemote="false" lovHeight="500" lovService="public.fnd_flex_value_v_lov?flex_value_set_code=INV_ASN_LOGISTICS_COMPANY" lovWidth="500" title="INV_ASN_HEADERS_TEMP.LOGISTICS_COMPANY">
                        <a:mapping>
                            <a:map from="flex_value" to="logistics_company_code"/>
                            <a:map from="flex_desc" to="logistics_company"/>
                        </a:mapping>
                    </a:field>
                </a:fields>
            </a:dataSet>
            <a:dataSet id="inv_asnDocumentViewLine_ds" autoCount="true" autoPageSize="true" autoQuery="true" fetchAll="true" model="inv.PUBLIC.inv_asn_document_view_line_query" queryUrl="${/request/@context_path}/autocrud/inv.PUBLIC.inv_asn_document_view_line_query/query?asn_header_id=${/parameter/@asn_header_id}" selectable="true">
                <a:fields>
                    <a:field name="cancel_flag" checkedValue="Y" uncheckedValue="N"/>
                    <a:field name="close_flag" checkedValue="Y" uncheckedValue="N"/>
                    <a:field name="part_cancel" checkedValue="Y" uncheckedValue="N"/>
                </a:fields>
                <a:events>
                    <a:event name="load" handler="inv_asnDocumentViewLine_ds_load_fun"/>
                </a:events>
            </a:dataSet>
            <a:dataSet id="inv5010_asn_edit_declares_ds" autoQuery="true" fetchAll="true" model="inv.INV5010.inv_asn_edit_declares" queryUrl="${/request/@context_path}/autocrud/inv.INV5010.inv_asn_edit_declares/query?asn_header_id=${/parameter/@asn_header_id}" selectable="false"/>
            <a:dataSet id="inv5010_asn_edit_invoices_ds" autoQuery="true" fetchAll="true" model="inv.INV5010.inv_asn_edit_invoices" queryUrl="${/request/@context_path}/autocrud/inv.INV5010.inv_asn_edit_invoices/query?asn_header_id=${/parameter/@asn_header_id}" selectable="false"/>
            <a:dataSet id="inv5010_asn_edit_encasements_ds" autoQuery="true" fetchAll="true" model="inv.INV5010.inv_asn_edit_encasements" queryUrl="${/request/@context_path}/autocrud/inv.INV5010.inv_asn_edit_encasements/query?asn_header_id=${/parameter/@asn_header_id}" selectable="false"/>
            <a:dataSet id="inv5010_asn_edit_contracts_ds" autoQuery="true" fetchAll="true" model="inv.INV5010.inv_asn_edit_contracts" queryUrl="${/request/@context_path}/autocrud/inv.INV5010.inv_asn_edit_contracts/query?asn_header_id=${/parameter/@asn_header_id}" selectable="true"/>
        </a:dataSets>
        <a:screenBody>
            <a:screenTopToolbar>
                <!-- <a:toolbarButton id="inv_asnDocumentViewSave_btn" click="inv_asnDocumentViewSave" style="margin-left:20px;" text="HAP_SAVE" width="100"/> -->
                <a:toolbarButton id="inv_asnDocumentViewDelete_btn" click="inv_asnDocumentViewDelete" style="margin-left:20px;" text="部分取消" width="100"/>
                <a:toolbarButton id="inv_asnDocumentView_AttachmentFileDownload_btn" click="inv_asnDocumentView_AttachmentFileDownload" style="margin-left:20px;" text="PROMPT.ATTACHMENT" width="100"/>
                <a:toolbarButton id="inv_asnDocumentView_Print_btn" click="inv_asnDocumentView_Print" text="PROMPT.PRINT" width="100"/>
                <a:toolbarButton id="inv_asnDocumentViewReimport_btn" click="inv_asnDocumentViewReimport" disabled="true" text="PROMPT.RE_IMPORT" width="100"/>
                <a:toolbarButton click="inv_asnDocumentViewClose_fun" text="HAP_BACK" width="100"/>
                <a:toolbarButton id="inv_asnDocumentVendorView_confirm_attachments_btn" click="inv_asnDocumentVendorView_confirm_attachments" style="display:none;" text="INV_ASN_HEADERS.SHTN_CONFIRM_ATTACHMENTS" width="100"/>
            </a:screenTopToolbar>
            <a:form style="margin-top:5px;width:100%" title="INV_ASN_HEADER.TITLE">
                <a:hBox labelWidth="90">
                    <a:label name="asn_number" bindTarget="inv_asnDocumentViewHeader_ds" prompt="INV_ASN_HEADERS_TEMP.ASN_NUMBER" width="230"/>
                    <a:label name="vendor_name" bindTarget="inv_asnDocumentViewHeader_ds" prompt="INV_ASN_HEADERS.VENDOR_ID" width="230"/>
                    <a:label name="vendor_site_name" bindTarget="inv_asnDocumentViewHeader_ds" prompt="INV_ASN_HEADERS.SHIPMENT_LOCATION" width="300"/>
                    <a:label name="ship_date_fmt" bindTarget="inv_asnDocumentViewHeader_ds" prompt="INV_ASN_HEADERS.SHIP_DATE" width="120"/>
                </a:hBox>
                <a:hBox labelWidth="90">
                    <a:label name="company_name" bindTarget="inv_asnDocumentViewHeader_ds" prompt="INV_ASN_HEADERS_TEMP.COMPANY_ID" width="230"/>
                    <a:label name="ship_to_organization_name" bindTarget="inv_asnDocumentViewHeader_ds" prompt="INV_ASN_HEADERS_TEMP.SHIP_TO_ORGANIZATION_ID" width="230"/>
                    <a:label name="location_name" bindTarget="inv_asnDocumentViewHeader_ds" prompt="INV_ASN_HEADERS_TEMP.LOCATION_ID" width="300"/>
                    <a:label name="expected_date_fmt" bindTarget="inv_asnDocumentViewHeader_ds" prompt="INV_ASN_HEADERS_TEMP.EXPECTED_DATE" width="120"/>
                </a:hBox>
                <a:hBox labelWidth="90">
                    <a:label name="asn_type_name" bindTarget="inv_asnDocumentViewHeader_ds" prompt="INV_ASN_HEADERS.ASN_TYPE" width="230"/>
                    <a:label name="actual_receiver_name" bindTarget="inv_asnDocumentViewHeader_ds" prompt="INV_ASN_HEADERS.ACTUAL_RECEIVER_NAME" width="230"/>
                    <a:label name="deliver_number" bindTarget="inv_asnDocumentViewHeader_ds" prompt="INV_ASN.DELIVER_NUMBER" width="300"/>
                </a:hBox>
                <a:hBox labelWidth="90">
                    <a:label name="comments" bindTarget="inv_asnDocumentViewHeader_ds" prompt="INV_ASN_HEADERS.HEADER_DESC" width="900"/>
                </a:hBox>
            </a:form>
            <a:tabPanel marginHeight="330" marginWidth="30">
                <a:tabs>
                    <a:tab prompt="PROMPT.BASIC_INFOMATION" width="130">
                        <a:grid id="inv_asnDocumentViewLine_ds_grid" autoAppend="false" bindTarget="inv_asnDocumentViewLine_ds" marginHeight="380" marginWidth="45" navBar="true" style="margin:5px;">
                            <a:columns>
                                <a:column name="asn_line_num" align="center" prompt="INV_ASN_LINES.ASN_LINE_NUM" sortable="true" width="25"/>
                                <a:column name="cancel_flag" align="center" prompt="INV_ASN_LINES.CANCEL_FLAG" width="30"/>
                                <a:column name="part_cancel" align="center" prompt="部分取消" width="35"/>
                                <a:column name="cancel_quantity" align="center" prompt="取消数量" width="35"/>
                                <a:column name="close_flag" align="center" prompt="INV_ASN_RELEATED.CLOSED_QUANTITY" width="30"/>
                                <a:column name="po_num" align="left" prompt="INV_ASN_LINES.SEGMENT1" sortable="true" width="50"/>
                                <a:column name="line_num" align="left" prompt="INV_ASN_HEADERS.LINE_NUM" sortable="true" width="40"/>
                                <a:column name="require_item_code" align="left" prompt="MTL_SYSTEM_ITEMS.CLIENT_ITEM_CODE" sortable="true" width="80"/>
                                <a:column name="require_item_name" align="left" prompt="MTL_SYSTEM_ITEMS.CLIENT_ITEM_NAME" sortable="true" width="90"/>
                                <a:column name="ship_quantity" align="right" prompt="INV_ASN_LINES.SHIP_QUANTITY" renderer="Aurora.formatNumber" width="50"/>
                                <a:column name="uom_desc" align="left" prompt="INV_ASN_LINES.UNIT_MEAS_LOOKUP_CODE" width="30"/>
                                <a:column name="line_receive_status" align="left" prompt="INV_ASN_LINES.LINE_RECEIVE_STATUS" width="40"/>
                                <a:column name="receive_quantity" align="right" prompt="INV_ASN_LINES.RECEIVE_QUANTITY" renderer="Aurora.formatNumber" width="40"/>
                                <a:column name="on_the_way_quantity" align="right" prompt="INV_ASN_LINES.ON_THE_WAY_QUANTITY" renderer="Aurora.formatNumber" width="40"/>
                                <a:column name="release_num" align="left" prompt="INV_ASN_LINES.RELEASE_NUM" width="40"/>
                                <a:column name="shipment_num" align="left" prompt="INV_ASN_LINES.SHIPMENT_NUM" width="40"/>
                                <a:column name="reversion_num" align="left" prompt="INV_ASN_LINES.REVERSION_NUM" width="40"/>
                                <a:column name="del_plan_number" align="left" prompt="INV8010.DELIVERY_PLAN_NUMBER" sortable="true" width="60"/>
                                <a:column name="del_plan_line_num" align="left" prompt="送货计划行号" sortable="true" width="30"/>
                                <a:column name="need_del_quantity" align="left" prompt="要求送货数量" sortable="true" width="40"/>
                                <a:column name="need_arrive_date" align="left" prompt="要求送货日期" sortable="true" width="50"/>
                                <a:column name="send_address" align="left" prompt="送货地址" sortable="true" width="50"/>
                                <a:column name="need_by_date" align="left" prompt="INV_ASN_LINES.NEED_BY_DATE" renderer="Aurora.formatDate" sortable="true" width="50"/>
                                <!-- <a:column name="promised_date" align="left" prompt="INV_ASN_LINES.PROMISED_DATE" renderer="Aurora.formatDate" sortable="true" width="50"/> -->
                                <a:column name="agent_name" align="left" prompt="INV_ASN_LINES.AGENT_ID" width="50"/>
                                <a:column name="inv_warehouse" align="left" prompt="INV_WAREHOUSES.INV_WAREHOUSE" width="50"/>
                                <a:column name="inv_location" align="left" prompt="INV_LOCATIONS.INV_LOCATION" width="50"/>
                                <!-- <a:column name="contacts_info" align="left" prompt="INV_ASN_LINES.CONTACTS_INFO" sortable="true" width="70"/> -->
                                <a:column name="line_desc" align="left" prompt="PUR_LINES_ALL.PUR_LINE_DESC" width="140"/>
                                <a:column name="comments" align="left" prompt="INV_ASN_LINES_TEMP.VENDOR_COMMENTS" width="140"/>
                                <a:column name="import_status_desc" align="center" prompt="INV_ASN_HEADERS.IMPORT_STATUS" width="50"/>
                                <a:column name="re_number_sap" align="center" prompt="INV_ASN_HEADERS.INBOUND_DELIVERY_NUMBER" width="70"/>
                                <!-- <a:column name="ean_code" align="left" prompt="MTL_SYSTEM_ITEMS.EAN_CODE" sortable="true" width="80"/> -->
                                <a:column name="line_attachment" align="center" prompt="PROMPT.ATTACHMENT" renderer="inv_asnDocumentViewLineDsGridRenderer" width="60"/>
                                <a:column name="autoid" align="left" prompt="INV_ASN.AUTOID" sortable="true" width="60"/>
                            </a:columns>
                        </a:grid>
                    </a:tab>
                    <a:tab prompt="PROMPT.OTHER_INFO" width="130">
                        <a:grid autoAppend="false" bindTarget="inv_asnDocumentViewLine_ds" marginHeight="380" marginWidth="45" navBar="true" style="margin:5px;">
                            <a:columns>
                                <a:column name="asn_line_num" align="left" prompt="INV_ASN_LINES.ASN_LINE_NUM" sortable="true" width="25"/>
                                <a:column name="require_item_code" align="left" prompt="MTL_SYSTEM_ITEMS.CLIENT_ITEM_CODE" sortable="true" width="60"/>
                                <a:column name="require_item_name" align="left" prompt="MTL_SYSTEM_ITEMS.CLIENT_ITEM_NAME" sortable="true" width="90"/>
                                <a:column name="item_specs" align="left" prompt="MTL_SYSTEM_VENDOR_ITEMS.ITEM_SPECS" sortable="true" width="60"/>
                                <a:column name="item_model" align="left" prompt="MTL_SYSTEM_VENDOR_ITEMS.ITEM_MODEL" sortable="true" width="60"/>
                                <!--  <a:column name="ean_code" align="left" prompt="PUR_LINES_ALL.EAN_CODE" sortable="true" width="80"/> -->
                                <a:column name="lots_num" align="left" prompt="INV_ASN_LINES_TEMP.LOTS_NUM" width="50"/>
                                <!-- 生产日期 -->
                                <a:column name="production_date" prompt="INV_ASN_LINES_TEMP.PRODUCTION_DATE" width="50"/>
                                <!--  保质期 -->
                                <a:column name="quality_guarantee_date" prompt="INV_ASN_LINES_TEMP.QUALITY_GUARANTEE_DATE" width="40"/>
                                <a:column name="lots_validity_date" align="left" prompt="INV_ASN_LINES_TEMP.LOTS_VALIDITY_DATE" renderer="Aurora.formatDate" width="50"/>
                                <a:column name="packet_quantity" align="left" prompt="INV_ASN_LINES_TEMP.PACKET_QUANTITY" width="40"/>
                                <!-- 件数 -->
                                <a:column name="box_amount" prompt="INV_ASN_LINES_TEMP.BOX_AMOUNT" width="30"/>
                                <!-- 尾数 -->
                                <a:column name="mantissa_quantity" prompt="DZINV1010.MANTISSA_QUANTITY" width="30"/>
                                <!-- <a:column name="serial_num" align="left" prompt="INV_ASN_LINES_TEMP.SERIAL_NUM" width="50"/> -->
                                <!-- <a:column name="invoice_num" align="left" prompt="INV_ASN_LINES_TEMP.INVOICE_NUM" width="70"/> -->
                                <a:column name="production_batch" align="left" prompt="INV_ASN_LINES_TEMP.PRODUCTION_BATCH" width="40"/>
                                <!-- <a:column name="environmental_batch" align="left" prompt="INV_ASN_LINES_TEMP.ENVIRONMENTAL_BATCH" width="40"/> -->
                                <a:column name="packet_weight" align="left" prompt="单重" width="40"/>
                                <!-- <a:column name="box_weight" align="left" prompt="INV_ASN_LINES_TEMP.BOX_WEIGHT" width="40"/> -->
                                <a:column name="used_item_code" align="center" prompt="MTL2060.USED_ITEM_CODE" width="60"/>
                                <a:column name="package_uom_quantity" align="right" prompt="INV_ASN_LINES_TEMP.PACK" width="50"/>
                                <a:column name="label_line_info" align="center" prompt="SHTN_INV_ASN_LINES.LABEL_LINE_INFO" renderer="inv_asn_vendor_view_label_line_renderer" width="50"/>
                                <a:column name="deliver_weight" align="right" prompt="SHTN_INV_ASN_LINES.DELIVER_WEIGHT" renderer="Aurora.formatNumber" width="50"/>
                                <a:column name="lpn_number" align="center" prompt="INV_ASN_LINES_TEMP.LPN_NUMBER" width="80"/>
                                <a:column name="heat_number" prompt="INV_ASN_LINES_TEMP.HEAT_NUMBER" width="50"/>
                                <a:column name="heat_repeat_flag" align="center" prompt="INV_ASN_LINES_TEMP.HEAT_REPEAT_FLAG" width="50"/>
                                <a:column name="reel_number" prompt="INV_ASN_LINES_TEMP.REEL_NUMBER" width="50"/>
                                <a:column name="package_number" prompt="INV_ASN_LINES_TEMP.PACKAGE_NUMBER" width="50"/>
                                <a:column name="asn_line_id" align="center" prompt="INV_ASN_LINES_TEMP.EXTERNAL_VERIFICATION" renderer="inv_asn_vendor_view_po_bom_renderer" width="50"/>
                                <!-- <a:column name="supply_item_code" align="left" prompt="MTL_SYSTEM_ITEMS.ITEM_CODE" sortable="true" width="70"/> -->
                                <!-- <a:column name="supply_item_name" align="left" prompt="MTL_SYSTEM_ITEMS.ITEM_NAME" sortable="true" width="110"/> -->
                            </a:columns>
                        </a:grid>
                    </a:tab>
                    <a:tab prompt="PROMPT.LOGISTICS_INFO" width="130">
                        <a:vBox labelWidth="90" style="margin:5px;">
                            <a:hBox>
                                <a:lov name="logistics_company" bindTarget="inv_asnDocumentViewHeader_ds" maxLength="200" prompt="INV_ASN_HEADERS_TEMP.LOGISTICS_COMPANY" width="230"/>
                            </a:hBox>
                            <a:hBox>
                                <a:textField name="dispatching_staff" bindTarget="inv_asnDocumentViewHeader_ds" maxLength="200" prompt="INV_ASN_HEADERS_TEMP.DELIVERY_STAFF" width="230"/>
                            </a:hBox>
                            <a:hBox>
                                <a:textField name="contact_information" bindTarget="inv_asnDocumentViewHeader_ds" maxLength="200" prompt="FND1000.CONTACT_INFO" width="230"/>
                            </a:hBox>
                            <a:hBox>
                                <a:textField name="logistics_cost" bindTarget="inv_asnDocumentViewHeader_ds" maxLength="200" prompt="INV_ASN_HEADERS_TEMP.LOGISTICS_COST" width="230"/>
                            </a:hBox>
                            <a:hBox>
                                <a:textField name="express_number" bindTarget="inv_asnDocumentViewHeader_ds" maxLength="200" prompt="INV_ASN_HEADERS_TEMP.EXPRESS_NUMBER" width="230"/>
                                <a:button click="inv_asnViewHeaderExpressNumberQuery" text="PROMPT.QUERY" width="70"/>
                            </a:hBox>
                        </a:vBox>
                    </a:tab>
                    <a:tab prompt="申报要素" width="130">
                        <a:grid id="inv5010_asn_edit_declares_ds_grid" autoAppend="false" bindTarget="inv5010_asn_edit_declares_ds" marginHeight="370" marginWidth="85" navBar="false" style="margin:5px;">
                            <a:columns>
                                <a:column name="line_num" align="right" prompt="序号" sortable="true" width="30"/>
                                <a:column name="order_details" align="left" prompt="订购明细" sortable="true" width="100"/>
                                <a:column name="item_code" align="left" prompt="商品编码" sortable="true" width="100"/>
                                <a:column name="brand_type" align="left" prompt="品牌类型" sortable="true" width="80"/>
                                <a:column name="export_benefits" align="left" prompt="出口享惠情况" sortable="true" width="80"/>
                                <a:column name="trade_name" align="left" prompt="品名" width="80"/>
                                <a:column name="shape" align="left" prompt="形状" sortable="true" width="80"/>
                                <a:column name="texture" align="left" prompt="材质" sortable="true" width="80"/>
                                <a:column name="state" align="left" prompt="状态" sortable="true" width="80"/>
                                <a:column name="component_content" align="left" prompt="成分含量" sortable="true" width="80"/>
                                <a:column name="overall_thickness" align="left" prompt="整体厚度（MM）" sortable="true" width="80"/>
                                <a:column name="copper_thickness" align="left" prompt="铜箔厚度（填写单面铜厚um*2）" sortable="true" width="80"/>
                                <a:column name="length" align="left" prompt="长度（MM）" sortable="true" width="80"/>
                                <a:column name="width" align="left" prompt="宽度（MM）" sortable="true" width="80"/>
                                <a:column name="purpose" align="left" prompt="用途" sortable="true" width="80"/>
                                <a:column name="brand" align="left" prompt="品牌" sortable="true" width="80"/>
                                <a:column name="mark" align="left" prompt="牌号" sortable="true" width="80"/>
                                <a:column name="kind" align="left" prompt="种类" sortable="true" width="80"/>
                                <a:column name="plies" align="left" prompt="覆铜板的铜箔层数" sortable="true" width="80"/>
                                <a:column name="substrate_material" align="left" prompt="基材材质" sortable="true" width="80"/>
                                <a:column name="manufacturer" align="left" prompt="生产厂商" sortable="true" width="80"/>
                                <a:column name="dielectric_constant" align="left" prompt="覆铜板需申报介电常数" sortable="true" width="80"/>
                                <a:column name="single_or_double" align="left" prompt="覆铜板报单面还是双面" sortable="true" width="80"/>
                                <a:column name="material_of_substrate" align="left" prompt="覆铜板基板材质" sortable="true" width="80"/>
                                <a:column name="package" align="left" prompt="包装" width="80"/>
                                <a:column name="color" align="left" prompt="颜色" width="80"/>
                                <a:column name="comment_place" align="left" prompt="备注：产地" width="80"/>
                                <a:column name="declaration_type" align="left" prompt="报关型号" sortable="true" width="80"/>
                                <a:column name="vendor_site" align="left" prompt="供应商地点" sortable="true" width="80"/>
                                <a:column name="working_voltage" align="left" prompt="工作电压" sortable="true" width="80"/>
                                <a:column name="lot_no" align="left" prompt="LOT NO" sortable="true" width="80"/>
                            </a:columns>
                        </a:grid>
                    </a:tab>
                    <a:tab prompt="发票" width="130">
                        <a:grid id="inv5010_asn_edit_invoices_ds_grid" autoAppend="false" bindTarget="inv5010_asn_edit_invoices_ds" marginHeight="370" marginWidth="85" navBar="false" style="margin:5px;">
                            <a:columns>
                                <a:column name="line_num" align="right" prompt="序号" sortable="true" width="30"/>
                                <a:column name="item_code" align="left" prompt="物料编码" sortable="true" width="100"/>
                                <a:column name="trade_name" align="left" prompt="品名" sortable="true" width="100"/>
                                <a:column name="spec" align="left" prompt="规格" sortable="true" width="100"/>
                                <a:column name="quantity" align="right" prompt="数量" sortable="true" width="40"/>
                                <a:column name="unit_price" align="right" prompt="单价" sortable="true" width="40"/>
                                <a:column name="line_amount" align="right" prompt="总价" sortable="true" width="40"/>
                                <a:column name="currency_code" align="right" prompt="币种" sortable="true" width="40"/>
                                <a:column name="delivery_num" align="left" prompt="出货单号" sortable="true" width="100"/>
                                <a:column name="delivery_date" align="center" prompt="出货日期" renderer="Aurora.formatDate" sortable="true" width="100"/>
                                <a:column name="net_weight" align="left" prompt="重量（KG）" sortable="true" width="100"/>
                                <a:column name="uom_desc" align="left" prompt="单位" sortable="true" width="100"/>
                                <a:column name="brand_name" align="left" prompt="品牌" sortable="true" width="100"/>
                                <a:column name="origin_country" align="left" prompt="原产地" sortable="true" width="100"/>
                            </a:columns>
                        </a:grid>
                    </a:tab>
                    <a:tab prompt="装箱单" width="130">
                        <a:grid id="inv5010_asn_edit_encasements_ds_grid" autoAppend="false" bindTarget="inv5010_asn_edit_encasements_ds" marginHeight="370" marginWidth="85" navBar="false" style="margin:5px;">
                            <a:columns>
                                <a:column name="line_num" align="right" prompt="序号" sortable="true" width="30"/>
                                <a:column name="item_code" align="left" prompt="物料编码" sortable="true" width="100"/>
                                <a:column name="trade_name" align="left" prompt="品名 规格" sortable="true" width="100"/>
                                <!-- <a:column name="mark_case_no" align="left" prompt="标志及箱号" sortable="true" width="100"/> -->
                                <a:column name="wooden_num" align="left" prompt="木托数" sortable="true" width="80"/>
                                <a:column name="numbers" align="left" prompt="件数/箱" sortable="true" width="80"/>
                                <a:column name="brand_name" align="left" prompt="品牌" sortable="true" width="80"/>
                                <a:column name="producing_area" align="left" prompt="产地" sortable="true" width="80"/>
                                <a:column name="batch_number" align="left" prompt="批次号" sortable="true" width="80"/>
                                <a:column name="packaging_type" align="left" prompt="包装种类" sortable="true" width="80"/>
                                <a:column name="quantity" align="right" prompt="数量" sortable="true" width="40"/>
                                <a:column name="unit" align="left" prompt="单位" sortable="true" width="80"/>
                                <a:column name="net_weight" align="left" prompt="净重(KG)" sortable="true" width="80"/>
                                <a:column name="rough_weight" align="left" prompt="毛重(KG)" sortable="true" width="80"/>
                                <a:column name="po_num" align="left" prompt="订单号" sortable="true" width="80"/>
                                <a:column name="contract_num" align="left" prompt="合同号" sortable="true" width="80"/>
                                <a:column name="main_agent_kg" align="left" prompt="主剂(KG/罐)" sortable="true" width="80"/>
                                <a:column name="hardener_kg" align="left" prompt="硬化剂(KG/罐)" sortable="true" width="80"/>
                                <a:column name="main_agent_tank" align="left" prompt="主剂(罐/箱)" sortable="true" width="80"/>
                                <a:column name="hardener_tank" align="left" prompt="硬化剂(罐/箱)" sortable="true" width="80"/>
                            </a:columns>
                        </a:grid>
                    </a:tab>
                    <a:tab prompt="合同" width="130">
                        <a:grid id="inv5010_asn_edit_contracts_ds_grid" autoAppend="false" bindTarget="inv5010_asn_edit_contracts_ds" marginHeight="370" marginWidth="85" navBar="false" style="margin:5px;">
                            <a:columns>
                                <a:column name="line_num" align="right" lock="true" prompt="序号" sortable="true" width="30"/>
                                <a:column name="product_name" align="right" lock="true" prompt="品名" sortable="true" width="80"/>
                                <a:column name="model_type" align="left" lock="true" prompt="规格型号" sortable="true" width="100"/>
                                <a:column name="quantity" align="left" lock="true" prompt="数量" sortable="true" width="80"/>
                                <a:column name="unit_price" align="left" lock="true" prompt="单价" sortable="true" width="80"/>
                                <!-- <a:column name="unit_desc" align="left" prompt="单位" sortable="true" width="80"/> -->
                                <a:column name="total_price" align="left" prompt="总价" sortable="true" width="80"/>
                                <a:column name="currency_code" align="left" prompt="币种" sortable="true" width="80"/>
                                <a:column name="brand_name" align="left" prompt="品牌" sortable="true" width="80"/>
                                <a:column name="producing_area" align="left" prompt="原产地" sortable="true" width="80"/>
                                <a:column name="delivery_port" align="right" prompt="交货口岸" sortable="true" width="80"/>
                                <a:column name="delivery_place" align="left" prompt="交货地点" sortable="true" width="80"/>
                                <a:column name="delivery_term" align="left" prompt="交货期限" sortable="true" width="80"/>
                                <a:column name="payment_method" align="left" prompt="付款方式" sortable="true" width="80"/>
                            </a:columns>
                        </a:grid>
                    </a:tab>
                </a:tabs>
            </a:tabPanel>
        </a:screenBody>
        <script><![CDATA[
            Aurora.onReady(function(){
                var button_control_ds = $('inv7020_vendor_button_control_ds').getAll();
                if(button_control_ds.length > 0){
                    $('inv_asnDocumentVendorView_confirm_attachments_btn').show();       
                }
                
                var reimport_btn = $('inv_asnDocumentViewReimport_btn');
                var item_value = '${/model/bg_item_asn_10/record/@bg_config_item_value}';
                if(Aurora.isEmpty(item_value) || item_value == 'N'){
                    reimport_btn.enable();
                }
            });
        ]]></script>
    </a:view>
</a:screen>
