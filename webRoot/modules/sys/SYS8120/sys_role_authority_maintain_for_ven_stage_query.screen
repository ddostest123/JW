<?xml version="1.0" encoding="UTF-8"?>
<a:screen xmlns:c="aurora.application.action" xmlns:a="http://www.aurora-framework.org/application" xmlns:p="uncertain.proc" trace="true">
    <a:init-procedure>
        <a:model-query defaultWhereClause="cvv.code = &apos;FND_AUTHORITY_TYPE&apos; and cvv.code_value in (&apos;LIMIT_PERSONAL_USER&apos;,&apos;LIMIT_BUSINESS_AREA&apos;)" model="public.sys_code_part_list" rootPath="authority_type_list"/>
        <a:model-query defaultWhereClause="cvv.code = &apos;FND_AUTHORITY_TYPE&apos; and cvv.code_value in (&apos;LIMIT_PERSONAL_USER&apos;,&apos;LIMIT_BUSINESS_AREA&apos;)" model="public.sys_code_part_list" rootPath="authority_type_list1"/>
        <a:model-query defaultWhereClause="cvv.code = &apos;FND_AUTHORITY_TYPE&apos; and cvv.code_value in (&apos;LIMIT_PERSONAL_USER&apos;,&apos;LIMIT_BUSINESS_AREA&apos;)" model="public.sys_code_part_list" rootPath="authority_type_list2"/>
        <a:model-query defaultWhereClause="cvv.code = &apos;FND_AUTHORITY_TYPE&apos; and cvv.code_value in (&apos;LIMIT_PERSONAL_USER&apos;,&apos;LIMIT_BUSINESS_AREA&apos;)" model="public.sys_code_part_list" rootPath="authority_type_list3"/>
        <a:model-query defaultWhereClause="cvv.code = &apos;FND_AUTHORITY_TYPE&apos; and cvv.code_value in (&apos;LIMIT_PERSONAL_USER&apos;,&apos;LIMIT_BUSINESS_AREA&apos;)" model="public.sys_code_part_list" rootPath="authority_type_list4"/>
        <a:model-query defaultWhereClause="cvv.code = &apos;FND_AUTHORITY_USER&apos; and cvv.code_value in (&apos;CREATER&apos;,&apos;RECEIVER&apos;)" model="public.sys_code_part_list" rootPath="authority_user_list"/>
        <a:model-query defaultWhereClause="cvv.code = &apos;FND_AUTHORITY_USER&apos; and cvv.code_value in (&apos;CREATER&apos;,&apos;RECEIVER&apos;)" model="public.sys_code_part_list" rootPath="authority_user_list1"/>
        <a:model-query defaultWhereClause="cvv.code = &apos;FND_AUTHORITY_USER&apos; and cvv.code_value in (&apos;CREATER&apos;,&apos;RECEIVER&apos;)" model="public.sys_code_part_list" rootPath="authority_user_list2"/>
        <a:model-query defaultWhereClause="cvv.code = &apos;FND_AUTHORITY_USER&apos; and cvv.code_value in (&apos;CREATER&apos;,&apos;RECEIVER&apos;)" model="public.sys_code_part_list" rootPath="authority_user_list3"/>
        <a:model-query defaultWhereClause="cvv.code = &apos;FND_AUTHORITY_USER&apos; and cvv.code_value in (&apos;CREATER&apos;,&apos;RECEIVER&apos;)" model="public.sys_code_part_list" rootPath="authority_user_list4"/>
        <a:model-query model="sys.SYS8120.sys_role_authority_area_list_for_registered" rootPath="authority_area_list_for_registered"/>
        <a:model-query model="sys.SYS8120.sys_role_authority_area_list_for_recommended" rootPath="authority_area_list_for_recommended"/>
        <a:model-query model="sys.SYS8120.sys_role_authority_area_list_for_potential" rootPath="authority_area_list_for_potential"/>
        <a:model-query model="sys.SYS8120.sys_role_authority_area_list_for_qualified" rootPath="authority_area_list_for_qualified"/>
        <a:model-query model="sys.SYS8120.sys_role_authority_area_list_for_eliminated" rootPath="authority_area_list_for_eliminated"/>
        <a:model-query defaultWhereClause="ra.role_id = ${/parameter/@role_id} and ra.business_group = ${/parameter/@business_group} and ra.foundation_code = ${/parameter/@foundation_code} and ra.data_type = &apos;REGISTERED&apos;" model="sys.SYS8120.sys_role_authority_maintain" rootPath="authority_maintain"/>
        <a:model-query defaultWhereClause="ra.role_id = ${/parameter/@role_id} and ra.business_group = ${/parameter/@business_group} and ra.foundation_code = ${/parameter/@foundation_code} and ra.data_type = &apos;RECOMMENDED&apos;" model="sys.SYS8120.sys_role_authority_maintain" rootPath="authority_maintain1"/>
        <a:model-query defaultWhereClause="ra.role_id = ${/parameter/@role_id} and ra.business_group = ${/parameter/@business_group} and ra.foundation_code = ${/parameter/@foundation_code} and ra.data_type = &apos;POTENTIAL&apos;" model="sys.SYS8120.sys_role_authority_maintain" rootPath="authority_maintain2"/>
        <a:model-query defaultWhereClause="ra.role_id = ${/parameter/@role_id} and ra.business_group = ${/parameter/@business_group} and ra.foundation_code = ${/parameter/@foundation_code} and ra.data_type = &apos;QUALIFIED&apos;" model="sys.SYS8120.sys_role_authority_maintain" rootPath="authority_maintain3"/>
        <a:model-query defaultWhereClause="ra.role_id = ${/parameter/@role_id} and ra.business_group = ${/parameter/@business_group} and ra.foundation_code = ${/parameter/@foundation_code} and ra.data_type = &apos;ELIMINATED&apos;" model="sys.SYS8120.sys_role_authority_maintain" rootPath="authority_maintain4"/>
        <a:model-query defaultWhereClause="aa.role_id = ${/parameter/@role_id} and aa.business_group = ${/parameter/@business_group} and aa.foundation_code = ${/parameter/@foundation_code} and aa.data_type = &apos;REGISTERED&apos;" model="sys.SYS8120.sys_role_authority_area_query" rootPath="authority_area_select_by_registered"/>
        <a:model-query defaultWhereClause="aa.role_id = ${/parameter/@role_id} and aa.business_group = ${/parameter/@business_group} and aa.foundation_code = ${/parameter/@foundation_code} and aa.data_type = &apos;RECOMMENDED&apos;" model="sys.SYS8120.sys_role_authority_area_query" rootPath="authority_area_select_by_recommended"/>
        <a:model-query defaultWhereClause="aa.role_id = ${/parameter/@role_id} and aa.business_group = ${/parameter/@business_group} and aa.foundation_code = ${/parameter/@foundation_code} and aa.data_type = &apos;POTENTIAL&apos;" model="sys.SYS8120.sys_role_authority_area_query" rootPath="authority_area_select_by_potential"/>
        <a:model-query defaultWhereClause="aa.role_id = ${/parameter/@role_id} and aa.business_group = ${/parameter/@business_group} and aa.foundation_code = ${/parameter/@foundation_code} and aa.data_type = &apos;QUALIFIED&apos;" model="sys.SYS8120.sys_role_authority_area_query" rootPath="authority_area_select_by_qualified"/>
        <a:model-query defaultWhereClause="aa.role_id = ${/parameter/@role_id} and aa.business_group = ${/parameter/@business_group} and aa.foundation_code = ${/parameter/@foundation_code} and aa.data_type = &apos;ELIMINATED&apos;" model="sys.SYS8120.sys_role_authority_area_query" rootPath="authority_area_select_by_eliminated"/>
    </a:init-procedure>
    <a:view>
        <a:link id="sys8120_sys_role_function_save_link" url="${/request/@context_path}/modules/sys/SYS8120/sys_role_authority_save.svc"/>
        <div/>
        <style><![CDATA[
            .item-radio:focus {
                outline:none;
            }
            .item-radio-img {
                margin-left:10px;
            }
            .item-radio-lb {
				text-align: left;
				width: 180px;
			}
			.item-ckb {
				float: left;
				margin-top: 3px;
				margin-right: 8px;
				outline: none;
			}
			label {
				display: block;
				margin-bottom: 0px;
			}
        ]]></style>
        <script><![CDATA[
            function sys8129_onAuthorityTypeChange(div, value, oldvalue) {
                var record = $('sys8120_fnd_bg_role_authority_ds').getCurrentRecord();
                var area_list = $('sys8120_authority_area_list_for_registered_ds').getAll();
                if (value && value == 'LIMIT_BUSINESS_AREA') {
                    record.set('authority_user', null);
                    record.getField('authority_user').setReadOnly(true);
                    for (var i = 1;i <= area_list.length;i++) {
                        record.getField('checkbox_' + i).setReadOnly(false);
                    }
                } else if (value && value == 'LIMIT_PERSONAL_USER') {
                    record.getField('authority_user').setReadOnly(false);
                    for (var j = 1;j <= area_list.length;j++) {
                        record.set('checkbox_' + j, 'NULL');
                        record.getField('checkbox_' + j).setReadOnly(true);
                    }
                }
            }
            
            function sys8129_onAuthorityTypeChange1(div, value, oldvalue) {
                var record = $('sys8120_fnd_bg_role_authority_ds1').getCurrentRecord();
                var area_list = $('sys8120_authority_area_list_for_recommended_ds').getAll();
                if (value && value == 'LIMIT_BUSINESS_AREA') {
                    record.set('authority_user', null);
                    record.getField('authority_user').setReadOnly(true);
                    for (var i = 1;i <= area_list.length;i++) {
                        record.getField('checkbox_' + i).setReadOnly(false);
                    }
                } else if (value && value == 'LIMIT_PERSONAL_USER') {
                    record.getField('authority_user').setReadOnly(false);
                    for (var j = 1;j <= area_list.length;j++) {
                        record.set('checkbox_' + j, 'NULL');
                        record.getField('checkbox_' + j).setReadOnly(true);
                    }
                }
            }
            
            function sys8129_onAuthorityTypeChange2(div, value, oldvalue) {
                var record = $('sys8120_fnd_bg_role_authority_ds2').getCurrentRecord();
                var area_list = $('sys8120_authority_area_list_for_potential_ds').getAll();
                if (value && value == 'LIMIT_BUSINESS_AREA') {
                    record.set('authority_user', null);
                    record.getField('authority_user').setReadOnly(true);
                    for (var i = 1;i <= area_list.length;i++) {
                        record.getField('checkbox_' + i).setReadOnly(false);
                    }
                } else if (value && value == 'LIMIT_PERSONAL_USER') {
                    record.getField('authority_user').setReadOnly(false);
                    for (var j = 1;j <= area_list.length;j++) {
                        record.set('checkbox_' + j, 'NULL');
                        record.getField('checkbox_' + j).setReadOnly(true);
                    }
                }
            }
            
            function sys8129_onAuthorityTypeChange3(div, value, oldvalue) {
                var record = $('sys8120_fnd_bg_role_authority_ds3').getCurrentRecord();
                var area_list = $('sys8120_authority_area_list_for_qualified_ds').getAll();
                if (value && value == 'LIMIT_BUSINESS_AREA') {
                    record.set('authority_user', null);
                    record.getField('authority_user').setReadOnly(true);
                    for (var i = 1;i <= area_list.length;i++) {
                        record.getField('checkbox_' + i).setReadOnly(false);
                    }
                } else if (value && value == 'LIMIT_PERSONAL_USER') {
                    record.getField('authority_user').setReadOnly(false);
                    for (var j = 1;j <= area_list.length;j++) {
                        record.set('checkbox_' + j, 'NULL');
                        record.getField('checkbox_' + j).setReadOnly(true);
                    }
                }
            }
            
            function sys8129_onAuthorityTypeChange4(div, value, oldvalue) {
                var record = $('sys8120_fnd_bg_role_authority_ds4').getCurrentRecord();
                var area_list = $('sys8120_authority_area_list_for_eliminated_ds').getAll();
                if (value && value == 'LIMIT_BUSINESS_AREA') {
                    record.set('authority_user', null);
                    record.getField('authority_user').setReadOnly(true);
                    for (var i = 1;i <= area_list.length;i++) {
                        record.getField('checkbox_' + i).setReadOnly(false);
                    }
                } else if (value && value == 'LIMIT_PERSONAL_USER') {
                    record.getField('authority_user').setReadOnly(false);
                    for (var j = 1;j <= area_list.length;j++) {
                        record.set('checkbox_' + j, 'NULL');
                        record.getField('checkbox_' + j).setReadOnly(true);
                    }
                }
            }
            
            function sys8210_saveRoleAuthority() {
                var area_list = $('sys8120_authority_area_list_for_registered_ds').getAll();
                var record = $('sys8120_fnd_bg_role_authority_ds').getCurrentRecord();
                var error = {};
                if (Aurora.isEmpty(record) || Aurora.isEmpty(record.get('authority_type'))) {
                    //Aurora.showMessage('${l:PROMPT}', '${l:SYS8120.PLEASE_CHOOSE_AUTHORITY_TYPE}');
                    error = {
                        foundation_code: '${/parameter/@foundation_code}',
                        data_type: 'REGISTERED',
                        empty:'Y',
                        error:{
                            foundation_code: '${/parameter/@foundation_code}'
                        }
                    };
                    return error;
                }
                if (Aurora.isEmpty(record) || (record.get('authority_type') == 'LIMIT_PERSONAL_USER' && Aurora.isEmpty(record.get('authority_user')))) {
                    //Aurora.showMessage('${l:PROMPT}', '${l:SYS8120.YOU_PICK_LIMIT_PERSONAL_USER_BUT_NO_CHOOSE_THE_USER}');
                    error = {
                        foundation_code: '${/parameter/@foundation_code}',
                        data_type: 'REGISTERED',
                        error_message:  '${l:SYS8120.YOU_PICK_LIMIT_PERSONAL_USER_BUT_NO_CHOOSE_THE_USER}'
                    };
                    //return error;
                }
            
                var datas = {
                    role_id: '${/parameter/@role_id}',
                    business_group: '${/parameter/@business_group}',
                    foundation_code: '${/parameter/@foundation_code}',
                    authority_type: record.get('authority_type'),
                    authority_user: record.get('authority_user'),
                    shield_flag: record.get('shield_flag'),
                    data_type: 'REGISTERED',
                    _status: 'update'
                };
                var authority_areas = [];
                if (record.get('authority_type') == 'LIMIT_BUSINESS_AREA') {
                    var at_least_count = 0;
                    for (var i = 1;i <= area_list.length;i++) {
                        if (!Aurora.isEmpty(record.get('checkbox_' + i)) && record.get('checkbox_' + i) != 'NULL') {
                            authority_areas.push(area_list[i - 1].data);
                            authority_areas[authority_areas.length - 1]._status = 'insert';
                            authority_areas[authority_areas.length - 1].role_id = '${/parameter/@role_id}';
                            authority_areas[authority_areas.length - 1].foundation_code = '${/parameter/@foundation_code}';
                            at_least_count++;
                        }
                    }
                    if (at_least_count == 0) {
                        //Aurora.showMessage('${l:PROMPT}', '${l:SYS8120.YOU_PICK_LIMIT_BUSINESS_AREA_AND_SELECT_ONE_AT_LEAST}');
                        error = {
                            foundation_code: '${/parameter/@foundation_code}',
                            error_message:  '${l:SYS8120.YOU_PICK_LIMIT_BUSINESS_AREA_AND_SELECT_ONE_AT_LEAST}'
                        };
                        //return error;
                    }
                }
                datas['authority_areas'] = authority_areas;
                datas['error'] = error;
                return datas;
                /* Aurora.request({
                 url: $('sys8120_sys_role_function_save_link').getUrl(),
                 para: datas,
                 success: function() {
                 Aurora.showMessage('${l:PROMPT}', '${l:PROMPT.SAVE_SUCCESS}');
                 },
                 failure: function() {},
                 error: function() {},
                 scope: this
                 }); */
            }
            
            function sys8210_saveRoleAuthority1() {
                var area_list = $('sys8120_authority_area_list_for_recommended_ds').getAll();
                var record = $('sys8120_fnd_bg_role_authority_ds1').getCurrentRecord();
                var error = {};
                if (Aurora.isEmpty(record) || Aurora.isEmpty(record.get('authority_type'))) {
                    //Aurora.showMessage('${l:PROMPT}', '${l:SYS8120.PLEASE_CHOOSE_AUTHORITY_TYPE}');
                    error = {
                        foundation_code: '${/parameter/@foundation_code}',
                        data_type: 'RECOMMENDED',
                        empty:'Y',
                        error:{
                            foundation_code: '${/parameter/@foundation_code}'
                        }
                    };
                    return error;
                }
                if (Aurora.isEmpty(record) || (record.get('authority_type') == 'LIMIT_PERSONAL_USER' && Aurora.isEmpty(record.get('authority_user')))) {
                    //Aurora.showMessage('${l:PROMPT}', '${l:SYS8120.YOU_PICK_LIMIT_PERSONAL_USER_BUT_NO_CHOOSE_THE_USER}');
                    error = {
                        foundation_code: '${/parameter/@foundation_code}',
                        data_type: 'RECOMMENDED',
                        error_message:  '${l:SYS8120.YOU_PICK_LIMIT_PERSONAL_USER_BUT_NO_CHOOSE_THE_USER}'
                    };
                    //return error;
                }
            
                var datas = {
                    role_id: '${/parameter/@role_id}',
                    business_group: '${/parameter/@business_group}',
                    foundation_code: '${/parameter/@foundation_code}',
                    authority_type: record.get('authority_type'),
                    authority_user: record.get('authority_user'),
                    shield_flag: record.get('shield_flag'),
                    data_type: 'RECOMMENDED',
                    _status: 'update'
                };
                var authority_areas = [];
                if (record.get('authority_type') == 'LIMIT_BUSINESS_AREA') {
                    var at_least_count = 0;
                    for (var i = 1;i <= area_list.length;i++) {
                        if (!Aurora.isEmpty(record.get('checkbox_' + i)) && record.get('checkbox_' + i) != 'NULL') {
                            authority_areas.push(area_list[i - 1].data);
                            authority_areas[authority_areas.length - 1]._status = 'insert';
                            authority_areas[authority_areas.length - 1].role_id = '${/parameter/@role_id}';
                            authority_areas[authority_areas.length - 1].foundation_code = '${/parameter/@foundation_code}';
                            at_least_count++;
                        }
                    }
                    if (at_least_count == 0) {
                        //Aurora.showMessage('${l:PROMPT}', '${l:SYS8120.YOU_PICK_LIMIT_BUSINESS_AREA_AND_SELECT_ONE_AT_LEAST}');
                        error = {
                            foundation_code: '${/parameter/@foundation_code}',
                            error_message: '${l:SYS8120.YOU_PICK_LIMIT_BUSINESS_AREA_AND_SELECT_ONE_AT_LEAST}'
                        };
                        //return error;
                    }
                }
                datas['authority_areas'] = authority_areas;
                datas['error'] = error;
                return datas;
                /* Aurora.request({
                 url: $('sys8120_sys_role_function_save_link').getUrl(),
                 para: datas,
                 success: function() {
                 Aurora.showMessage('${l:PROMPT}', '${l:PROMPT.SAVE_SUCCESS}');
                 },
                 failure: function() {},
                 error: function() {},
                 scope: this
                 }); */
            }
            
            function sys8210_saveRoleAuthority2() {
                var area_list = $('sys8120_authority_area_list_for_potential_ds').getAll();
                var record = $('sys8120_fnd_bg_role_authority_ds2').getCurrentRecord();
                var error = {};
                if (Aurora.isEmpty(record) || Aurora.isEmpty(record.get('authority_type'))) {
                    //Aurora.showMessage('${l:PROMPT}', '${l:SYS8120.PLEASE_CHOOSE_AUTHORITY_TYPE}');
                    error = {
                        foundation_code: '${/parameter/@foundation_code}',
                        data_type: 'POTENTIAL',
                        empty:'Y',
                        error:{
                            foundation_code: '${/parameter/@foundation_code}'
                        }
                    };
                    return error;
                }
                if (Aurora.isEmpty(record) || (record.get('authority_type') == 'LIMIT_PERSONAL_USER' && Aurora.isEmpty(record.get('authority_user')))) {
                    //Aurora.showMessage('${l:PROMPT}', '${l:SYS8120.YOU_PICK_LIMIT_PERSONAL_USER_BUT_NO_CHOOSE_THE_USER}');
                    error = {
                        foundation_code: '${/parameter/@foundation_code}',
                        data_type: 'POTENTIAL',
                        error_message:  '${l:SYS8120.YOU_PICK_LIMIT_PERSONAL_USER_BUT_NO_CHOOSE_THE_USER}'
                    };
                    //return;
                }
            
                var datas = {
                    role_id: '${/parameter/@role_id}',
                    business_group: '${/parameter/@business_group}',
                    foundation_code: '${/parameter/@foundation_code}',
                    authority_type: record.get('authority_type'),
                    authority_user: record.get('authority_user'),
                    shield_flag: record.get('shield_flag'),
                    data_type: 'POTENTIAL',
                    _status: 'update'
                };
                var authority_areas = [];
                if (record.get('authority_type') == 'LIMIT_BUSINESS_AREA') {
                    var at_least_count = 0;
                    for (var i = 1;i <= area_list.length;i++) {
                        if (!Aurora.isEmpty(record.get('checkbox_' + i)) && record.get('checkbox_' + i) != 'NULL') {
                            authority_areas.push(area_list[i - 1].data);
                            authority_areas[authority_areas.length - 1]._status = 'insert';
                            authority_areas[authority_areas.length - 1].role_id = '${/parameter/@role_id}';
                            authority_areas[authority_areas.length - 1].foundation_code = '${/parameter/@foundation_code}';
                            at_least_count++;
                        }
                    }
                    if (at_least_count == 0) {
                        //Aurora.showMessage('${l:PROMPT}', '${l:SYS8120.YOU_PICK_LIMIT_BUSINESS_AREA_AND_SELECT_ONE_AT_LEAST}');
                        error = {
                            foundation_code: '${/parameter/@foundation_code}',
                            error_message:  '${l:SYS8120.YOU_PICK_LIMIT_BUSINESS_AREA_AND_SELECT_ONE_AT_LEAST}'
                        };
                        //return;
                    }
                }
                datas['authority_areas'] = authority_areas;
                datas['error'] = error;
                return datas;
                /* Aurora.request({
                 url: $('sys8120_sys_role_function_save_link').getUrl(),
                 para: datas,
                 success: function() {
                 Aurora.showMessage('${l:PROMPT}', '${l:PROMPT.SAVE_SUCCESS}');
                 },
                 failure: function() {},
                 error: function() {},
                 scope: this
                 }); */
            }
            
            function sys8210_saveRoleAuthority3() {
                var area_list = $('sys8120_authority_area_list_for_qualified_ds').getAll();
                var record = $('sys8120_fnd_bg_role_authority_ds3').getCurrentRecord();
                var error = {};
                if (Aurora.isEmpty(record) || Aurora.isEmpty(record.get('authority_type'))) {
                    //Aurora.showMessage('${l:PROMPT}', '${l:SYS8120.PLEASE_CHOOSE_AUTHORITY_TYPE}');
                    error = {
                        foundation_code: '${/parameter/@foundation_code}',
                        data_type: 'QUALIFIED',
                        empty:'Y',
                        error:{
                            foundation_code: '${/parameter/@foundation_code}'
                        }
                    };
                    return error;
                }
                if (Aurora.isEmpty(record) || (record.get('authority_type') == 'LIMIT_PERSONAL_USER' && Aurora.isEmpty(record.get('authority_user')))) {
                    //Aurora.showMessage('${l:PROMPT}', '${l:SYS8120.YOU_PICK_LIMIT_PERSONAL_USER_BUT_NO_CHOOSE_THE_USER}');
                    error = {
                        foundation_code: '${/parameter/@foundation_code}',
                        data_type: 'QUALIFIED',
                        error_message: '${l:SYS8120.YOU_PICK_LIMIT_PERSONAL_USER_BUT_NO_CHOOSE_THE_USER}'
                    };
                    //return error;
                }
            
                var datas = {
                    role_id: '${/parameter/@role_id}',
                    business_group: '${/parameter/@business_group}',
                    foundation_code: '${/parameter/@foundation_code}',
                    authority_type: record.get('authority_type'),
                    authority_user: record.get('authority_user'),
                    shield_flag: record.get('shield_flag'),
                    data_type: 'QUALIFIED',
                    _status: 'update'
                };
                var authority_areas = [];
                if (record.get('authority_type') == 'LIMIT_BUSINESS_AREA') {
                    var at_least_count = 0;
                    for (var i = 1;i <= area_list.length;i++) {
                        if (!Aurora.isEmpty(record.get('checkbox_' + i)) && record.get('checkbox_' + i) != 'NULL') {
                            authority_areas.push(area_list[i - 1].data);
                            authority_areas[authority_areas.length - 1]._status = 'insert';
                            authority_areas[authority_areas.length - 1].role_id = '${/parameter/@role_id}';
                            authority_areas[authority_areas.length - 1].foundation_code = '${/parameter/@foundation_code}';
                            at_least_count++;
                        }
                    }
                    if (at_least_count == 0) {
                        //Aurora.showMessage('${l:PROMPT}', '${l:SYS8120.YOU_PICK_LIMIT_BUSINESS_AREA_AND_SELECT_ONE_AT_LEAST}');
                        error = {
                            foundation_code: '${/parameter/@foundation_code}',
                            error_message: '${l:SYS8120.YOU_PICK_LIMIT_BUSINESS_AREA_AND_SELECT_ONE_AT_LEAST}'
                        };
                        //return error;
                    }
                }
                datas['authority_areas'] = authority_areas;
                datas['error'] = error;
                return datas;
                /* Aurora.request({
                 url: $('sys8120_sys_role_function_save_link').getUrl(),
                 para: datas,
                 success: function() {
                 Aurora.showMessage('${l:PROMPT}', '${l:PROMPT.SAVE_SUCCESS}');
                 },
                 failure: function() {},
                 error: function() {},
                 scope: this
                 }); */
            }
            
            function sys8210_saveRoleAuthority4() {
                var area_list = $('sys8120_authority_area_list_for_eliminated_ds').getAll();
                var record = $('sys8120_fnd_bg_role_authority_ds4').getCurrentRecord();
                var error = {};
                if (Aurora.isEmpty(record) || Aurora.isEmpty(record.get('authority_type'))) {
                    //Aurora.showMessage('${l:PROMPT}', '${l:SYS8120.PLEASE_CHOOSE_AUTHORITY_TYPE}');
                    error = {
                        foundation_code: '${/parameter/@foundation_code}',
                        data_type: 'ELIMINATED',
                        empty:'Y',
                        error:{
                            foundation_code: '${/parameter/@foundation_code}'
                        }
                    };
                    return error;
                }
                if (Aurora.isEmpty(record) || (record.get('authority_type') == 'LIMIT_PERSONAL_USER' && Aurora.isEmpty(record.get('authority_user')))) {
                    //Aurora.showMessage('${l:PROMPT}', '${l:SYS8120.YOU_PICK_LIMIT_PERSONAL_USER_BUT_NO_CHOOSE_THE_USER}');
                    error = {
                        foundation_code: '${/parameter/@foundation_code}',
                        data_type: 'ELIMINATED',
                        error_message: '${l:SYS8120.YOU_PICK_LIMIT_PERSONAL_USER_BUT_NO_CHOOSE_THE_USER}'
                    };
                    //return error;
                }
            
                var datas = {
                    role_id: '${/parameter/@role_id}',
                    business_group: '${/parameter/@business_group}',
                    foundation_code: '${/parameter/@foundation_code}',
                    authority_type: record.get('authority_type'),
                    authority_user: record.get('authority_user'),
                    shield_flag: record.get('shield_flag'),
                    data_type: 'ELIMINATED',
                    _status: 'update'
                };
                var authority_areas = [];
                if (record.get('authority_type') == 'LIMIT_BUSINESS_AREA') {
                    var at_least_count = 0;
                    for (var i = 1;i <= area_list.length;i++) {
                        if (!Aurora.isEmpty(record.get('checkbox_' + i)) && record.get('checkbox_' + i) != 'NULL') {
                            authority_areas.push(area_list[i - 1].data);
                            authority_areas[authority_areas.length - 1]._status = 'insert';
                            authority_areas[authority_areas.length - 1].role_id = '${/parameter/@role_id}';
                            authority_areas[authority_areas.length - 1].foundation_code = '${/parameter/@foundation_code}';
                            at_least_count++;
                        }
                    }
                    if (at_least_count == 0) {
                        //Aurora.showMessage('${l:PROMPT}', '${l:SYS8120.YOU_PICK_LIMIT_BUSINESS_AREA_AND_SELECT_ONE_AT_LEAST}');
                        error = {
                            foundation_code: '${/parameter/@foundation_code}',
                            error_message: '${l:SYS8120.YOU_PICK_LIMIT_BUSINESS_AREA_AND_SELECT_ONE_AT_LEAST}'
                        };
                        //return error;
                    }
                }
                datas['authority_areas'] = authority_areas;
                datas['error'] = error;
                return datas;
                /* Aurora.request({
                 url: $('sys8120_sys_role_function_save_link').getUrl(),
                 para: datas,
                 success: function() {
                 Aurora.showMessage('${l:PROMPT}', '${l:PROMPT.SAVE_SUCCESS}');
                 },
                 failure: function() {},
                 error: function() {},
                 scope: this
                 }); */
            }
            
            function sys8210_returnToRoleFoundationList() {
                $('sys8120_sys_role_authority_maintain_link_window').close();
            }
        ]]></script>
        <a:dataSets>
            <a:dataSet id="sys8120_authority_area_list_for_registered_ds">
                <a:datas dataSource="/model/authority_area_list_for_registered"/>
            </a:dataSet>
            <a:dataSet id="sys8120_authority_area_list_for_recommended_ds">
                <a:datas dataSource="/model/authority_area_list_for_recommended"/>
            </a:dataSet>
            <a:dataSet id="sys8120_authority_area_list_for_potential_ds">
                <a:datas dataSource="/model/authority_area_list_for_potential"/>
            </a:dataSet>
            <a:dataSet id="sys8120_authority_area_list_for_qualified_ds">
                <a:datas dataSource="/model/authority_area_list_for_qualified"/>
            </a:dataSet>
            <a:dataSet id="sys8120_authority_area_list_for_eliminated_ds">
                <a:datas dataSource="/model/authority_area_list_for_eliminated"/>
            </a:dataSet>
            <a:dataSet id="sys8120_authority_area_select_ds">
                <a:datas dataSource="/model/authority_area_select_by_registered"/>
            </a:dataSet>
            <a:dataSet id="sys8120_authority_area_select_ds1">
                <a:datas dataSource="/model/authority_area_select_by_recommended"/>
            </a:dataSet>
            <a:dataSet id="sys8120_authority_area_select_ds2">
                <a:datas dataSource="/model/authority_area_select_by_potential"/>
            </a:dataSet>
            <a:dataSet id="sys8120_authority_area_select_ds3">
                <a:datas dataSource="/model/authority_area_select_by_qualified"/>
            </a:dataSet>
            <a:dataSet id="sys8120_authority_area_select_ds4">
                <a:datas dataSource="/model/authority_area_select_by_eliminated"/>
            </a:dataSet>
            <a:dataSet id="sys8120_sys_role_bg_foundation_info_ds" loadData="true" model="sys.SYS8120.sys_role_bg_foundation_info"/>
            <a:dataSet id="sys8120_sys_role_bg_foundation_info_ds1" loadData="true" model="sys.SYS8120.sys_role_bg_foundation_info"/>
            <a:dataSet id="sys8120_sys_role_bg_foundation_info_ds2" loadData="true" model="sys.SYS8120.sys_role_bg_foundation_info"/>
            <a:dataSet id="sys8120_sys_role_bg_foundation_info_ds3" loadData="true" model="sys.SYS8120.sys_role_bg_foundation_info"/>
            <a:dataSet id="sys8120_sys_role_bg_foundation_info_ds4" loadData="true" model="sys.SYS8120.sys_role_bg_foundation_info"/>
            <a:dataSet id="sys8120_fnd_bg_role_authority_ds" autoCreate="true">
                <a:datas dataSource="/model/authority_maintain"/>
                <a:fields>
                    <a:placeHolder id="dynamicItemAttributeFields"/>
                    <a:field name="authority_type"/>
                    <a:field name="authority_user" readOnly="true"/>
                    <a:field name="shield_flag" checkedValue="Y" defaultValue="Y" uncheckedValue="N"/>
                    <a:field name="data_type"/>
                </a:fields>
            </a:dataSet>
            <a:dataSet id="sys8120_fnd_bg_role_authority_ds1" autoCreate="true">
                <a:datas dataSource="/model/authority_maintain1"/>
                <a:fields>
                    <a:placeHolder id="dynamicItemAttributeFields1"/>
                    <a:field name="authority_type"/>
                    <a:field name="authority_user" readOnly="true"/>
                    <a:field name="shield_flag" checkedValue="Y" defaultValue="Y" uncheckedValue="N"/>
                    <a:field name="data_type"/>
                </a:fields>
            </a:dataSet>
            <a:dataSet id="sys8120_fnd_bg_role_authority_ds2" autoCreate="true">
                <a:datas dataSource="/model/authority_maintain2"/>
                <a:fields>
                    <a:placeHolder id="dynamicItemAttributeFields2"/>
                    <a:field name="authority_type"/>
                    <a:field name="authority_user" readOnly="true"/>
                    <a:field name="shield_flag" checkedValue="Y" defaultValue="Y" uncheckedValue="N"/>
                    <a:field name="data_type"/>
                </a:fields>
            </a:dataSet>
            <a:dataSet id="sys8120_fnd_bg_role_authority_ds3" autoCreate="true">
                <a:datas dataSource="/model/authority_maintain3"/>
                <a:fields>
                    <a:placeHolder id="dynamicItemAttributeFields3"/>
                    <a:field name="authority_type"/>
                    <a:field name="authority_user" readOnly="true"/>
                    <a:field name="shield_flag" checkedValue="Y" defaultValue="Y" uncheckedValue="N"/>
                    <a:field name="data_type"/>
                </a:fields>
            </a:dataSet>
            <a:dataSet id="sys8120_fnd_bg_role_authority_ds4" autoCreate="true">
                <a:datas dataSource="/model/authority_maintain4"/>
                <a:fields>
                    <a:placeHolder id="dynamicItemAttributeFields4"/>
                    <a:field name="authority_type"/>
                    <a:field name="authority_user" readOnly="true"/>
                    <a:field name="shield_flag" checkedValue="Y" defaultValue="Y" uncheckedValue="N"/>
                    <a:field name="data_type"/>
                </a:fields>
            </a:dataSet>
            <a:dataSet id="sys8120_label_ds" autoCreate="true">
                <a:fields>
                    <a:field name="label0" defaultValue="${l:SYS_ROLE_AUTHORITY_MAINTAIN.NOTES}"/>
                    <a:field name="label1" defaultValue="${l:SYS_ROLE_AUTHORITY_MAINTAIN.LABEL_1}"/>
                    <a:field name="label2" defaultValue="${l:SYS_ROLE_AUTHORITY_MAINTAIN.LABEL_2}"/>
                </a:fields>
            </a:dataSet>
        </a:dataSets>
        <a:screenBody>
            <a:tabPanel height="468" width="552">
                <a:tabs>
                    <a:tab id="sys8120_register" prompt="PUR_VENDORS.REGISTERED">
                        <!-- <a:screenTopToolbar>
                            <a:toolbarButton click="sys8210_saveRoleAuthority" text="PROMPT.SAVE" width="100"/>
                            <a:toolbarButton click="sys8210_returnToRoleFoundationList" text="HAP_BACK" width="100"/>
                        </a:screenTopToolbar> -->
                        <!-- <a:form title="PROMPT.BASIC_INFOMATION" width="550">
                            <a:hBox>
                                <a:label name="role_name" bindTarget="sys8120_sys_role_bg_foundation_info_ds" prompt="SYS_ROLE.ROLE_NAME" width="150"/>
                                <a:label name="foundation_name" bindTarget="sys8120_sys_role_bg_foundation_info_ds" prompt="SYS8120.DOCUMENT_NAME" width="200"/>
                            </a:hBox>
                            <a:hBox>
                                <a:label name="business_group_name" bindTarget="sys8120_sys_role_bg_foundation_info_ds" prompt="GROUP_NAME" width="300"/>
                            </a:hBox>
                        </a:form> -->
                        <a:form title="SYS8120.AUTHORITY_TYPE" width="550">
                            <a:hBox>
                                <a:radio name="authority_type" bindTarget="sys8120_fnd_bg_role_authority_ds" labelField="code_value_name" layout="horizontal" options="/model/authority_type_list" valueField="code_value" width="400">
                                    <a:events>
                                        <a:event name="change" handler="sys8129_onAuthorityTypeChange"/>
                                    </a:events>
                                </a:radio>
                            </a:hBox>
                        </a:form>
                        <a:form title="SYS8120.BUSINESS_AREA" width="550">
                            <a:hBox padding="0">
                                <a:vBox>
                                    <a:placeHolder id="dynamicItemAttribute"/>
                                </a:vBox>
                                <a:vBox width="65"/>
                                <a:vBox>
                                    <a:radio name="authority_user" bindTarget="sys8120_fnd_bg_role_authority_ds" labelField="code_value_name" layout="horizontal" options="/model/authority_user_list" valueField="code_value" width="150"/>
                                </a:vBox>
                            </a:hBox>
                        </a:form>
                    </a:tab>
                    <a:tab id="sys8120_recommended" prompt="PUR_VENDORS.RECOMMENDED">
                        <!-- <a:screenTopToolbar>
                            <a:toolbarButton click="sys8210_saveRoleAuthority1" text="PROMPT.SAVE" width="100"/>
                            <a:toolbarButton click="sys8210_returnToRoleFoundationList" text="HAP_BACK" width="100"/>
                        </a:screenTopToolbar> -->
                        <!-- <a:form title="PROMPT.BASIC_INFOMATION" width="550">
                            <a:hBox>
                                <a:label name="role_name" bindTarget="sys8120_sys_role_bg_foundation_info_ds1" prompt="SYS_ROLE.ROLE_NAME" width="150"/>
                                <a:label name="foundation_name" bindTarget="sys8120_sys_role_bg_foundation_info_ds1" prompt="SYS8120.DOCUMENT_NAME" width="200"/>
                            </a:hBox>
                            <a:hBox>
                                <a:label name="business_group_name" bindTarget="sys8120_sys_role_bg_foundation_info_ds1" prompt="GROUP_NAME" width="300"/>
                            </a:hBox>
                        </a:form> -->
                        <a:form title="SYS8120.AUTHORITY_TYPE" width="550">
                            <a:hBox>
                                <a:radio name="authority_type" bindTarget="sys8120_fnd_bg_role_authority_ds1" labelField="code_value_name" layout="horizontal" options="/model/authority_type_list1" valueField="code_value" width="400">
                                    <a:events>
                                        <a:event name="change" handler="sys8129_onAuthorityTypeChange1"/>
                                    </a:events>
                                </a:radio>
                            </a:hBox>
                        </a:form>
                        <a:form title="SYS8120.BUSINESS_AREA" width="550">
                            <a:hBox padding="0">
                                <a:vBox>
                                    <a:placeHolder id="dynamicItemAttribute1"/>
                                </a:vBox>
                                <a:vBox width="65"/>
                                <a:vBox>
                                    <a:radio name="authority_user" bindTarget="sys8120_fnd_bg_role_authority_ds1" labelField="code_value_name" layout="horizontal" options="/model/authority_user_list1" valueField="code_value" width="150"/>
                                </a:vBox>
                            </a:hBox>
                        </a:form>
                    </a:tab>
                    <a:tab id="sys8120_potential" prompt="PUR_VENDORS.POTENTIAL">
                        <!-- <a:screenTopToolbar>
                            <a:toolbarButton click="sys8210_saveRoleAuthority2" text="PROMPT.SAVE" width="100"/>
                            <a:toolbarButton click="sys8210_returnToRoleFoundationList" text="HAP_BACK" width="100"/>
                        </a:screenTopToolbar> -->
                        <!-- <a:form title="PROMPT.BASIC_INFOMATION" width="550">
                            <a:hBox>
                                <a:label name="role_name" bindTarget="sys8120_sys_role_bg_foundation_info_ds2" prompt="SYS_ROLE.ROLE_NAME" width="150"/>
                                <a:label name="foundation_name" bindTarget="sys8120_sys_role_bg_foundation_info_ds2" prompt="SYS8120.DOCUMENT_NAME" width="200"/>
                            </a:hBox>
                            <a:hBox>
                                <a:label name="business_group_name" bindTarget="sys8120_sys_role_bg_foundation_info_ds2" prompt="GROUP_NAME" width="300"/>
                            </a:hBox>
                        </a:form> -->
                        <a:form title="SYS8120.AUTHORITY_TYPE" width="550">
                            <a:hBox>
                                <a:radio name="authority_type" bindTarget="sys8120_fnd_bg_role_authority_ds2" labelField="code_value_name" layout="horizontal" options="/model/authority_type_list2" valueField="code_value" width="400">
                                    <a:events>
                                        <a:event name="change" handler="sys8129_onAuthorityTypeChange2"/>
                                    </a:events>
                                </a:radio>
                            </a:hBox>
                        </a:form>
                        <a:form title="SYS8120.BUSINESS_AREA" width="550">
                            <a:hBox padding="0">
                                <a:vBox>
                                    <a:placeHolder id="dynamicItemAttribute2"/>
                                </a:vBox>
                                <a:vBox width="65"/>
                                <a:vBox>
                                    <a:radio name="authority_user" bindTarget="sys8120_fnd_bg_role_authority_ds2" labelField="code_value_name" layout="horizontal" options="/model/authority_user_list2" valueField="code_value" width="150"/>
                                </a:vBox>
                            </a:hBox>
                        </a:form>
                    </a:tab>
                    <a:tab id="sys8120_qualified" prompt="PUR_VENDORS.QUALIFIED">
                        <!-- <a:screenTopToolbar>
                            <a:toolbarButton click="sys8210_saveRoleAuthority3" text="PROMPT.SAVE" width="100"/>
                            <a:toolbarButton click="sys8210_returnToRoleFoundationList" text="HAP_BACK" width="100"/>
                        </a:screenTopToolbar> -->
                        <!-- <a:form title="PROMPT.BASIC_INFOMATION" width="550">
                            <a:hBox>
                                <a:label name="role_name" bindTarget="sys8120_sys_role_bg_foundation_info_ds3" prompt="SYS_ROLE.ROLE_NAME" width="150"/>
                                <a:label name="foundation_name" bindTarget="sys8120_sys_role_bg_foundation_info_ds3" prompt="SYS8120.DOCUMENT_NAME" width="200"/>
                            </a:hBox>
                            <a:hBox>
                                <a:label name="business_group_name" bindTarget="sys8120_sys_role_bg_foundation_info_ds3" prompt="GROUP_NAME" width="300"/>
                            </a:hBox>
                        </a:form> -->
                        <a:form title="SYS8120.AUTHORITY_TYPE" width="550">
                            <a:hBox>
                                <a:radio name="authority_type" bindTarget="sys8120_fnd_bg_role_authority_ds3" labelField="code_value_name" layout="horizontal" options="/model/authority_type_list3" valueField="code_value" width="400">
                                    <a:events>
                                        <a:event name="change" handler="sys8129_onAuthorityTypeChange3"/>
                                    </a:events>
                                </a:radio>
                            </a:hBox>
                        </a:form>
                        <a:form title="SYS8120.BUSINESS_AREA" width="550">
                            <a:hBox padding="0">
                                <a:vBox>
                                    <a:placeHolder id="dynamicItemAttribute3"/>
                                </a:vBox>
                                <a:vBox width="65"/>
                                <a:vBox>
                                    <a:radio name="authority_user" bindTarget="sys8120_fnd_bg_role_authority_ds3" labelField="code_value_name" layout="horizontal" options="/model/authority_user_list3" valueField="code_value" width="150"/>
                                </a:vBox>
                            </a:hBox>
                        </a:form>
                    </a:tab>
                    <a:tab id="sys8120_eliminated" prompt="淘汰">
                        <a:form title="SYS8120.AUTHORITY_TYPE" width="550">
                            <a:hBox>
                                <a:radio name="authority_type" bindTarget="sys8120_fnd_bg_role_authority_ds4" labelField="code_value_name" layout="horizontal" options="/model/authority_type_list4" valueField="code_value" width="400">
                                    <a:events>
                                        <a:event name="change" handler="sys8129_onAuthorityTypeChange4"/>
                                    </a:events>
                                </a:radio>
                            </a:hBox>
                        </a:form>
                        <a:form title="SYS8120.BUSINESS_AREA" width="550">
                            <a:hBox padding="0">
                                <a:vBox>
                                    <a:placeHolder id="dynamicItemAttribute4"/>
                                </a:vBox>
                                <a:vBox width="65"/>
                                <a:vBox>
                                    <a:radio name="authority_user" bindTarget="sys8120_fnd_bg_role_authority_ds4" labelField="code_value_name" layout="horizontal" options="/model/authority_user_list4" valueField="code_value" width="150"/>
                                </a:vBox>
                            </a:hBox>
                        </a:form>
                    </a:tab>
                </a:tabs>
            </a:tabPanel>
            <a:vBox padding="0">
                <a:label name="label0" bindTarget="sys8120_label_ds" style="margin-left:10px;" width="500"/>
                <a:label name="label1" bindTarget="sys8120_label_ds" style="margin-left:10px;" width="500"/>
                <a:label name="label2" bindTarget="sys8120_label_ds" style="margin-left:10px;" width="500"/>
            </a:vBox>
        </a:screenBody>
        <script><![CDATA[
            Aurora.onReady(function() {
                //初始化data
                window.parent.sys8120_iframe_inDataInit('${/parameter/@foundation_code}');
                
                var area_list = $('sys8120_authority_area_list_for_registered_ds').getAll();
                var select_list = $('sys8120_authority_area_select_ds').getAll();
                var record = $('sys8120_fnd_bg_role_authority_ds').getCurrentRecord();
                if(record.get('authority_type') == 'LIMIT_PERSONAL_USER'){
                    record.getField('authority_user').setReadOnly(false);
                    for (var k = 1;k <= area_list.length;k++) {
                        record.set('checkbox_' + k,'NULL');
                        record.getField('checkbox_' + k).setReadOnly(true);
                    }
                }else if (record.get('authority_type') == 'LIMIT_BUSINESS_AREA') {
                    record.getField('authority_user').setReadOnly(true);
                    for (var i = 1;i <= area_list.length;i++) {
                        record.getField('checkbox_' + i).setReadOnly(false);
                        for (var j = 0;j < select_list.length;j++) {
                            if (record.getField('checkbox_' + i).snap.checkedvalue == select_list[j].get('authority_type_code')) {
                                record.set('checkbox_' + i, select_list[j].get('authority_type_code'));
                            }
                        }
                    }
                }
                
                var area_list1 = $('sys8120_authority_area_list_for_recommended_ds').getAll();
                var select_list1 = $('sys8120_authority_area_select_ds1').getAll();
                var record1 = $('sys8120_fnd_bg_role_authority_ds1').getCurrentRecord();
                if(record1.get('authority_type') == 'LIMIT_PERSONAL_USER'){
                    record1.getField('authority_user').setReadOnly(false);
                    for (var k = 1;k <= area_list1.length;k++) {
                        record1.set('checkbox_' + k,'NULL');
                        record1.getField('checkbox_' + k).setReadOnly(true);
                    }
                }else if (record1.get('authority_type') == 'LIMIT_BUSINESS_AREA') {
                    record1.getField('authority_user').setReadOnly(true);
                    for (var i = 1;i <= area_list1.length;i++) {
                        record1.getField('checkbox_' + i).setReadOnly(false);
                        for (var j = 0;j < select_list1.length;j++) {
                            if (record1.getField('checkbox_' + i).snap.checkedvalue == select_list1[j].get('authority_type_code')) {
                                record1.set('checkbox_' + i, select_list1[j].get('authority_type_code'));
                            }
                        }
                    }
                }
                
                var area_list2 = $('sys8120_authority_area_list_for_potential_ds').getAll();
                var select_list2 = $('sys8120_authority_area_select_ds2').getAll();
                var record2 = $('sys8120_fnd_bg_role_authority_ds2').getCurrentRecord();
                if(record2.get('authority_type') == 'LIMIT_PERSONAL_USER'){
                    record2.getField('authority_user').setReadOnly(false);
                    for (var k = 1;k <= area_list2.length;k++) {
                        record2.set('checkbox_' + k,'NULL');
                        record2.getField('checkbox_' + k).setReadOnly(true);
                    }
                }else if (record2.get('authority_type') == 'LIMIT_BUSINESS_AREA') {
                    record2.getField('authority_user').setReadOnly(true);
                    for (var i = 1;i <= area_list2.length;i++) {
                        record2.getField('checkbox_' + i).setReadOnly(false);
                        for (var j = 0;j < select_list2.length;j++) {
                            if (record2.getField('checkbox_' + i).snap.checkedvalue == select_list2[j].get('authority_type_code')) {
                                record2.set('checkbox_' + i, select_list2[j].get('authority_type_code'));
                            }
                        }
                    }
                }
                
                var area_list3 = $('sys8120_authority_area_list_for_qualified_ds').getAll();
                var select_list3 = $('sys8120_authority_area_select_ds3').getAll();
                var record3 = $('sys8120_fnd_bg_role_authority_ds3').getCurrentRecord();
                if(record3.get('authority_type') == 'LIMIT_PERSONAL_USER'){
                    record3.getField('authority_user').setReadOnly(false);
                    for (var k = 1;k <= area_list3.length;k++) {
                        record3.set('checkbox_' + k,'NULL');
                        record3.getField('checkbox_' + k).setReadOnly(true);
                    }
                }else if (record3.get('authority_type') == 'LIMIT_BUSINESS_AREA') {
                    record3.getField('authority_user').setReadOnly(true);
                    for (var i = 1;i <= area_list3.length;i++) {
                        record3.getField('checkbox_' + i).setReadOnly(false);
                        for (var j = 0;j < select_list3.length;j++) {
                            if (record3.getField('checkbox_' + i).snap.checkedvalue == select_list3[j].get('authority_type_code')) {
                                record3.set('checkbox_' + i, select_list3[j].get('authority_type_code'));
                            }
                        }
                    }
                }
                
                var area_list4 = $('sys8120_authority_area_list_for_eliminated_ds').getAll();
                var select_list4 = $('sys8120_authority_area_select_ds4').getAll();
                var record4 = $('sys8120_fnd_bg_role_authority_ds4').getCurrentRecord();
                if(record4.get('authority_type') == 'LIMIT_PERSONAL_USER'){
                    record4.getField('authority_user').setReadOnly(false);
                    for (var k = 1;k <= area_list4.length;k++) {
                        record4.set('checkbox_' + k,'NULL');
                        record4.getField('checkbox_' + k).setReadOnly(true);
                    }
                }else if (record4.get('authority_type') == 'LIMIT_BUSINESS_AREA') {
                    record4.getField('authority_user').setReadOnly(true);
                    for (var i = 1;i <= area_list4.length;i++) {
                        record4.getField('checkbox_' + i).setReadOnly(false);
                        for (var j = 0;j < select_list4.length;j++) {
                            if (record4.getField('checkbox_' + i).snap.checkedvalue == select_list4[j].get('authority_type_code')) {
                                record4.set('checkbox_' + i, select_list4[j].get('authority_type_code'));
                            }
                        }
                    }
                }
            });
        ]]></script>
    </a:view>
    <a:view-config>
        <c:create-config targetId="dynamicItemAttributeFields">
            <p:loop source="/model/authority_area_list_for_registered">
                <c:process-config>
                    <a:field name="checkbox_${@line_num}" checkedValue="${@authority_type_code}" defaultValue="NULL" readOnly="true" uncheckedValue="NULL"/>
                </c:process-config>
            </p:loop>
        </c:create-config>
        <c:create-config targetId="dynamicItemAttributeFields1">
            <p:loop source="/model/authority_area_list_for_recommended">
                <c:process-config>
                    <a:field name="checkbox_${@line_num}" checkedValue="${@authority_type_code}" defaultValue="NULL" readOnly="true" uncheckedValue="NULL"/>
                </c:process-config>
            </p:loop>
        </c:create-config>
        <c:create-config targetId="dynamicItemAttributeFields2">
            <p:loop source="/model/authority_area_list_for_potential">
                <c:process-config>
                    <a:field name="checkbox_${@line_num}" checkedValue="${@authority_type_code}" defaultValue="NULL" readOnly="true" uncheckedValue="NULL"/>
                </c:process-config>
            </p:loop>
        </c:create-config>
        <c:create-config targetId="dynamicItemAttributeFields3">
            <p:loop source="/model/authority_area_list_for_qualified">
                <c:process-config>
                    <a:field name="checkbox_${@line_num}" checkedValue="${@authority_type_code}" defaultValue="NULL" readOnly="true" uncheckedValue="NULL"/>
                </c:process-config>
            </p:loop>
        </c:create-config>
        <c:create-config targetId="dynamicItemAttributeFields4">
            <p:loop source="/model/authority_area_list_for_eliminated">
                <c:process-config>
                    <a:field name="checkbox_${@line_num}" checkedValue="${@authority_type_code}" defaultValue="NULL" readOnly="true" uncheckedValue="NULL"/>
                </c:process-config>
            </p:loop>
        </c:create-config>
        <c:create-config targetId="dynamicItemAttribute">
            <p:loop source="/model/authority_area_list_for_registered">
                <c:process-config>
                    <a:checkBox name="checkbox_${@line_num}" bindTarget="sys8120_fnd_bg_role_authority_ds" label="${@authority_type_name}" style="margin-left:12px;" width="100"/>
                </c:process-config>
            </p:loop>
        </c:create-config>
        <c:create-config targetId="dynamicItemAttribute1">
            <p:loop source="/model/authority_area_list_for_recommended">
                <c:process-config>
                    <a:checkBox name="checkbox_${@line_num}" bindTarget="sys8120_fnd_bg_role_authority_ds1" label="${@authority_type_name}" style="margin-left:12px;" width="100"/>
                </c:process-config>
            </p:loop>
        </c:create-config>
        <c:create-config targetId="dynamicItemAttribute2">
            <p:loop source="/model/authority_area_list_for_potential">
                <c:process-config>
                    <a:checkBox name="checkbox_${@line_num}" bindTarget="sys8120_fnd_bg_role_authority_ds2" label="${@authority_type_name}" style="margin-left:12px;" width="100"/>
                </c:process-config>
            </p:loop>
        </c:create-config>
        <c:create-config targetId="dynamicItemAttribute3">
            <p:loop source="/model/authority_area_list_for_qualified">
                <c:process-config>
                    <a:checkBox name="checkbox_${@line_num}" bindTarget="sys8120_fnd_bg_role_authority_ds3" label="${@authority_type_name}" style="margin-left:12px;" width="100"/>
                </c:process-config>
            </p:loop>
        </c:create-config>
        <c:create-config targetId="dynamicItemAttribute4">
            <p:loop source="/model/authority_area_list_for_eliminated">
                <c:process-config>
                    <a:checkBox name="checkbox_${@line_num}" bindTarget="sys8120_fnd_bg_role_authority_ds4" label="${@authority_type_name}" style="margin-left:12px;" width="100"/>
                </c:process-config>
            </p:loop>
        </c:create-config>
    </a:view-config>
</a:screen>
