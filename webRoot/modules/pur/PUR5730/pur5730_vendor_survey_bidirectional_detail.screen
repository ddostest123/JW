<?xml version="1.0" encoding="UTF-8"?>
<!--
    $Author: lianghuihao 
    $Date: 2018-8-9 下午9:36:54  
    $Revision: 1.0  
    $Purpose: 
-->
<a:screen xmlns:a="http://www.aurora-framework.org/application" trace="true">
    <a:init-procedure>
        <a:model-query defaultWhereClause="survey_header_id=${/parameter/@survey_header_id}" model="pur.PUR5730.pur5730_vendor_survey_atm_load" rootPath="pur5730_vendor_survey_atm"/>
        <a:model-query model="pur.PUR7210.pur7210_vendor_survey_tabs" rootPath="pur5730_vendor_survey_tabs"/>
        <a:model-query model="pur.PUR7210.pur7210_vendor_survey_require" rootPath="pur5730_vendor_survey_require"/>
        <a:model-query defaultWhereClause="flex_value_set_code = &apos;FND_INDUSTRY_RANKS&apos;" fetchAll="true" model="public.fnd_flex_value_v_lov" rootPath="pur5730_manufacturer_industry_rank"/>
        <a:model-query defaultWhereClause="flex_value_set_code = &apos;FND_CERTIFICATION&apos;" fetchAll="true" model="public.fnd_flex_value_v_lov" rootPath="pur5730_manufacturer_certification"/>
        <a:model-query defaultWhereClause="flex_value_set_code = &apos;FND_DEVICE_TYPE&apos;" fetchAll="true" model="public.fnd_flex_value_v_lov" rootPath="pur5730_manufacturer_device_type"/>
        <a:model-query defaultWhereClause="flex_value_set_code = &apos;FND_CUSTOMER_SATISFACTION&apos;" fetchAll="true" model="public.fnd_flex_value_v_lov" rootPath="pur5730_manufacturer_satisfaction"/>
        <a:model-query defaultWhereClause="flex_value_set_code = &apos;FND_COOPERATION_FREQUENCY&apos;" fetchAll="true" model="public.fnd_flex_value_v_lov" rootPath="pur5730_manufacturer_cooperation_frequency"/>
        <a:model-query defaultWhereClause="flex_value_set_code = &apos;PUR_QUESTIONARY_ATM_TYPE_CODE&apos;" fetchAll="true" model="public.fnd_flex_value_v_lov" rootPath="pur5730_attachment_type"/>
    </a:init-procedure>
    <a:view>
        <a:link id="pur5730_vendor_survey_manufacturer_contact_tab_save_link" url="${/request/@context_path}/modules/pur/PUR5730/pur5730_vendor_survey_contact_save.svc"/>
        <a:link id="pur5730_survey_manufacturer_submit_link" model="pur.PUR5730.pur5730_vendor_survey_query" modelaction="execute"/>
        <a:link id="pur5730_attachment_file_query_link" url="${/request/@context_path}/modules/pur/PUR5730/pur5730_queryFile.screen"/>
        <a:link id="pur5730_attachment_file_upload_link" url="${/request/@context_path}/modules/pur/PUR5730/pur5730_uploadFile.screen"/>
        <a:link id="pur5730_vendorSurveyAccountSave_link" url="${/request/@context_path}/modules/pur/PUR5730/pur_5730_vendor_survey_account_save.svc"/>
        <a:link id="pur5730_vendor_survey_manu_atm_link" model="pur.PUR5730.pur5730_vendor_survey_atm_query" modelaction="query"/>
        <script><![CDATA[
            function pur5730_detail_manufacturer_returnFun() {
                if ($('pur5730_vendor_survey_detail_win')) {
                    $('pur5730_vendor_survey_detail_win').close();
                } else {
                    window.close();
                }
            
            }
            
            function check_require_ds_is_empty() {
                if ($('pur5730_vendor_survey_require_ds').getAll().length > 0) {
                    return false;
                } else {
                    return true;
                }
            }
            
            function set_required(record, name, value) {
                if (value == 'Y') {
                    record.getField(name).setRequired(true);
                }
            }
            
            function pur5730_vendor_survey_basic_info_ds_loadFun(dataSet) {
                if (dataSet.getAll().length == 0) {
                    dataSet.create();
                }
            
                //获取是否必输的配置
                if (!check_require_ds_is_empty()) {
                    var require_record = $('pur5730_vendor_survey_require_ds').getAt(0);
                    var set_record = dataSet.getAt(0);
                    set_required(set_record, 'business_leader', require_record.get('basic_business_leader'));
                    set_required(set_record, 'document_num', require_record.get('basic_document_num'));
                    set_required(set_record, 'stock_code', require_record.get('basic_stock_code'));
                    set_required(set_record, 'la_material_num', require_record.get('basic_la_material_num'));
                    set_required(set_record, 'la_material_size', require_record.get('basic_la_material_size'));
                    set_required(set_record, 'top_customer1', require_record.get('basic_top_customer1'));
                    set_required(set_record, 'top_customer2', require_record.get('basic_top_customer2'));
                    set_required(set_record, 'top_customer3', require_record.get('basic_top_customer3'));
                    set_required(set_record, 'top_customer4', require_record.get('basic_top_customer4'));
                    set_required(set_record, 'top_customer5', require_record.get('basic_top_customer5'));
                    set_required(set_record, 'exception_description', require_record.get('basic_exception_description'));
                    set_required(set_record, 'you_annual_profit', require_record.get('basic_you_annual_profit'));
                    set_required(set_record, 'you_annual_sales', require_record.get('basic_you_annual_sales'));
                    set_required(set_record, 'our_product_profit', require_record.get('basic_our_product_profit'));
                    set_required(set_record, 'our_annual_sales', require_record.get('basic_our_annual_sales'));
                    set_required(set_record, 'our_profit_range', require_record.get('basic_our_profit_range'));
                    set_required(set_record, 'our_annual_sales_ratio', require_record.get('basic_our_annual_sales_ratio'));
                    set_required(set_record, 'our_rank', require_record.get('basic_our_rank'));
                    set_required(set_record, 'c_attribute45', require_record.get('basic_c_attribute45'));
                    set_required(set_record, 'c_attribute46', require_record.get('basic_c_attribute46'));
                    set_required(set_record, 'c_attribute47', require_record.get('basic_c_attribute47'));
                    set_required(set_record, 'c_attribute48', require_record.get('basic_c_attribute48'));
                    set_required(set_record, 'c_attribute49', require_record.get('basic_c_attribute49'));
                    set_required(set_record, 'c_attribute50', require_record.get('basic_c_attribute50'));
                    set_required(set_record, 'prediction_comments', require_record.get('basic_prediction_comments'));
                    set_required(set_record, 'expect_comments', require_record.get('basic_expect_comments'));
                    set_required(set_record, 'assist_comments', require_record.get('basic_assist_comments'));
                    set_required(set_record, 'extended_site', require_record.get('basic_extended_site'));
                    set_required(set_record, 'extended_time', require_record.get('basic_extended_time'));
                    set_required(set_record, 'monthly_capacity', require_record.get('basic_monthly_capacity'));
            
                }
            }
            
            function pur5730_vendor_survey_equipment_rendererFun(value, record, name) {
                var survey_header_id = record.get('survey_header_id');
            
                if (name == 'sale_situation') {
                    return '<a style="color:blue" href="javascript:pur5730_vendor_survey_equipment_uploadFun(' + survey_header_id + ')">${l:ATM.UPLOAD_ATTACHMENT}</a>';
            
                }
                if (name == 'stock_right') {
                    return '<a style="color:blue" href="javascript:pur5730_vendor_survey_manufacturer_stock_uploadFun(' + survey_header_id + ')">${l:ATM.UPLOAD_ATTACHMENT}</a>';
                }
                if (name == 'employment_qualifications') {
                    return '<a style="color:blue" href="javascript:employment_qualifications_uploadFun(' + survey_header_id + ')">${l:ATM.UPLOAD_ATTACHMENT}</a>';
                }
            }
            
            function employment_qualifications_uploadFun(id) {
                var url = "${/request/@context_path}/modules/pur/PUR5730/pur5730_uploadFile.screen?table_name=PUR_VENDOR_SURVEY_BASIC_INFO_QUA&pkvalue=" + id;
                new Aurora.Window({
                    url: url,
                    title: '${l:VENDOR_SURVEY_TAB.EMPLOYMENT_QUALIFICATIONS}',
                    id: 'employment_qualifications_upload_window',
                    width: 500,
                    height: 500
                });
            }
            
            function pur5730_vendor_survey_equipment_uploadFun(id) {
                new Aurora.Window({
                    id: 'pur5730_attachment_file_upload_link_window',
                    title: '${l:ATM.UPLOAD_ATTACHMENT}',
                    url: $('pur5730_attachment_file_upload_link').getUrl() + '?pkvalue=' + id + '&table_name=PUR_VENDOR_SURVEY_BASIC_INFO_SA',
                    width: 610,
                    height: 500
                }).on('close', function() {
                    Aurora.request({
                        url: $('pur5730_vendor_survey_manu_atm_link').getUrl(),
                        para: {
                            'survey_header_id': id,
                            'table_name': 'PUR_VENDOR_SURVEY_BASIC_INFO_SA'
                        },
                        success: function(res) {
                            if (res.result.record.count == 0) {
                                document.getElementById('pur5730_vendor_survey_equipment_uploadBtu_img').style.visibility = "hidden";
                            } else {
                                document.getElementById('pur5730_vendor_survey_equipment_uploadBtu_img').style.visibility = "visible";
                            }
                        },
                        scope: this
                    });
                });
            }
            
            function pur5730_vendor_survey_manufacturer_stock_uploadFun(id) {
                new Aurora.Window({
                    id: 'pur5730_attachment_file_upload_link_window',
                    title: '${l:ATM.UPLOAD_ATTACHMENT}',
                    url: $('pur5730_attachment_file_upload_link').getUrl() + '?pkvalue=' + id + '&table_name=PUR_VENDOR_SURVEY_BASIC_INFO_STOCK',
                    width: 610,
                    height: 500
                }).on('close', function() {
                    Aurora.request({
                        url: $('pur5730_vendor_survey_manu_atm_link').getUrl(),
                        para: {
                            'survey_header_id': id,
                            'table_name': 'PUR_VENDOR_SURVEY_BASIC_INFO_STOCK'
                        },
                        success: function(res) {
                            if (res.result.record.count == 0) {
                                document.getElementById('pur5730_vendor_survey_manufacturer_bond_uploadBtu_img').style.visibility = "hidden";
                            } else {
                                document.getElementById('pur5730_vendor_survey_manufacturer_bond_uploadBtu_img').style.visibility = "visible";
                            }
                        },
                        scope: this
                    });
                });
            }
            
            
            
            function pur5730_vendor_survey_equipment_business_tab_ds_submitsuccessFun() {
                $('pur5730_vendor_survey_equipment_business_tab_ds').query();
            }
            
            
            
            function pur5730_vendor_survey_manufacturer_account_tab_ds_update(ds, record, name, value) {
                if (name == 'c_attribute1') {
                    record.set(name, value.replace(/\s+/g, ""));
                }
            }
            
            
            
            
            
            function pur5730_vendor_survey_bidirectional_capacity_tab_ds_submitsuccessFun() {
                $('pur5730_vendor_survey_bidirectional_capacity_tab_ds').query();
            
            }
            
            function pur5730_vendor_survey_bidirectional_dismantl_tab_ds_submitsuccessFun() {
                $('pur5730_vendor_survey_bidirectional_dismantl_tab_ds').query();
            
            }
            
            function pur5730_vendor_survey_bidirectional_suppliers_information_tab_ds_submitsuccessFun() {
                $('pur5730_vendor_survey_bidirectional_suppliers_information_tab_ds').query();
            
            }
            
            function pur5730_vendor_survey_bidirectional_vendors_information_tab_ds_submitsuccessFun() {
                $('pur5730_vendor_survey_bidirectional_vendors_information_tab_ds').query();
            }
            
            function pur5730_vendor_survey_bidirectional_main_business_tab_ds_submitsuccessFun() {
                $('pur5730_vendor_survey_bidirectional_main_business_tab_ds').query();
            }
            
            function pur5730_vendor_survey_bidirectional_operating_income_tab_ds_submitsuccessFun() {
                $('pur5730_vendor_survey_bidirectional_operating_income_tab_ds').query();
            }
            
            function pur5730_vendor_survey_bidirectional_main_production_tab_ds_submitsuccessFun() {
                $('pur5730_vendor_survey_bidirectional_main_production_tab_ds').query();
            }
            //校验是否有必输数据未填写
            
            function check_validate() {
                if (!$('pur5730_vendor_survey_basic_info_tab_ds').validate()) {
                    $('vendor_survey_bidirectional_tabPanel_id').selectTab(0);
                    return '';
                }
                if (!$('pur5730_vendor_survey_bidirectional_capacity_tab_ds').validate()) {
                    $('vendor_survey_bidirectional_tabPanel_id').selectTab(1);
                    return '';
                }
                if (!$('pur5730_vendor_survey_bidirectional_dismantl_tab_ds').validate()) {
                    $('vendor_survey_bidirectional_tabPanel_id').selectTab(2);
                    return '';
                }
                if (!$('pur5730_vendor_survey_bidirectional_vendors_information_tab_ds').validate()) {
                    $('vendor_survey_bidirectional_tabPanel_id').selectTab(3);
                    return '';
                }
                if (!$('pur5730_vendor_survey_bidirectional_suppliers_information_tab_ds').validate()) {
                    $('vendor_survey_bidirectional_tabPanel_id').selectTab(4);
                    return '';
                }
                if (!$('pur5730_vendor_survey_bidirectional_main_business_tab_ds').validate()) {
                    $('vendor_survey_bidirectional_tabPanel_id').selectTab(5);
                    return '';
                }
                if (!$('pur5730_vendor_survey_bidirectional_operating_income_tab_ds').validate()) {
                    $('vendor_survey_bidirectional_tabPanel_id').selectTab(6);
                    return '';
                }
                if (!$('pur5730_vendor_survey_bidirectional_main_production_tab_ds').validate()) {
                    $('vendor_survey_bidirectional_tabPanel_id').selectTab(7);
                    return '';
                }
            }
            
            function pur5730_maskWindow() {
                if ($('pur5730_vendor_survey_detail_win')) {
                    Aurora.Masker.mask($('pur5730_vendor_survey_detail_win').wrap, '...');
                } else {
                    Aurora.Masker.mask(Ext.getBody(), '..');
                }
            }
            
            function pur5730_unmaskWindow() {
                if ($('pur5730_vendor_survey_detail_win')) {
                    Aurora.Masker.unmask($('pur5730_vendor_survey_detail_win').wrap);
                } else {
                    Aurora.Masker.unmask(Ext.getBody());
                }
            }
            
            function pur5730_detail_manufacturer_saveFun() {
                check_validate();
                pur5730_maskWindow();
                $('pur5730_survey_equipment_headers_ds').submit();
                pur5730_unmaskWindow();
            }
            
            function pur5730_survey_equipment_headers_ds_submitsuccessFun() {
                Aurora.showMessage('${l:PROMPT}', '${l:PROMPT.SAVE_SUCCESS}', null);
                $('pur5730_survey_equipment_headers_ds').query();
            }
            
            //校验是否有数据未保存
            
            function check_update() {
            
                if ($('pur5730_survey_equipment_headers_ds').isModified()) {
                    return 'Y';
                }
                if ($('pur5730_vendor_survey_basic_info_tab_ds').isModified()) {
                    return 'Y';
                }
                if ($('pur5730_vendor_survey_bidirectional_capacity_tab_ds').isModified()) {
                    return 'Y';
                }
                if ($('pur5730_vendor_survey_bidirectional_dismantl_tab_ds').isModified()) {
                    return 'Y';
                }
                if ($('pur5730_vendor_survey_bidirectional_suppliers_information_tab_ds').isModified()) {
                    return 'Y';
                }
                if ($('pur5730_vendor_survey_bidirectional_vendors_information_tab_ds').isModified()) {
                    return 'Y';
                }
                if ($('pur5730_vendor_survey_bidirectional_main_business_tab_ds').isModified()) {
                    return 'Y';
                }
                if ($('pur5730_vendor_survey_bidirectional_operating_income_tab_ds').isModified()) {
                    return 'Y';
                }
                if ($('pur5730_vendor_survey_bidirectional_main_production_tab_ds').isModified()) {
                    return 'Y';
                }
            
                return 'N';
            }
            
            function pur5730_detail_manufacturer_submitFun() {
            
                Aurora.showConfirm('${l:PROMPT}', '${l:DOCUMNET_SUBMIT_CONFIRM}', function() {
                    var isModified = check_update();
                    if (isModified == 'Y') {
                        Aurora.showMessage('${l:PROMPT}', '${l:PUR5730.SAVE_DATA_FIRST}', null);
                        return '';
                    }
            
                    pur5730_maskWindow();
                    Aurora.request({
                        url: $('pur5730_survey_manufacturer_submit_link').getUrl(),
                        para: {
                            'survey_header_id': '${/parameter/@survey_header_id}'
                        },
                        success: function(result) {
                            Aurora.showMessage('${l:PROMPT}', '${l:PROMPT.SUBMIT_SUCCESS}', null);
                            pur5730_unmaskWindow();
                            pur5730_detail_manufacturer_returnFun();
                        },
                        failure: function() {
                            pur5730_unmaskWindow();
                        },
                        error: function() {
                            pur5730_unmaskWindow();
                        },
                        scope: this
                    });
                });
            }
            
            //无头内容时提示已提交
            
            function pur5730_survey_header_ds_load() {
                var records = $('pur5730_survey_equipment_headers_ds').getAll();
                if (records.length == 0) {
                    Aurora.showMessage('提示', '调查表已提交!', function() {
                        window.close();
                    });
                }
            }
            
            function pur5730_bidirectional_capacity_grid_renderer(value, record, name) {
                if (!check_require_ds_is_empty()) {
                    var require_record = $('pur5730_vendor_survey_require_ds').getAt(0);
            
                    if (name == 'production_base') {
                        set_required(record, name, require_record.get('ca_production_base'));
            
                    }
                    if (name == 'supply_products') {
                        set_required(record, name, require_record.get('ca_supply_products'));
            
                    }
                    if (name == 'main_product') {
                        set_required(record, name, require_record.get('ca_main_product'));
                    }
                    if (name == 'unit_code') {
                        set_required(record, name, require_record.get('ca_unit_code'));
                    }
                    if (name == 'monthly_capacity') {
                        set_required(record, name, require_record.get('ca_monthly_capacity'));
                    }
                    if (name == 'stock_quantity') {
                        set_required(record, name, require_record.get('ca_stock_quantity'));
                    }
                    if (name == 'occupancy_capacity') {
                        set_required(record, name, require_record.get('ca_occupancy_capacity'));
                    }
                    if (name == 'orders_proportion') {
                        set_required(record, name, require_record.get('ca_orders_proportion'));
                    }
            
                }
                return value;
            }
            
            function pur5730_bidirectional_dismantl_grid_renderer(value, record, name) {
                debugger;
                if (!check_require_ds_is_empty()) {
                    var require_record = $('pur5730_vendor_survey_require_ds').getAt(0);
                    var profit = record.get('profit');
                    var tax_rate = record.get('tax_rate');
                    if (name == 'supply_products') {
                        set_required(record, name, require_record.get('di_supply_products'));
            
                    }
                    if (name == 'operation_flow') {
                        set_required(record, name, require_record.get('di_operation_flow'));
            
                    }
                    if (name == 'main_material') {
                        set_required(record, name, require_record.get('di_main_material'));
                    }
                    if (name == 'unit_code') {
                        set_required(record, name, require_record.get('di_unit_code'));
                    }
                    if (name == 'unit_consumption') {
                        set_required(record, name, require_record.get('di_unit_consumption'));
                    }
                    if (name == 'material_manufacture') {
                        set_required(record, name, require_record.get('di_material_manufacture'));
                    }
                    if (name == 'material_price') {
                        set_required(record, name, require_record.get('di_material_price'));
                    }
                    if (name == 'unit_cost') {
                        set_required(record, name, require_record.get('di_unit_cost'));
                    }
                    if (name == 'cost_past') {
                        set_required(record, name, require_record.get('di_cost_past'));
                    }
                    if (name == 'item_cost') {
                        set_required(record, name, require_record.get('di_item_cost'));
                    }
                    if (name == 'item_cost_totals') {
                        set_required(record, name, require_record.get('di_item_cost_totals'));
                    }
                    if (name == 'labor_costs') {
                        set_required(record, name, require_record.get('di_labor_costs'));
                    }
                    if (name == 'manage_costs') {
                        set_required(record, name, require_record.get('di_manage_costs'));
                    }
                    if (name == 'profit') {
                        set_required(record, name, require_record.get('di_profit'));
                        if (typeof(profit) == 'undefined' || typeof(tax_rate) == 'undefined') {
                            record.set('total_price','');
                        } else {
                            record.set('total_price', profit * (100 - tax_rate) / 100);
                        }
                    }
                    if (name == 'tax_rate') {
                        set_required(record, name, require_record.get('di_tax_rate'));
                        if (typeof(profit) == 'undefined' || typeof(tax_rate) == 'undefined') {
                            record.set('total_price','');
                        } else {
                            record.set('total_price', profit * (100 - tax_rate) / 100);
                        }
                    }
            
            
            
                }
                return value;
            }
            
            function pur5730_bidirectional_vendors_grid_renderer(value, record, name) {
                if (!check_require_ds_is_empty()) {
                    var require_record = $('pur5730_vendor_survey_require_ds').getAt(0);
            
                    if (name == 'material_name') {
                        set_required(record, name, require_record.get('ve_material_name'));
            
                    }
                    if (name == 'vendor_short_name') {
                        set_required(record, name, require_record.get('ve_vendor_short_name'));
            
                    }
                    if (name == 'monthly_supply') {
                        set_required(record, name, require_record.get('ve_monthly_supply'));
                    }
                    if (name == 'long_association_date') {
                        set_required(record, name, require_record.get('ve_long_association_date'));
                        return Aurora.formatDate(value);
                    }
            
                    return value;
                }
            
            }
            
            function pur5730_bidirectional_suppliers_grid_renderer(value, record, name) {
                if (!check_require_ds_is_empty()) {
                    var require_record = $('pur5730_vendor_survey_require_ds').getAt(0);
            
                    if (name == 'su_rank') {
                        set_required(record, name, require_record.get('su_rank'));
            
                    }
                    if (name == 'customer_name') {
                        set_required(record, name, require_record.get('su_customer_name'));
            
                    }
                    if (name == 'monthly_amount') {
                        set_required(record, name, require_record.get('su_monthly_amount'));
                    }
                    if (name == 'monthly_supply') {
                        set_required(record, name, require_record.get('su_monthly_supply'));
                    }
                    if (name == 'unit_code') {
                        set_required(record, name, require_record.get('su_unit_code'));
                    }
                    if (name == 'comments') {
                        set_required(record, name, require_record.get('su_comments'));
                    }
            
                    return value;
                }
            
            }
            
            function pur5730_bidirectional_main_grid_renderer(value, record, name) {
                if (!check_require_ds_is_empty()) {
                    var require_record = $('pur5730_vendor_survey_require_ds').getAt(0);
            
                    if (name == 'main_product') {
                        set_required(record, name, require_record.get('mb_main_product'));
            
                    }
                    if (name == 'monthly_production') {
                        set_required(record, name, require_record.get('mb_monthly_production'));
            
                    }
                    if (name == 'amount_percent') {
                        set_required(record, name, require_record.get('mb_amount_percent'));
                    }
                    if (name == 'delivery_cycle') {
                        set_required(record, name, require_record.get('mb_delivery_cycle'));
                    }
                    if (name == 'product_category') {
                        set_required(record, name, require_record.get('mb_product_category'));
                    }
                    return value;
                }
            
            }
            
            function pur5730_bidirectional_operating_grid_renderer(value, record, name) {
                if (!check_require_ds_is_empty()) {
                    var require_record = $('pur5730_vendor_survey_require_ds').getAt(0);
            
                    if (name == 'op_project') {
                        set_required(record, name, require_record.get('op_project'));
            
                    }
                    if (name == 'operating_income') {
                        set_required(record, name, require_record.get('op_operating_income'));
            
                    }
                    if (name == 'gross_profit') {
                        set_required(record, name, require_record.get('op_gross_profit'));
                    }
                    if (name == 'gross_profit_margin') {
                        set_required(record, name, require_record.get('op_gross_profit_margin'));
                    }
            
                    return value;
                }
            
            }
            
            function pur5730_bidirectional_main_production_grid_renderer(value, record, name) {
                if (!check_require_ds_is_empty()) {
                    var require_record = $('pur5730_vendor_survey_require_ds').getAt(0);
            
                    if (name == 'classification_code') {
                        set_required(record, name, require_record.get('mp_classification_code'));
                    }
                    if (name == 'mp_specification') {
                        set_required(record, name, require_record.get('mp_specification'));
                    }
                    if (name == 'suppliers') {
                        set_required(record, name, require_record.get('mp_suppliers'));
                    }
                    if (name == 'nums') {
                        set_required(record, name, require_record.get('mp_nums'));
                    }
                    if (name == 'admission_time') {
                        set_required(record, name, require_record.get('mp_admission_time'));
                        return Aurora.formatDate(value);
                    }
            
                    return value;
                }
            
            }
        ]]></script>
        <a:dataSets>
            <a:dataSet id="pur5730_vendor_survey_bidirectional_tabs_ds">
                <a:datas dataSource="pur5730_vendor_survey_tabs"/>
            </a:dataSet>
            <a:dataSet id="pur5730_taxpayer_type_ds" lookupCode="FND_COM_SUP_INFOS.TAXPAYER_TYPE"/>
            <a:dataSet id="pur5730_pur_method_ds" lookupCode="FND_MTL_PUR_METHOD"/>
            <a:dataSet id="pur5730_vendor_survey_require_ds">
                <a:datas dataSource="pur5730_vendor_survey_require"/>
            </a:dataSet>
            <a:dataSet id="pur5730_manufacturer_industry_rank_ds">
                <a:datas dataSource="pur5730_manufacturer_industry_rank"/>
            </a:dataSet>
            <a:dataSet id="pur5730_manufacturer_list_ds">
                <a:datas>
                    <a:record name="是" code="Y"/>
                    <a:record name="否" code="N"/>
                    <a:record name="其他" code="OTHER"/>
                </a:datas>
            </a:dataSet>
            <a:dataSet id="pur5730_equipment_classification_list_ds">
                <a:datas>
                    <a:record name="生产设备" code="PRO"/>
                    <a:record name="检测设备" code="CHECK"/>
                </a:datas>
            </a:dataSet>
            <a:dataSet id="pur5730_vendor_survey_idType_ds" lookupCode="FND_COM_SUP_INFOS.ID_TYPE"/>
            <a:dataSet id="pur5730_vendor_survey_sex_ds" lookupCode="PUR_SEX"/>
            <a:dataSet id="pur5730_manufacturer_certification_ds">
                <a:datas dataSource="pur5730_manufacturer_certification"/>
            </a:dataSet>
            <a:dataSet id="pur5730_manufacturer_device_type_ds">
                <a:datas dataSource="pur5730_manufacturer_device_type"/>
            </a:dataSet>
            <a:dataSet id="pur5730_manufacturer_satisfaction_ds">
                <a:datas dataSource="pur5730_manufacturer_satisfaction"/>
            </a:dataSet>
            <a:dataSet id="pur5730_manufacturerCooperation_frequency_ds">
                <a:datas dataSource="pur5730_manufacturer_cooperation_frequency"/>
            </a:dataSet>
            <a:dataSet id="pur5730_manufacturer_attachment_type_ds">
                <a:datas dataSource="pur5730_attachment_type"/>
            </a:dataSet>
            <a:dataSet id="pur5730_survey_equipment_headers_ds" autoQuery="true" model="pur.PUR5730.pur5730_vendor_survey_headers" queryUrl="${/request/@context_path}/autocrud/pur.PUR5730.pur5730_vendor_survey_headers/query?survey_header_id=${/parameter/@survey_header_id}" submitUrl="${/request/@context_path}/modules/pur/PUR5730/pur5730_vendor_survey_receive_save.svc">
                <a:fields>
                    <a:field name="vendor_name" readOnly="true"/>
                    <a:field name="survey_header_id"/>
                    <a:field name="survey_number" readOnly="true"/>
                    <a:field name="created_by_desc" readOnly="true"/>
                    <a:field name="creation_date" readOnly="true"/>
                    <a:field name="submit_date" readOnly="true"/>
                    <a:field name="status" readOnly="true"/>
                    <a:field name="status_desc" readOnly="true"/>
                    <a:field name="require_business_group"/>
                    <a:field name="require_company_id"/>
                    <a:field name="company_code" readOnly="true"/>
                    <a:field name="company_name" readOnly="true"/>
                    <a:field name="vendor_code" readOnly="true"/>
                    <a:field name="supplier_business_group" readOnly="true"/>
                    <a:field name="supplier_company_id"/>
                    <a:field name="survey_type_code" readOnly="true"/>
                    <a:field name="vendor_short_name" readOnly="true"/>
                    <a:field name="survey_description" readOnly="true"/>
                </a:fields>
                <a:events>
                    <a:event name="load" handler="pur5730_survey_header_ds_load"/>
                    <a:event name="submitsuccess" handler="pur5730_survey_equipment_headers_ds_submitsuccessFun"/>
                </a:events>
            </a:dataSet>
            <a:dataSet id="pur5730_vendor_survey_basic_info_tab_ds" autoQuery="true" bindName="basic_info" bindTarget="pur5730_survey_equipment_headers_ds" model="pur.PUR7210.pur7210_vendor_survey_basic_info_tab" queryUrl="${/request/@context_path}/autocrud/pur.PUR7210.pur7210_vendor_survey_basic_info_tab/query?survey_header_id=${/parameter/@survey_header_id}">
                <a:fields>
                    <a:field name="basic_info_id"/>
                    <a:field name="survey_header_id" defaultValue="${/parameter/@survey_header_id}"/>
                    <a:field name="survey_type_code" defaultValue="30_EQUIPMENT"/>
                    <a:field name="survey_type_name"/>
                    <a:field name="tax_type_codes_bg_id"/>
                    <a:field name="tax_type_name" lovHeight="500" lovService="pur.PUR5730.pur5730_tax_type_codes_bg_lov?require_business_group=${/parameter/@require_business_group}" lovWidth="500" prompt="PUR5730.TAX_TYPE_NAME" title="PUR5730.TAX_TYPE_NAME">
                        <a:mapping>
                            <a:map from="tax_type_codes_bg_id" to="tax_type_codes_bg_id"/>
                            <a:map from="tax_type_name" to="tax_type_name"/>
                        </a:mapping>
                    </a:field>
                    <a:field name="payment_method_id"/>
                    <a:field name="payment_method_name" lovHeight="500" lovService="pur.PUR5730.pur5730_payment_methods_lov?require_business_group=${/parameter/@require_business_group}" lovWidth="500" prompt="PUR5730.PAYMENT_METHOD_NAME" title="PUR5730.PAYMENT_METHOD_NAME">
                        <a:mapping>
                            <a:map from="payment_method_id" to="payment_method_id"/>
                            <a:map from="description" to="payment_method_name"/>
                        </a:mapping>
                    </a:field>
                    <a:field name="payment_term_id"/>
                    <a:field name="payment_terms" lovHeight="500" lovService="fnd.FND9220.fnd_9220_payment_terms_lov?business_group=${/parameter/@require_business_group}" lovWidth="500" prompt="PUR5730.PAYMENT_TERMS" title="PUR5730.PAYMENT_TERMS">
                        <a:mapping>
                            <a:map from="payment_term_id" to="payment_term_id"/>
                            <a:map from="description" to="payment_terms"/>
                        </a:mapping>
                    </a:field>
                    <a:field name="chairman_board"/>
                    <a:field name="general_manager"/>
                    <a:field name="listed_flag" checkedValue="Y" defaultValue="N" uncheckedValue="N"/>
                    <a:field name="listed_place"/>
                    <a:field name="listed_date"/>
                    <a:field name="staff_count"/>
                    <a:field name="management_staff_count"/>
                    <a:field name="technical_staff_count"/>
                    <a:field name="production_staff_count"/>
                    <a:field name="rd_flag" checkedValue="Y" defaultValue="N" uncheckedValue="N"/>
                    <a:field name="rd_staff_count"/>
                    <a:field name="building_area"/>
                    <a:field name="industry_ranks"/>
                    <a:field name="industry_ranks_desc" displayField="flex_desc" options="pur5730_manufacturer_industry_rank_ds" returnField="industry_ranks" valueField="flex_value"/>
                    <a:field name="others"/>
                    <a:field name="international_top5"/>
                    <a:field name="domestic_top5"/>
                    <a:field name="iso9001_flag" checkedValue="Y" defaultValue="N" uncheckedValue="N"/>
                    <a:field name="iso9001_date"/>
                    <a:field name="iso9002_flag" checkedValue="Y" defaultValue="N" uncheckedValue="N"/>
                    <a:field name="iso9002_date"/>
                    <a:field name="iso14001_flag" checkedValue="Y" defaultValue="N" uncheckedValue="N"/>
                    <a:field name="iso14001_date"/>
                    <a:field name="c_attribute2" displayField="code_value_name" options="pur5730_taxpayer_type_ds" returnField="taxpayer_type" valueField="code_value"/>
                    <a:field name="c_attribute8" displayField="name" options="pur5730_manufacturer_list_ds" returnField="c_attribute8_code" valueField="code"/>
                    <a:field name="c_attribute15" lovHeight="510" lovLabelWidth="100" lovService="fnd.FND9100.fnd_currency_code_lov" lovWidth="650" prompt="FND_COMPANY_REGISTED.REGISTERED_CURRENCY_CODE" title="CURRENCY_SELECTION">
                        <a:mapping>
                            <a:map from="currency_code" to="c_attribute15"/>
                        </a:mapping>
                    </a:field>
                    <a:field name="audit_flag" checkedValue="Y" defaultValue="N" uncheckedValue="N"/>
                </a:fields>
                <a:events>
                    <a:event name="load" handler="pur5730_vendor_survey_basic_info_ds_loadFun"/>
                </a:events>
            </a:dataSet>
            <a:dataSet id="pur5730_vendor_survey_bidirectional_capacity_tab_ds" autoQuery="true" bindName="capacity" bindTarget="pur5730_survey_equipment_headers_ds" model="pur.PUR7210.pur7210_vendor_survey_capacity_tab" queryUrl="${/request/@context_path}/autocrud/pur.PUR7210.pur7210_vendor_survey_capacity_tab/query?survey_header_id=${/parameter/@survey_header_id}" selectable="true">
                <a:fields>
                    <a:field name="survey_header_id" defaultValue="${/parameter/@survey_header_id}"/>
                    <a:field name="survey_type_code" defaultValue="40_BIDIRECTIONAL"/>
                    <a:field name="unit_code" autoComplete="true" autoCompleteField="uom_desc" lovGridHeight="300" lovHeight="450" lovService="public.fnd_uom_codes_lov" lovWidth="550" prompt="MTL_SYSTEM_VENDOR_ITEMS.PRIMARY_UOM" requiredMessage="${l:MTL_SYSTEM_VENDOR_ITEMS.PRIMARY_UOM_NOT_NULL}" title="MTL_SYSTEM_VENDOR_ITEMS.PRIMARY_UOM">
                        <a:mapping>
                            <a:map from="uom_code" to="unit_code"/>
                        </a:mapping>
                    </a:field>
                </a:fields>
                <a:events>
                    <a:event name="submitSuccess" handler="pur5730_vendor_survey_bidirectional_capacity_tab_ds_submitsuccessFun"/>
                </a:events>
            </a:dataSet>
            <a:dataSet id="pur5730_vendor_survey_bidirectional_dismantl_tab_ds" autoQuery="true" bindName="dismantl" bindTarget="pur5730_survey_equipment_headers_ds" model="pur.PUR7210.pur7210_vendor_survey_dismantl_tab" queryUrl="${/request/@context_path}/autocrud/pur.PUR7210.pur7210_vendor_survey_dismantl_tab/query?survey_header_id=${/parameter/@survey_header_id}" selectable="true">
                <a:fields>
                    <a:field name="survey_header_id" defaultValue="${/parameter/@survey_header_id}"/>
                    <a:field name="survey_type_code" defaultValue="40_BIDIRECTIONAL"/>
                    <a:field name="unit_code" autoComplete="true" autoCompleteField="uom_desc" lovGridHeight="300" lovHeight="450" lovService="public.fnd_uom_codes_lov" lovWidth="550" prompt="MTL_SYSTEM_VENDOR_ITEMS.PRIMARY_UOM" requiredMessage="${l:MTL_SYSTEM_VENDOR_ITEMS.PRIMARY_UOM_NOT_NULL}" title="MTL_SYSTEM_VENDOR_ITEMS.PRIMARY_UOM">
                        <a:mapping>
                            <a:map from="uom_code" to="unit_code"/>
                        </a:mapping>
                    </a:field>
                </a:fields>
                <a:events>
                    <a:event name="submitSuccess" handler="pur5730_vendor_survey_bidirectional_dismantl_tab_ds_submitsuccessFun"/>
                </a:events>
            </a:dataSet>
            <a:dataSet id="pur5730_vendor_survey_bidirectional_suppliers_information_tab_ds" autoQuery="true" bindName="suppliers" bindTarget="pur5730_survey_equipment_headers_ds" model="pur.PUR7210.pur7210_vendor_survey_suppliers_information_tab" queryUrl="${/request/@context_path}/autocrud/pur.PUR7210.pur7210_vendor_survey_suppliers_information_tab/query?survey_header_id=${/parameter/@survey_header_id}" selectable="true">
                <a:fields>
                    <a:field name="survey_header_id" defaultValue="${/parameter/@survey_header_id}"/>
                    <a:field name="survey_type_code" defaultValue="40_BIDIRECTIONAL"/>
                    <a:field name="unit_code" autoComplete="true" autoCompleteField="uom_desc" lovGridHeight="300" lovHeight="450" lovService="public.fnd_uom_codes_lov" lovWidth="550" prompt="MTL_SYSTEM_VENDOR_ITEMS.PRIMARY_UOM" requiredMessage="${l:MTL_SYSTEM_VENDOR_ITEMS.PRIMARY_UOM_NOT_NULL}" title="MTL_SYSTEM_VENDOR_ITEMS.PRIMARY_UOM">
                        <a:mapping>
                            <a:map from="uom_code" to="unit_code"/>
                        </a:mapping>
                    </a:field>
                </a:fields>
                <a:events>
                    <a:event name="submitSuccess" handler="pur5730_vendor_survey_bidirectional_suppliers_information_tab_ds_submitsuccessFun"/>
                </a:events>
            </a:dataSet>
            <a:dataSet id="pur5730_vendor_survey_bidirectional_vendors_information_tab_ds" autoQuery="true" bindName="vendors" bindTarget="pur5730_survey_equipment_headers_ds" model="pur.PUR7210.pur7210_vendor_survey_vendors_information_tab" queryUrl="${/request/@context_path}/autocrud/pur.PUR7210.pur7210_vendor_survey_vendors_information_tab/query?survey_header_id=${/parameter/@survey_header_id}" selectable="true">
                <a:fields>
                    <a:field name="survey_header_id" defaultValue="${/parameter/@survey_header_id}"/>
                    <a:field name="survey_type_code" defaultValue="40_BIDIRECTIONAL"/>
                    <a:field name="long_association_flag" checkedValue="Y" defaultValue="N" uncheckedValue="N"/>
                </a:fields>
                <a:events>
                    <a:event name="submitSuccess" handler="pur5730_vendor_survey_bidirectional_vendors_information_tab_ds_submitsuccessFun"/>
                </a:events>
            </a:dataSet>
            <a:dataSet id="pur5730_vendor_survey_bidirectional_main_business_tab_ds" autoQuery="true" bindName="main_business" bindTarget="pur5730_survey_equipment_headers_ds" model="pur.PUR7210.pur7210_vendor_survey_main_business_tab" queryUrl="${/request/@context_path}/autocrud/pur.PUR7210.pur7210_vendor_survey_main_business_tab/query?survey_header_id=${/parameter/@survey_header_id}" selectable="true">
                <a:fields>
                    <a:field name="survey_header_id" defaultValue="${/parameter/@survey_header_id}"/>
                    <a:field name="survey_type_code" defaultValue="40_BIDIRECTIONAL"/>
                    <a:field name="applicable_flag" checkedValue="Y" defaultValue="N" uncheckedValue="N"/>
                </a:fields>
                <a:events>
                    <a:event name="submitSuccess" handler="pur5730_vendor_survey_bidirectional_main_business_tab_ds_submitsuccessFun"/>
                </a:events>
            </a:dataSet>
            <a:dataSet id="pur5730_vendor_survey_bidirectional_operating_income_tab_ds" autoQuery="true" bindName="operating_income" bindTarget="pur5730_survey_equipment_headers_ds" model="pur.PUR7210.pur7210_vendor_survey_operating_income_tab" queryUrl="${/request/@context_path}/autocrud/pur.PUR7210.pur7210_vendor_survey_operating_income_tab/query?survey_header_id=${/parameter/@survey_header_id}" selectable="true">
                <a:fields>
                    <a:field name="survey_header_id" defaultValue="${/parameter/@survey_header_id}"/>
                    <a:field name="survey_type_code" defaultValue="40_BIDIRECTIONAL"/>
                </a:fields>
                <a:events>
                    <a:event name="submitSuccess" handler="pur5730_vendor_survey_bidirectional_operating_income_tab_ds_submitsuccessFun"/>
                </a:events>
            </a:dataSet>
            <a:dataSet id="pur5730_vendor_survey_bidirectional_main_production_tab_ds" autoQuery="true" bindName="main_production" bindTarget="pur5730_survey_equipment_headers_ds" model="pur.PUR7210.pur7210_vendor_survey_main_production_tab" queryUrl="${/request/@context_path}/autocrud/pur.PUR7210.pur7210_vendor_survey_main_production_tab/query?survey_header_id=${/parameter/@survey_header_id}" selectable="true">
                <a:fields>
                    <a:field name="survey_header_id" defaultValue="${/parameter/@survey_header_id}"/>
                    <a:field name="survey_type_code" defaultValue="40_BIDIRECTIONAL"/>
                    <a:field name="classification_code" displayField="name" options="pur5730_equipment_classification_list_ds" valueField="code"/>
                </a:fields>
                <a:events>
                    <a:event name="submitSuccess" handler="pur5730_vendor_survey_bidirectional_main_production_tab_ds_submitsuccessFun"/>
                </a:events>
            </a:dataSet>
        </a:dataSets>
        <a:screenBody>
            <a:screenTopToolbar>
                <a:toolbarButton id="pur5730_detail_manufacturer_saveBtn" click="pur5730_detail_manufacturer_saveFun" style="margin-left:20px;" text="HAP_SAVE" width="100"/>
                <a:toolbarButton id="pur5730_detail_manufacturer_submitBtn" click="pur5730_detail_manufacturer_submitFun" text="HAP_SUBMIT" width="100"/>
                <a:toolbarButton id="pur5730_detail_manufacturer_backBtn" click="pur5730_detail_manufacturer_returnFun" text="HAP_BACK" width="100"/>
            </a:screenTopToolbar>
            <a:fieldSet style="margin-top:10px;margin-left:2px;" title="PROMPT.BASIC_INFOMATION">
                <a:hBox labelWidth="120">
                    <a:textField name="survey_number" bindTarget="pur5730_survey_equipment_headers_ds" prompt="PUR5710.SURVEY_NUMBER"/>
                    <a:textField name="survey_type_desc" bindTarget="pur5730_survey_equipment_headers_ds" prompt="PUR5710.SURVEY_TYPE_DESC" readOnly="true"/>
                    <a:textField name="status_desc" bindTarget="pur5730_survey_equipment_headers_ds" prompt="PUR5710.STATUS_DESC"/>
                </a:hBox>
                <a:hBox labelWidth="120">
                    <a:textField name="company_code" bindTarget="pur5730_survey_equipment_headers_ds" prompt="FND_COMPANIES.CLIENT_CODE"/>
                    <a:textField name="company_name" bindTarget="pur5730_survey_equipment_headers_ds" prompt="FND_COMPANIES.CLIENT_NAME" width="427"/>
                </a:hBox>
                <a:hBox labelWidth="120">
                    <a:textField name="created_by_desc" bindTarget="pur5730_survey_equipment_headers_ds" prompt="PUR5710.CREATED_BY_DESC"/>
                    <a:textField name="creation_date" bindTarget="pur5730_survey_equipment_headers_ds" prompt="PUR5710.CREATION_DATE"/>
                    <a:textField name="submit_date" bindTarget="pur5730_survey_equipment_headers_ds" prompt="PUR5730.SUBMIT_DATE"/>
                </a:hBox>
                <a:hBox labelWidth="120">
                    <a:textArea name="survey_description" bindTarget="pur5730_survey_equipment_headers_ds" prompt="PUR5710.SURVEY_DESCRIPTION" readOnly="true" width="702"/>
                </a:hBox>
                <a:hBox labelWidth="120">
                    <a:textField name="survey_comment" bindTarget="pur5730_survey_equipment_headers_ds" prompt="PUR5730.SURVEY_COMMENT" width="705"/>
                </a:hBox>
            </a:fieldSet>
            <a:fieldSet style="margin-top:10px;margin-left:2px;" title="PUR_VENDORS.SUPPLIER_INFORMATION">
                <a:hBox labelWidth="130">
                    <a:textField name="vendor_code" bindTarget="pur5730_survey_equipment_headers_ds" prompt="PUR_VENDORS.VENDOR_CODE"/>
                    <a:textField name="vendor_name" bindTarget="pur5730_survey_equipment_headers_ds" prompt="PUR_VENDORS.VENDOR_NAME" width="426"/>
                </a:hBox>
                <a:hBox labelWidth="130">
                    <a:textField name="business_leader" bindTarget="pur5730_vendor_survey_basic_info_tab_ds" prompt="业务负责人"/>
                    <a:textField name="document_num" bindTarget="pur5730_vendor_survey_basic_info_tab_ds" prompt="文件编号"/>
                    <a:checkBox name="listed_flag" bindTarget="pur5730_vendor_survey_basic_info_tab_ds" prompt="是否上市"/>
                </a:hBox>
                <a:hBox labelWidth="130">
                    <a:textField name="stock_code" allowDecimals="false" bindTarget="pur5730_vendor_survey_basic_info_tab_ds" prompt="股票代码"/>
                </a:hBox>
            </a:fieldSet>
            <a:tabPanel id="vendor_survey_bidirectional_tabPanel_id" marginHeight="50" marginWidth="30">
                <a:tabs>
                    <a:tab id="vendor_survey_bidirectional_basic_info_tab_id" prompt="基本信息" width="90">
                        <a:fieldSet style="margin-top:10px;margin-left:2px;" title="价格对标（物料）">
                            <a:hBox labelWidth="120">
                                <a:textField name="la_material_num" bindTarget="pur5730_vendor_survey_basic_info_tab_ds" prompt="我司物料编号" width="153"/>
                                <a:textField name="la_material_name" bindTarget="pur5730_vendor_survey_basic_info_tab_ds" prompt="物料名称" width="153"/>
                                <a:textField name="la_material_size" bindTarget="pur5730_vendor_survey_basic_info_tab_ds" prompt="物料规格" width="153"/>
                            </a:hBox>
                        </a:fieldSet>
                        <a:fieldSet style="margin-top:10px;margin-left:2px;" title="价格对标（最新售价（含税））">
                            <a:hBox labelWidth="120">
                                <a:textField name="top_customer1" bindTarget="pur5730_vendor_survey_basic_info_tab_ds" prompt="Top1客户" width="153"/>
                                <a:textField name="top_customer2" bindTarget="pur5730_vendor_survey_basic_info_tab_ds" prompt="Top2客户" width="153"/>
                                <a:textField name="top_customer3" bindTarget="pur5730_vendor_survey_basic_info_tab_ds" prompt="Top3客户" width="153"/>
                            </a:hBox>
                            <a:hBox labelWidth="120">
                                <a:textField name="top_customer4" bindTarget="pur5730_vendor_survey_basic_info_tab_ds" prompt="Top4客户" width="153"/>
                                <a:textField name="top_customer5" bindTarget="pur5730_vendor_survey_basic_info_tab_ds" prompt="Top5客户" width="153"/>
                            </a:hBox>
                            <a:hBox labelWidth="120">
                                <a:textField name="exception_description" bindTarget="pur5730_vendor_survey_basic_info_tab_ds" prompt="异常说明" width="400"/>
                            </a:hBox>
                        </a:fieldSet>
                        <a:fieldSet style="margin-top:10px;margin-left:2px;" title="对我司定位">
                            <a:hBox labelWidth="120">
                                <a:textField name="you_annual_profit" bindTarget="pur5730_vendor_survey_basic_info_tab_ds" prompt="贵司年度平均利润率" width="153"/>
                                <a:textField name="you_annual_sales" bindTarget="pur5730_vendor_survey_basic_info_tab_ds" prompt="贵司年度总销售" width="153"/>
                                <a:textField name="our_product_profit" bindTarget="pur5730_vendor_survey_basic_info_tab_ds" prompt="我司产品平均利润率" width="153"/>
                            </a:hBox>
                            <a:hBox labelWidth="120">
                                <a:textField name="our_annual_sales" bindTarget="pur5730_vendor_survey_basic_info_tab_ds" prompt="我司年度销售额" width="153"/>
                                <a:textField name="our_profit_range" bindTarget="pur5730_vendor_survey_basic_info_tab_ds" prompt="我司产品利润率区间" width="153"/>
                                <a:textField name="our_annual_sales_ratio" bindTarget="pur5730_vendor_survey_basic_info_tab_ds" prompt="我司年度销售占比" width="153"/>
                            </a:hBox>
                            <a:hBox labelWidth="120">
                                <a:textField name="our_rank" bindTarget="pur5730_vendor_survey_basic_info_tab_ds" prompt="我司销售额在客户中排名" width="153"/>
                            </a:hBox>
                        </a:fieldSet>
                        <a:fieldSet style="margin-top:10px;margin-left:2px;" title="公司人员构成">
                            <a:hBox labelWidth="120">
                                <a:numberField name="c_attribute45" allowDecimals="false" allowNegative="false" bindTarget="pur5730_vendor_survey_basic_info_tab_ds" prompt="员工总数" width="153"/>
                                <a:numberField name="c_attribute46" allowDecimals="false" allowNegative="false" bindTarget="pur5730_vendor_survey_basic_info_tab_ds" prompt="销售人员" width="153"/>
                                <a:numberField name="c_attribute47" allowDecimals="false" allowNegative="false" bindTarget="pur5730_vendor_survey_basic_info_tab_ds" prompt="管理人员" width="153"/>
                            </a:hBox>
                            <a:hBox labelWidth="120">
                                <a:numberField name="c_attribute48" allowDecimals="false" allowNegative="false" bindTarget="pur5730_vendor_survey_basic_info_tab_ds" prompt="生产人员" width="153"/>
                                <a:numberField name="c_attribute49" allowDecimals="false" allowNegative="false" bindTarget="pur5730_vendor_survey_basic_info_tab_ds" prompt="品管人员" width="153"/>
                                <a:numberField name="c_attribute50" allowDecimals="false" allowNegative="false" bindTarget="pur5730_vendor_survey_basic_info_tab_ds" prompt="技术人员" width="153"/>
                            </a:hBox>
                        </a:fieldSet>
                        <a:fieldSet style="margin-top:10px;margin-left:2px;" title="其他信息">
                            <a:textArea name="prediction_comments" bindTarget="pur5730_vendor_survey_basic_info_tab_ds" emptyText="贵司对未来一年的原物料价格行情和供需关系如何预测？" prompt="行情预测" width="426"/>
                            <a:textArea name="expect_comments" bindTarget="pur5730_vendor_survey_basic_info_tab_ds" emptyText="贵司对我司未来一年有什么期望？从价格、服务、订单、交期等方面描述。" prompt="未来期望" width="426"/>
                            <a:textArea name="assist_comments" bindTarget="pur5730_vendor_survey_basic_info_tab_ds" emptyText="贵司需期望我司在哪方面给于协助？" prompt="期望协助" width="426"/>
                        </a:fieldSet>
                    </a:tab>
                    <a:tab id="vendor_survey_bidirectional_capacity_tab_id" prompt="产能信息" width="90">
                        <a:grid autoAppend="false" bindTarget="pur5730_vendor_survey_bidirectional_capacity_tab_ds" height="280" marginWidth="45" navBar="true" width="1000">
                            <a:toolBar>
                                <a:button type="add"/>
                                <a:button type="save"/>
                                <a:button type="delete"/>
                            </a:toolBar>
                            <a:columns>
                                <a:column name="production_base" align="left" editor="pur5730_bidirectional_capacity_tf" prompt="生产基地（国/省/市）" renderer="pur5730_bidirectional_capacity_grid_renderer" width="100"/>
                                <a:column name="supply_products" align="left" editor="pur5730_bidirectional_capacity_tf" prompt="供应产品" renderer="pur5730_bidirectional_capacity_grid_renderer" width="100"/>
                                <a:column name="main_product" align="left" editor="pur5730_bidirectional_capacity_tf" prompt="主要产品系列" renderer="pur5730_bidirectional_capacity_grid_renderer" width="100"/>
                                <a:column name="unit_code" align="left" editor="pur5730_bidirectional_capacity_lov" prompt="单位" renderer="pur5730_bidirectional_capacity_grid_renderer" width="120"/>
                                <a:column name="monthly_capacity" align="left" editor="pur5730_bidirectional_capacity_nf" prompt="年平均月产能" renderer="pur5730_bidirectional_capacity_grid_renderer" width="120"/>
                                <a:column name="stock_quantity" align="left" editor="pur5730_bidirectional_capacity_nf" prompt="常备库存量" renderer="pur5730_bidirectional_capacity_grid_renderer" width="120"/>
                                <a:column name="occupancy_capacity" align="left" editor="pur5730_bidirectional_capacity_nf" prompt="景旺占用产能" renderer="pur5730_bidirectional_capacity_grid_renderer" width="120"/>
                                <a:column name="orders_proportion" align="left" editor="pur5730_bidirectional_capacity_nf" prompt="公司接单比例（%）" renderer="pur5730_bidirectional_capacity_grid_renderer" width="120"/>
                            </a:columns>
                            <a:editors>
                                <a:textField id="pur5730_bidirectional_capacity_tf"/>
                                <a:numberField id="pur5730_bidirectional_capacity_nf"/>
                                <a:lov id="pur5730_bidirectional_capacity_lov"/>
                            </a:editors>
                        </a:grid>
                        <a:fieldSet style="margin-top:10px;margin-left:2px;" title="未来三年的扩产计划">
                            <a:hBox labelWidth="120">
                                <a:checkBox name="extended_flag" bindTarget="pur5730_vendor_survey_basic_info_tab_ds" prompt="是否扩产" width="153"/>
                            </a:hBox>
                            <a:hBox labelWidth="120">
                                <a:textField name="extended_site" bindTarget="pur5730_vendor_survey_basic_info_tab_ds" prompt="扩产地点" width="153"/>
                                <a:datePicker name="extended_time" bindTarget="pur5730_vendor_survey_basic_info_tab_ds" prompt="扩产时间" width="153"/>
                                <a:numberField name="monthly_capacity" bindTarget="pur5730_vendor_survey_basic_info_tab_ds" prompt="月产能" width="153"/>
                            </a:hBox>
                        </a:fieldSet>
                    </a:tab>
                    <a:tab id="vendor_survey_bidirectional_dismantl_tab_id" prompt="成本拆解" width="90">
                        <a:grid autoAppend="false" bindTarget="pur5730_vendor_survey_bidirectional_dismantl_tab_ds" marginHeight="280" marginWidth="45" navBar="true" width="1000">
                            <a:toolBar>
                                <a:button type="add"/>
                                <a:button type="save"/>
                                <a:button type="delete"/>
                            </a:toolBar>
                            <a:columns>
                                <a:column name="supply_products" align="left" editor="pur5730_bidirectional_dismantl_tf" lock="true" prompt="供应产品" renderer="pur5730_bidirectional_dismantl_grid_renderer" width="100"/>
                                <a:column name="operation_flow" align="left" editor="pur5730_bidirectional_dismantl_tf" lock="true" prompt="工序流程" renderer="pur5730_bidirectional_dismantl_grid_renderer" width="100"/>
                                <a:column name="main_material" align="left" editor="pur5730_bidirectional_dismantl_tf" lock="true" prompt="所需主要物料" renderer="pur5730_bidirectional_dismantl_grid_renderer" width="100"/>
                                <a:column name="unit_code" align="left" editor="pur5730_bidirectional_dismantl_lov" lock="true" prompt="单位" renderer="pur5730_bidirectional_dismantl_grid_renderer" width="120"/>
                                <a:column name="unit_consumption" align="left" editor="pur5730_bidirectional_dismantl_nf" prompt="单位耗量" renderer="pur5730_bidirectional_dismantl_grid_renderer" width="120"/>
                                <a:column name="material_manufacture" align="left" editor="pur5730_bidirectional_dismantl_tf" prompt="物料厂商" renderer="pur5730_bidirectional_dismantl_grid_renderer" width="120"/>
                                <a:column name="material_price" align="left" editor="pur5730_bidirectional_dismantl_nf" prompt="物料单价" renderer="pur5730_bidirectional_dismantl_grid_renderer" width="120"/>
                                <a:column name="unit_cost" align="left" editor="pur5730_bidirectional_dismantl_nf" prompt="单位成本" renderer="pur5730_bidirectional_dismantl_grid_renderer" width="120"/>
                                <a:column name="cost_past" align="left" editor="pur5730_bidirectional_dismantl_nf" prompt="成本占比（占售价）" renderer="pur5730_bidirectional_dismantl_grid_renderer" width="120"/>
                                <a:column name="item_cost" align="left" editor="pur5730_bidirectional_dismantl_nf" prompt="工序物料成本" renderer="pur5730_bidirectional_dismantl_grid_renderer" width="120"/>
                                <a:column name="item_cost_totals" align="left" editor="pur5730_bidirectional_dismantl_nf" prompt="物料成本合计" renderer="pur5730_bidirectional_dismantl_grid_renderer" width="120"/>
                                <a:column name="labor_costs" align="left" editor="pur5730_bidirectional_dismantl_nf" prompt="人工费用" renderer="pur5730_bidirectional_dismantl_grid_renderer" width="120"/>
                                <a:column name="manage_costs" align="left" editor="pur5730_bidirectional_dismantl_nf" prompt="管理费用" renderer="pur5730_bidirectional_dismantl_grid_renderer" width="120"/>
                                <a:column name="profit" align="left" editor="pur5730_bidirectional_dismantl_nf" prompt="利润" renderer="pur5730_bidirectional_dismantl_grid_renderer" width="120"/>
                                <a:column name="tax_rate" align="left" editor="pur5730_bidirectional_dismantl_nf2" prompt="税率" renderer="pur5730_bidirectional_dismantl_grid_renderer" width="120"/>
                                <a:column name="total_price" align="left" prompt="合计价格" renderer="pur5730_bidirectional_dismantl_grid_renderer" width="120"/>
                            </a:columns>
                            <a:editors>
                                <a:textField id="pur5730_bidirectional_dismantl_tf"/>
                                <a:numberField id="pur5730_bidirectional_dismantl_nf" allowDecimals="false"/>
                                <a:numberField id="pur5730_bidirectional_dismantl_nf2" allowDecimals="false" max="100"/>
                                <a:lov id="pur5730_bidirectional_dismantl_lov"/>
                            </a:editors>
                        </a:grid>
                    </a:tab>
                    <a:tab id="vendor_survey_bidirectional_vendors_information_tab_id" prompt="Top5大供应商信息" width="130">
                        <a:grid autoAppend="false" bindTarget="pur5730_vendor_survey_bidirectional_vendors_information_tab_ds" marginHeight="280" marginWidth="45" navBar="true" width="1000">
                            <a:toolBar>
                                <a:button type="add"/>
                                <a:button type="save"/>
                                <a:button type="delete"/>
                            </a:toolBar>
                            <a:columns>
                                <a:column name="material_name" align="left" editor="pur5730_bidirectional_vendors_information_tf" prompt="原材料名称" renderer="pur5730_bidirectional_vendors_grid_renderer" width="100"/>
                                <a:column name="vendor_short_name" align="left" editor="pur5730_bidirectional_vendors_information_tf" prompt="供应商简称" renderer="pur5730_bidirectional_vendors_grid_renderer" width="100"/>
                                <a:column name="monthly_supply" align="left" editor="pur5730_bidirectional_vendors_information_nf" prompt="月供给量" renderer="pur5730_bidirectional_vendors_grid_renderer" width="100"/>
                                <a:column name="long_association_flag" align="left" editor="pur5730_bidirectional_vendors_information_cb" prompt="是否长协" renderer="pur5730_bidirectional_vendors_grid_renderer" width="120"/>
                                <a:column name="long_association_date" align="left" editor="pur5730_bidirectional_vendors_information_dp" prompt="长协有效日期" renderer="pur5730_bidirectional_vendors_grid_renderer" width="120"/>
                            </a:columns>
                            <a:editors>
                                <a:textField id="pur5730_bidirectional_vendors_information_tf"/>
                                <a:numberField id="pur5730_bidirectional_vendors_information_nf"/>
                                <a:datePicker id="pur5730_bidirectional_vendors_information_dp"/>
                                <a:checkBox id="pur5730_bidirectional_vendors_information_cb"/>
                            </a:editors>
                        </a:grid>
                    </a:tab>
                    <a:tab id="vendor_survey_bidirectional_suppliers_information_tab_id" prompt="Top5大客户信息" width="130">
                        <a:grid autoAppend="false" bindTarget="pur5730_vendor_survey_bidirectional_suppliers_information_tab_ds" height="280" marginWidth="45" navBar="true" width="1000">
                            <a:toolBar>
                                <a:button type="add"/>
                                <a:button type="save"/>
                                <a:button type="delete"/>
                            </a:toolBar>
                            <a:columns>
                                <a:column name="su_rank" align="left" editor="pur5730_bidirectional_suppliers_information_nf" prompt="排名" renderer="pur5730_bidirectional_suppliers_grid_renderer" width="100"/>
                                <a:column name="customer_name" align="left" editor="pur5730_bidirectional_suppliers_information_tf" prompt="客户名称" renderer="pur5730_bidirectional_suppliers_grid_renderer" width="100"/>
                                <a:column name="monthly_amount" align="left" editor="pur5730_bidirectional_suppliers_information_nf" prompt="月交易金额" renderer="pur5730_bidirectional_suppliers_grid_renderer" width="100"/>
                                <a:column name="unit_code" align="left" editor="pur5730_bidirectional_suppliers_information_lov" prompt="单位" renderer="pur5730_bidirectional_suppliers_grid_renderer" width="120"/>
                                <a:column name="monthly_supply" align="left" editor="pur5730_bidirectional_suppliers_information_nf" prompt="月供应量" renderer="pur5730_bidirectional_suppliers_grid_renderer" width="120"/>
                                <a:column name="comments" align="left" editor="pur5730_bidirectional_suppliers_information_tf" prompt="备注" renderer="pur5730_bidirectional_suppliers_grid_renderer" width="120"/>
                            </a:columns>
                            <a:editors>
                                <a:textField id="pur5730_bidirectional_suppliers_information_tf"/>
                                <a:numberField id="pur5730_bidirectional_suppliers_information_nf"/>
                                <a:lov id="pur5730_bidirectional_suppliers_information_lov"/>
                            </a:editors>
                        </a:grid>
                    </a:tab>
                    <a:tab id="vendor_survey_bidirectional_main_business_tab_id" prompt="主营业务及产品结构" width="130">
                        <a:grid autoAppend="false" bindTarget="pur5730_vendor_survey_bidirectional_main_business_tab_ds" marginHeight="280" marginWidth="45" navBar="true" width="1000">
                            <a:toolBar>
                                <a:button type="add"/>
                                <a:button type="save"/>
                                <a:button type="delete"/>
                            </a:toolBar>
                            <a:columns>
                                <a:column name="main_product" align="left" editor="pur5730_bidirectional_main_business_tf" prompt="主要产品" renderer="pur5730_bidirectional_main_grid_renderer" width="100"/>
                                <a:column name="monthly_production" align="left" editor="pur5730_bidirectional_main_business_nf" prompt="月产量" renderer="pur5730_bidirectional_main_grid_renderer" width="100"/>
                                <a:column name="amount_percent" align="left" editor="pur5730_bidirectional_main_business_nf" prompt="金额占比" renderer="pur5730_bidirectional_main_grid_renderer" width="100"/>
                                <a:column name="delivery_cycle" align="left" editor="pur5730_bidirectional_main_business_tf" prompt="交货周期" renderer="pur5730_bidirectional_main_grid_renderer" width="120"/>
                                <a:column name="product_category" align="left" editor="pur5730_bidirectional_main_business_tf" prompt="产品应用类别" renderer="pur5730_bidirectional_main_grid_renderer" width="120"/>
                                <a:column name="applicable_flag" align="left" editor="pur5730_bidirectional_main_business_cb" prompt="是否适用于我司" renderer="pur5730_bidirectional_main_grid_renderer" width="120"/>
                            </a:columns>
                            <a:editors>
                                <a:textField id="pur5730_bidirectional_main_business_tf"/>
                                <a:numberField id="pur5730_bidirectional_main_business_nf"/>
                                <a:checkBox id="pur5730_bidirectional_main_business_cb"/>
                            </a:editors>
                        </a:grid>
                    </a:tab>
                    <a:tab id="vendor_survey_bidirectional_operating_income_tab_id" prompt="近三年营业收入及毛利润率(单位：万元)" width="300">
                        <a:grid autoAppend="false" bindTarget="pur5730_vendor_survey_bidirectional_operating_income_tab_ds" marginHeight="280" marginWidth="45" navBar="true" width="1000">
                            <a:toolBar>
                                <a:button type="add"/>
                                <a:button type="save"/>
                                <a:button type="delete"/>
                            </a:toolBar>
                            <a:columns>
                                <a:column name="op_project" align="left" editor="pur5730_bidirectional_operating_income_tf" prompt="项目" renderer="pur5730_bidirectional_operating_grid_renderer" width="100"/>
                                <a:column name="operating_income" align="left" editor="pur5730_bidirectional_operating_income_nf" prompt="营业收入" renderer="pur5730_bidirectional_operating_grid_renderer" width="100"/>
                                <a:column name="gross_profit" align="left" editor="pur5730_bidirectional_operating_income_nf" prompt="毛利润" renderer="pur5730_bidirectional_operating_grid_renderer" width="100"/>
                                <a:column name="gross_profit_margin" align="left" editor="pur5730_bidirectional_operating_income_nf" prompt="毛利润率" renderer="pur5730_bidirectional_operating_grid_renderer" width="120"/>
                            </a:columns>
                            <a:editors>
                                <a:textField id="pur5730_bidirectional_operating_income_tf"/>
                                <a:numberField id="pur5730_bidirectional_operating_income_nf"/>
                            </a:editors>
                        </a:grid>
                    </a:tab>
                    <a:tab id="vendor_survey_bidirectional_main_production_tab_id" prompt="主要生产设备及检测仪器清单" width="180">
                        <a:grid autoAppend="false" bindTarget="pur5730_vendor_survey_bidirectional_main_production_tab_ds" height="280" marginWidth="45" navBar="true" width="1000">
                            <a:toolBar>
                                <a:button type="add"/>
                                <a:button type="save"/>
                                <a:button type="delete"/>
                            </a:toolBar>
                            <a:columns>
                                <a:column name="classification_code" align="left" editor="pur5730_bidirectional_main_production_cbb" prompt="分类" renderer="pur5730_bidirectional_main_production_grid_renderer" width="100"/>
                                <a:column name="mp_specification" align="left" editor="pur5730_bidirectional_main_production_tf" prompt="名称及规格" renderer="pur5730_bidirectional_main_production_grid_renderer" width="100"/>
                                <a:column name="suppliers" align="left" editor="pur5730_bidirectional_main_production_tf" prompt="供应商" renderer="pur5730_bidirectional_main_production_grid_renderer" width="100"/>
                                <a:column name="nums" align="left" editor="pur5730_bidirectional_main_production_nf" prompt="数量" renderer="pur5730_bidirectional_main_production_grid_renderer" width="120"/>
                                <a:column name="admission_time" align="left" editor="pur5730_bidirectional_main_production_dp" prompt="入场时间" renderer="pur5730_bidirectional_main_production_grid_renderer" width="120"/>
                            </a:columns>
                            <a:editors>
                                <a:textField id="pur5730_bidirectional_main_production_tf"/>
                                <a:numberField id="pur5730_bidirectional_main_production_nf"/>
                                <a:datePicker id="pur5730_bidirectional_main_production_dp"/>
                                <a:comboBox id="pur5730_bidirectional_main_production_cbb"/>
                            </a:editors>
                        </a:grid>
                    </a:tab>
                </a:tabs>
            </a:tabPanel>
        </a:screenBody>
        <script><![CDATA[
            function diaplayTab(id) {
                var ui = document.getElementById(id);
                ui.style.display = "none";
            }
            
            function init() {
                debugger;
                var tab_records = $('pur5730_vendor_survey_bidirectional_tabs_ds').getAll();
                var length = tab_records.length - 1;
                for (var i = 0;i <= length;i++) {
                    if (tab_records[length - i].get('survey_tab_code') == '10_BASIC') {
                        if (tab_records[length - i].get('enabled_flag') == 'N') {
                            diaplayTab("vendor_survey_bidirectional_basic_info_tab_id");
                        }
                    } else if (tab_records[length - i].get('survey_tab_code') == '20_CAPACITY') {
                        if (tab_records[length - i].get('enabled_flag') == 'N') {
                            diaplayTab("vendor_survey_bidirectional_capacity_tab_id");
                        }
                    } else if (tab_records[length - i].get('survey_tab_code') == '30_DISMANTL') {
                        if (tab_records[length - i].get('enabled_flag') == 'N') {
                            diaplayTab("vendor_survey_bidirectional_dismantl_tab_id");
                        }
                    } else if (tab_records[length - i].get('survey_tab_code') == '40_VENDORS') {
                        if (tab_records[length - i].get('enabled_flag') == 'N') {
                            diaplayTab("vendor_survey_bidirectional_vendors_information_tab_id");
                        }
                    } else if (tab_records[length - i].get('survey_tab_code') == '50_SUPPLIES') {
                        if (tab_records[length - i].get('enabled_flag') == 'N') {
                            diaplayTab("vendor_survey_bidirectional_suppliers_information_tab_id");
                        }
                    } else if (tab_records[length - i].get('survey_tab_code') == '60_BUSINESS') {
                        if (tab_records[length - i].get('enabled_flag') == 'N') {
                            diaplayTab("vendor_survey_bidirectional_main_business_tab_id");
                        }
                    } else if (tab_records[length - i].get('survey_tab_code') == '70_OPERATING') {
                        if (tab_records[length - i].get('enabled_flag') == 'N') {
                            diaplayTab("vendor_survey_bidirectional_operating_income_tab_id");
                        }
                    } else if (tab_records[length - i].get('survey_tab_code') == '80_PRODUCTION') {
                        if (tab_records[length - i].get('enabled_flag') == 'N') {
                            diaplayTab("vendor_survey_bidirectional_main_production_tab_id");
                        }
                    }
                }
            }
            
            init();
        ]]></script>
    </a:view>
</a:screen>
