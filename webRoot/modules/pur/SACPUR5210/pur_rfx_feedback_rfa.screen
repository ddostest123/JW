<?xml version="1.0" encoding="UTF-8"?>
<!--
    $Author: WangQiaosen  
    $Date: 2013-6-29 下午3:55:28  
    $Revision: 1.0  
    $Purpose: 
-->
<a:screen xmlns:a="http://www.aurora-framework.org/application" xmlns:s="aurora.plugin.script" trace="true">
    <a:init-procedure>
        <!-- <s:server-script import="fnd_flex_dynamic_tools.js"/>
        <s:server-script import="fnd_flex_dynamic_page_main.js"/>
        <s:server-script import="fnd_flex_dynamic_grid_expanded.js"/> -->
        <!-- <a:model-query defaultWhereClause="v.config_classify_code = &apos;RFX&apos; AND v.config_item_code = &apos;RFX_14&apos;" fetchAll="true" model="public.get_fnd_config_center_coop_bg_item_value" rootPath="bg_item_rfx_14"/> -->
        <a:model-query defaultWhereClause="rfx_header_id = ${/parameter/@rfx_header_id}" fetchAll="true" model="public.get_fnd_config_center_owner_bg_item_value" rootPath="bg_item_rfx_14"/>
        <a:model-query defaultWhereClause="feedback_header_id = ${/parameter/@feedback_header_id}" fetchAll="true" model="pur.SACPUR5210.pur_rfx_feedback_rfq_header" rootPath="header_record_rp"/>
        <a:model-query fetchAll="true" model="public.currency_list" rootPath="pur5130_currency_source"/>
        <a:model-query fetchAll="true" model="cux.KINWONG.public.get_0407_category_id" rootPath="get_0407_category_id"/>
    </a:init-procedure>
    <a:view>
        <div/>
        <a:link id="sacpur52105_rfx_feedback_rfa_reload_link" url="${/request/@context_path}/modules/pur/SACPUR5210/pur_rfx_feedback_rfa.screen"/>
        <a:link id="sacpur52105_rfx_feedback_save_link" url="${/request/@context_path}/modules/pur/SACPUR5210/pur_rfx_feedback_save.svc"/>
        <a:link id="sacpur52105_rfx_feedback_submit_link" url="${/request/@context_path}/modules/pur/SACPUR5210/pur_rfx_feedback_submit.svc"/>
        <a:link id="sacpur52105_rfx_feedback_vendor_quote_edit_link" url="${/request/@context_path}/modules/pur/SACPUR5210/pur_rfx_feedback_vendor_quote_edit.screen"/>
        <a:link id="sacpur52105_rfx_feedback_vendor_quote_view_link" url="${/request/@context_path}/modules/pur/SACPUR5210/pur_rfx_feedback_vendor_quote_view.screen"/>
        <a:link id="sacpur52105_rfx_quote_import_link" url="${/request/@context_path}/modules/pur/SACPUR5210/pur_rfx_quote_import.screen"/>
        <a:link id="template_link" url="${/request/@context_path}/modules/cux/KINWONG/rfx/rfx5020/rfx5020_template_print.screen"/>
        <!-- 阶梯报价 -->
        <a:link id="pur5220_rfxLadderQuotation_link" url="${/request/@context_path}/modules/pur/SACPUR5210/pur_rfx_ladder_quotation.screen"/>
        <a:link id="pur5220_rfxLadderQuotationView_link" url="${/request/@context_path}/modules/pur/SACPUR5210/pur_rfx_ladder_quotation_view.screen"/>
        <a:link id="sacpur5210_rfxLadderQuotationDefaultPrice_link" model="pur.SACPUR5210.pur_rfx_ladder_quotation" modelaction="execute"/>
        <a:link id="sacpur52105_rfx_item_note_view_link" url="${/request/@context_path}/modules/pur/SACPUR5210/pur_rfx_item_note_view_rfa.screen"/>
        <script src="${/request/@context_path}/javascripts/countdown/jquery-1.8.3.min.js" type="text/javascript"/>
        <script src="${/request/@context_path}/javascripts/countdown/jquery.classycountdown.js" type="text/javascript"/>
        <script src="${/request/@context_path}/javascripts/countdown/jquery.knob.js" type="text/javascript"/>
        <script src="${/request/@context_path}/javascripts/countdown/jquery.throttle.js" type="text/javascript"/>
        <link href="${/request/@context_path}/css/pur/jquery.classycountdown.css" rel="stylesheet" type="text/css"/>
        <style><![CDATA[
  .circle {
 margin-left:20px;
 margin-top:5px;
 width:365px;
 height:170px;
/*  background:#E2F0D9; */
 
 font-size:18px;
 font-family: "Helvetica Neue", Helvetica, Microsoft Yahei, Hiragino Sans GB, WenQuanYi Micro Hei, sans-serif;
}
#countdown4{
   /*  background:#E2F0D9; */
}
 .ClassyCountdownDemo {
     margin:0 auto; 
     max-width:330px; 
     width:calc(100%); 
     padding:15px;
     display:block 
}     
        ]]></style>
        <script><![CDATA[
            var left_time;
            var jq = jQuery.noConflict();
            var sacpur52105_hidden_display = '******';
            
            function sacpur52105RfxFeedbackRfqSave() {
                var item_ds = $('sacpur52105_rfx_feedback_rfa_line_ds');
                if (!item_ds.validate()) {
                    return;
                }
                
                var header_rec = $('sacpur52105_rfx_feedback_rfa_header_ds').getCurrentRecord();
                if (!$('sacpur52105_rfx_feedback_rfa_header_ds').validate()) {
                    return;
                }                
                
                var item_rec = item_ds.getAll();
                for (i = 0;i < item_rec.length;i++) {
                    item_rec[i].dirty = true;
                }
                var data = {};
                data['items'] = item_ds.getJsonData();
                
                data['feedback_expiry_date_from'] = header_rec.get('feedback_expiry_date_from');
                data['feedback_expiry_date_to'] = header_rec.get('feedback_expiry_date_to');                
                
                Aurora.Masker.mask($('sacpur52105_rfx_feedback_rfa_window').wrap, '${l:LOADING}');
                Aurora.request({
                    url: $('sacpur52105_rfx_feedback_save_link').getUrl(),
                    para: data,
                    success: function(result) {
                        $('sacpur52105_rfx_feedback_rfa_header_ds').query();                        
                        sacpur52101RfxFeedbackRfaCountsAndToalPrice();
                        $('sacpur52105_rfx_feedback_rfa_line_ds').query();
                        Aurora.Masker.unmask($('sacpur52105_rfx_feedback_rfa_window').wrap);
                    },
                    failure: function() {
                        Aurora.Masker.unmask($('sacpur52105_rfx_feedback_rfa_window').wrap);
                        return;
                    },
                    error: function() {
                        Aurora.Masker.unmask($('sacpur52105_rfx_feedback_rfa_window').wrap);
                        return;
                    }
                });
            }
            
            function sacpur52105RfxFeedbackRfqSubmit() {
                var header_ds = $('sacpur52105_rfx_feedback_rfa_header_ds');
                var item_ds = $('sacpur52105_rfx_feedback_rfa_line_ds');
                if (!item_ds.validate()) {
                    return;
                }
                var header_record = header_ds.getCurrentRecord();
                var feedback_header_id = header_record.get('feedback_header_id');
                var status = header_record.get('status');
            
                var item_rec = item_ds.getAll();
                for (i = 0;i < item_rec.length;i++) {
                    item_rec[i].dirty = true;
                }
            
                var data = {};
                data.feedback_header_id = feedback_header_id;
                data.status = status;
                data['items'] = item_ds.getJsonData();
                Aurora.Masker.mask($('sacpur52105_rfx_feedback_rfa_window').wrap, '${l:LOADING}');
                Aurora.request({
                    url: $('sacpur52105_rfx_feedback_submit_link').getUrl(),
                    para: data,
                    success: function(result) {
                        Aurora.Masker.unmask($('sacpur52105_rfx_feedback_rfa_window').wrap);
                        Aurora.showMessage('${l:PROMPT}', '${l:SACPUR5210.SUBMITTED_SUCCESSFULLY}');
                        sacpur52105_window_reload();
                    },
                    failure: function() {
                        Aurora.Masker.unmask($('sacpur52105_rfx_feedback_rfa_window').wrap);
                        return;
                    },
                    error: function() {
                        Aurora.Masker.unmask($('sacpur52105_rfx_feedback_rfa_window').wrap);
                        return;
                    }
                });
            }
            
            function sacpur52105_window_reload() {
                $('sacpur52105_rfx_feedback_rfa_header_ds').query();
                $('sacpur52105_rfx_feedback_rfa_line_ds').query();
            }
            
            function sacpur52105RfxFeedbackRfqReturn() {
                $('sacpur52105_rfx_feedback_rfa_window').close();
            }
            
            function sacpur52105_rfx_feedback_rfa_line_ds_update(ds, record, name, value, oldvalue) {
                if (name == 'current_fb_retail_price') {
                    var records = ds.getAll();
                    var head_ds = $('sacpur52105_rfx_feedback_rfa_header_ds');
                    var head_rec = head_ds.getCurrentRecord();
                    var total_amount = 0;
                    for (var i = 0;i < records.length;i++) {
                        var record1 = records[i];
                        var quantity = record1.get('quantity');
                        if (quantity == null) {
                            quantity = 0;
                        }
                        var current_fb_retail_price = record1.get('current_fb_retail_price');
                        if (current_fb_retail_price == null) {
                            current_fb_retail_price = 0;
                        }
                        total_amount = total_amount + quantity * current_fb_retail_price;
                    }
                    head_rec.set('total_amount', total_amount);
                }
                if (name == "abandoned_flag") {
            
                    if (value == 'Y') {
                        Aurora.showConfirm('${l:PROMPT}', '${l:SACPUR5210.ABANDON_QUOTATION_CONFIRM}', function() {
            
                            record.getMeta().getField('current_fb_retail_price').setReadOnly(true);
                            record.getMeta().getField('current_fb_retail_price').setRequired(false);
                            record.set('current_fb_retail_price', '');
                            record.set('promised_date', '');
                            record.set('current_delivery_cycle', '');
                            record.set('feedback_expiry_date_from', '');
                            record.set('feedback_expiry_date_to', '');
                            record.set('trans_cost', '');
                            record.getMeta().getField('promised_date').setRequired(false);
                            record.getMeta().getField('promised_date').setReadOnly(true);
            
                            record.getMeta().getField('current_delivery_cycle').setRequired(false);
                            record.getMeta().getField('current_delivery_cycle').setReadOnly(true);
            
                            record.getMeta().getField('feedback_expiry_date_from').setRequired(false);
                            record.getMeta().getField('feedback_expiry_date_from').setReadOnly(true);
            
                            record.getMeta().getField('feedback_expiry_date_to').setRequired(false);
                            record.getMeta().getField('feedback_expiry_date_to').setReadOnly(true);
            
                            record.getMeta().getField('current_fb_wholesale_price').setReadOnly(true);
            
            
                            record.getMeta().getField('trans_cost').setRequired(false);
                            
                            record.getMeta().getField('warranty_period').setRequired(false);
                            record.getMeta().getField('warranty_period').setReadOnly(true);
                            
                            record.getMeta().getField('pur_cycle').setRequired(false);
                            record.getMeta().getField('pur_cycle').setReadOnly(true);
                            
                            record.getMeta().getField('spec').setRequired(false);
                            record.getMeta().getField('spec').setReadOnly(true);
                            
                            record.getMeta().getField('place_of_product').setRequired(false);
                            record.getMeta().getField('place_of_product').setReadOnly(true);
                            
                            record.getMeta().getField('brand').setRequired(false);
                            record.getMeta().getField('brand').setReadOnly(true);
                        }, function() {
                            record.set('abandoned_flag', 'N');
                        });
                    } else {
                        record.getMeta().getField('current_fb_retail_price').setReadOnly(false);
            
                        record.getMeta().getField('promised_date').setRequired(false);
                        record.getMeta().getField('promised_date').setReadOnly(false);
            
                        record.getMeta().getField('current_delivery_cycle').setRequired(false);
                        record.getMeta().getField('current_delivery_cycle').setReadOnly(false);
            
                        record.getMeta().getField('feedback_expiry_date_from').setRequired(false);
                        record.getMeta().getField('feedback_expiry_date_from').setReadOnly(true);
            
                        record.getMeta().getField('feedback_expiry_date_to').setRequired(false);
                        record.getMeta().getField('feedback_expiry_date_to').setReadOnly(true);
            
            
            
                        record.getMeta().getField('current_fb_wholesale_price').setReadOnly(false);
                        var unit_price_configure = record.get('unit_price_configure');
                        var trans_cost_flag = record.get('trans_cost_flag');
                        if (unit_price_configure == 'Y') {
                            record.getMeta().getField('current_fb_retail_price').setRequired(true);
                            record.getMeta().getField('current_fb_retail_price').setReadOnly(false);
                        }
                        if (trans_cost_flag == 'Y') {
                            record.getMeta().getField('trans_cost').setRequired(true);
                            record.getMeta().getField('trans_cost').setReadOnly(false);
                        }
                    }
                }
                if (name == "tax_included_flag") {
                    if (value == 'N' && oldvalue == 'Y') {
                        record.set('tax_type_id', '');
                        record.set('tax_type_code', '');
                        record.set('tax_type_desc', '');
                        record.set('tax_type_rate', '');
                    }
                }
            }
            
            function sacpur52105_rfx_feedback_rfa_line_ds_load(ds) {
                var records = ds.getAll();
                var head_ds = $('sacpur52105_rfx_feedback_rfa_header_ds');
                var head_rec = head_ds.getCurrentRecord();
                var total_amount = 0;
                var feedback_counts = 0;
                var feedback_total_price = 0;
                for (var i = 0;i < records.length;i++) {
                    var record = records[i];
                    if (!Aurora.isEmpty(record.get('current_fb_retail_price'))) {
                        feedback_counts++; //报价行数
                    }
                    var quantity = record.get('quantity');
                    if (quantity == null) {
                        quantity = 0;
                    }
                    var current_fb_retail_price = record.get('current_fb_retail_price');
                    if (current_fb_retail_price == null) {
                        current_fb_retail_price = 0;
                    }
                    feedback_total_price = feedback_total_price + (current_fb_retail_price * quantity); //报价总价
                    total_amount = total_amount + quantity * current_fb_retail_price;
                    var abandoned_flag = record.get('abandoned_flag');
                    if (abandoned_flag == 'Y') {
                        record.getMeta().getField('current_fb_retail_price').setRequired(false);
                        record.getMeta().getField('current_fb_retail_price').setReadOnly(true);
            
                        record.getMeta().getField('promised_date').setRequired(false);
                        record.getMeta().getField('promised_date').setReadOnly(true);
            
                        record.getMeta().getField('current_delivery_cycle').setRequired(false);
                        record.getMeta().getField('current_delivery_cycle').setReadOnly(true);
            
                        record.getMeta().getField('feedback_expiry_date_from').setRequired(false);
                        record.getMeta().getField('feedback_expiry_date_from').setReadOnly(true);
            
                        record.getMeta().getField('feedback_expiry_date_to').setRequired(false);
                        record.getMeta().getField('feedback_expiry_date_to').setReadOnly(true);
                        
                        record.getMeta().getField('abandoned_flag').setReadOnly(true);
            
                        record.getMeta().getField('current_fb_wholesale_price').setReadOnly(true);
                    }
                    var tax_type_rate = record.getField('tax_type_rate');
                    var owner_business_group = record.get('owner_business_group');
                    tax_type_rate.setLovPara('business_group', owner_business_group);
                    
            
                    //配置报价有效期
                    var feedback_expiry_date_configure = record.get('feedback_expiry_date_configure');
                    if (feedback_expiry_date_configure == 'required' && abandoned_flag != 'Y') {
                        record.getMeta().getField('feedback_expiry_date_from').setRequired(false);
                        record.getMeta().getField('feedback_expiry_date_to').setRequired(false);
                    } else if (feedback_expiry_date_configure == 'not_required') {
                        record.getMeta().getField('feedback_expiry_date_from').setRequired(false);
                        record.getMeta().getField('feedback_expiry_date_to').setRequired(false);
                    } else if (feedback_expiry_date_configure == 'not_maintain') {
                        record.getMeta().getField('feedback_expiry_date_from').setRequired(false);
                        record.getMeta().getField('feedback_expiry_date_to').setRequired(false);
                        record.getMeta().getField('feedback_expiry_date_from').setReadOnly(true);
                        record.getMeta().getField('feedback_expiry_date_to').setReadOnly(true);
                    }
            
                    //开启配置项则显示税前净价、税前金额、税额、总额字段
                    var item_value = '${/model/bg_item_rfx_14/record/@bg_config_item_value}';
                    if (!Aurora.isEmpty(item_value) && item_value == "N") {
                        $('sacpur52105_rfx_feedback_rfa_line_grid').hideColumn('net_price');
                        $('sacpur52105_rfx_feedback_rfa_line_grid').hideColumn('net_amount');
                        $('sacpur52105_rfx_feedback_rfa_line_grid').hideColumn('tax_amount');
                        $('sacpur52105_rfx_feedback_rfa_line_grid').hideColumn('total_amounts');
                    } else if (Aurora.isEmpty(item_value)) {
                        $('sacpur52105_rfx_feedback_rfa_line_grid').hideColumn('net_price');
                        $('sacpur52105_rfx_feedback_rfa_line_grid').hideColumn('net_amount');
                        $('sacpur52105_rfx_feedback_rfa_line_grid').hideColumn('tax_amount');
                        $('sacpur52105_rfx_feedback_rfa_line_grid').hideColumn('total_amounts');
                    }
            
                    //配置报价单价
                    var unit_price_configure = record.get('unit_price_configure');
                    if (unit_price_configure == 'N') {
                        record.getMeta().getField('current_fb_retail_price').setRequired(false);
                    } else if (unit_price_configure == 'Y' && abandoned_flag != 'Y') {
                        record.getMeta().getField('current_fb_retail_price').setRequired(true);
                    }
            		if (Aurora.isEmpty(record.get('quotation_id'))) {
                        if ('${/model/get_0407_category_id/record/@category_udf_id}' == record.get('p_category_udf_id') || '${/model/get_0407_category_id/record/@category_udf_id}' == record.get('pp_category_udf_id')) {
                            if (abandoned_flag == 'Y'){
                                record.getMeta().getField('brand').setRequired(false);
	                            record.getMeta().getField('place_of_product').setRequired(false);
	                            record.getMeta().getField('spec').setRequired(false);
	                            record.getMeta().getField('pur_cycle').setRequired(false);
	                            record.getMeta().getField('warranty_period').setRequired(false);
	                            
	                            record.getMeta().getField('brand').setReadOnly(true);
	                            record.getMeta().getField('place_of_product').setReadOnly(true);
	                            record.getMeta().getField('spec').setReadOnly(true);
	                            record.getMeta().getField('pur_cycle').setReadOnly(true);
	                            record.getMeta().getField('warranty_period').setReadOnly(true);
                            }else{
	                            record.getMeta().getField('brand').setRequired(true);
	                            record.getMeta().getField('place_of_product').setRequired(true);
	                            record.getMeta().getField('spec').setRequired(true);
	                            record.getMeta().getField('pur_cycle').setRequired(true);
	                            record.getMeta().getField('warranty_period').setRequired(true);
	                            
	                            record.getMeta().getField('brand').setReadOnly(false);
	                            record.getMeta().getField('place_of_product').setReadOnly(false);
	                            record.getMeta().getField('spec').setReadOnly(false);
	                            record.getMeta().getField('pur_cycle').setReadOnly(false);
	                            record.getMeta().getField('warranty_period').setReadOnly(false);
                            }
                        }
                    }else{
                        record.getMeta().getField('current_fb_retail_price').setRequired(false);
                    }
                }
                head_rec.set('total_amount', total_amount);
                head_rec.set('feedback_counts', feedback_counts);
                head_rec.set('feedback_total_price', feedback_total_price);
            }
            
            function sacpur52105_header_status_check() {
                var record = $('sacpur52105_rfx_feedback_rfa_header_ds').getAt(0);
                if (Aurora.isEmpty(record)) {
                    return false;
                }
                var status = record.get('status');
                if (status == 'SUBMITTED') {
                    return false;
                }
                return true;
            }
            
            function bargain_price_check(record) {
                var bargain_price = record.get("valid_bargain_price");
                if (Aurora.isEmpty(bargain_price)) {
                    return false;
                }
                return true;
            
            }
            
            
            function sacpur52105_date_dp_ef(record, name) {
                var abandoned_flag = record.get('abandoned_flag');
                if (abandoned_flag == "Y" || !sacpur52105_header_status_check() || !bargain_price_check(record)) {
                    return '';
                }
                return 'sacpur52105_date_dp';
            }
            
            function sacpur52105_current_fb_wholesale_price_ef(record, name) {
                var abandoned_flag = record.get('abandoned_flag');
                if (abandoned_flag == "Y" || !sacpur52105_header_status_check() || !bargain_price_check(record)) {
                    return '';
                }
                return 'sacpur52105_current_fb_wholesale_price_nf';
            }
            
            function sacpur52105_current_fb_reason_ef(record, name) {
                var abandoned_flag = record.get('abandoned_flag');
                var trans_cost_flag = record.get('trans_cost_flag');
                if (abandoned_flag == 'Y' || !sacpur52105_header_status_check() || !bargain_price_check(record) || trans_cost_flag != 'Y') {
                    return '';
                }
                return 'sacpur52105_current_fb_reason_tf';
            }
            
            function sacpur52105_rfx_feedback_rfa_rank_grid_refresh() {
                var record = $('sacpur52105_rfx_feedback_rfa_line_ds').getCurrentRecord();
                var ds = $('sacpur52105_rfx_feedback_rfa_rank_ds');
                ds.setQueryParameter('rfx_header_id', record.get('rfx_header_id'));
                ds.setQueryParameter('rfx_round', record.get('rfx_round'));
                ds.setQueryParameter('rfx_version', record.get('rfx_version'));
                ds.setQueryParameter('item_id', record.get('item_id'));
                ds.query();
            }
            
            function sacpur52105_rfx_feedback_rfa_record_grid_refresh() {
                var record = $('sacpur52105_rfx_feedback_rfa_line_ds').getCurrentRecord();
                var ds = $('sacpur52105_rfx_feedback_rfa_record_ds');
                ds.setQueryParameter('rfx_header_id', record.get('rfx_header_id'));
                ds.setQueryParameter('rfx_round', record.get('rfx_round'));
                ds.setQueryParameter('rfx_version', record.get('rfx_version'));
                ds.setQueryParameter('item_id', record.get('item_id'));
                ds.query();
            }
            
            function sacpur52105_rfx_feedback_rfa_line_render(value, record, name) {
                var open_rule = record.get('open_rule'); //公开规则
                var auction_rule = record.get('auction_rule'); //竞价规则
                var ranking_rule = record.get('ranking_rule'); //排名规则
                var auction_ranking = record.get('auction_ranking'); //竞价排名
            
                if (name == 'current_rank') {
                    if (auction_ranking == 'OPEN_COUNT_OPEN_RANK' || auction_ranking == 'HIDE_COUNT_OPEN_RANK') {
                        return value;
                    } else if (auction_ranking == 'OPEN_COUNT_HIDE_RANK' || auction_ranking == 'HIDE_COUNT_HIDE_RANK') {
                        return sacpur52105_hidden_display;
                    }
                }
            
                if (name == 'feedback_by_count') {
                    if (auction_ranking == 'OPEN_COUNT_OPEN_RANK' || auction_ranking == 'OPEN_COUNT_HIDE_RANK') {
                        return value;
                    } else if (auction_ranking == 'HIDE_COUNT_OPEN_RANK' || auction_ranking == 'HIDE_COUNT_HIDE_RANK') {
                        return sacpur52105_hidden_display;
                    }
                }
            }
            
            function sacpur52105_rfx_feedback_rfa_record_render(value, record, name) {
                var open_rule = record.get('open_rule'); //公开规则
                var auction_rule = record.get('auction_rule'); //竞价规则
                var ranking_rule = record.get('ranking_rule'); //排名规则
                var auction_ranking = record.get('auction_ranking'); //竞价排名
                if (open_rule == 'HIDDEN_IDENTITY_HIDDEN_QUOTN') { //隐藏身份隐藏报价
                    if (name == 'vendor_desc' || name == 'feedback_retail_price') {
                        return sacpur52105_hidden_display;
                    }
                } else if (open_rule == 'HIDDEN_IDENTITY_OPEN_QUOTN') { //隐藏身份公开报价
                    if (name == 'vendor_desc') {
                        return sacpur52105_hidden_display;
                    } else if (name == 'feedback_retail_price') {
                        return formatNumber2(value, 8);
                    }
                } else if (open_rule == 'OPEN_IDENTITY_HIDDEN_QUOTN') { //公开身份隐藏报价
                    if (name == 'vendor_desc') {
                        return value;
                    } else if (name == 'feedback_retail_price') {
                        return sacpur52105_hidden_display;
                    }
            
                } else if (open_rule == 'OPEN_IDENTITY_OPEN_QUOTN') { //公开身份公开报价
                    if (name == 'vendor_desc') {
                        return value;
                    } else if (name == 'feedback_retail_price') {
                        return formatNumber2(value, 8);
                    }
                }
            }
            
            function sacpur52105_rfx_feedback_rfa_rank_render(value, record, name) {
                var open_rule = record.get('open_rule'); //公开规则
                var auction_rule = record.get('auction_rule'); //竞价规则
                var ranking_rule = record.get('ranking_rule'); //排名规则
                var auction_ranking = record.get('auction_ranking'); //竞价排名
                if (open_rule == 'HIDDEN_IDENTITY_HIDDEN_QUOTN') { //隐藏身份隐藏报价
                    if (name == 'vendor_desc' || name == 'valid_fb_retail_price') {
                        return sacpur52105_hidden_display;
                    }
                } else if (open_rule == 'HIDDEN_IDENTITY_OPEN_QUOTN') { //隐藏身份公开报价
                    if (name == 'vendor_desc') {
                        return sacpur52105_hidden_display;
                    } else if (name == 'valid_fb_retail_price') {
                        return formatNumber2(value, 8);
                    }
                } else if (open_rule == 'OPEN_IDENTITY_HIDDEN_QUOTN') { //公开身份隐藏报价
                    if (name == 'vendor_desc') {
                        return value;
                    } else if (name == 'valid_fb_retail_price') {
                        return sacpur52105_hidden_display;
                    }
                } else if (open_rule == 'OPEN_IDENTITY_OPEN_QUOTN') { //公开身份公开报价
                    if (name == 'vendor_desc') {
                        return value;
                    } else if (name == 'valid_fb_retail_price') {
                        return formatNumber2(value, 8);
                    }
                }
            }
            
            function formatNumber2(value, decimalprecision) {
                if (Ext.isEmpty(value)) return '';
            
                value = String(value).replace(/,/g, '');
                if (isNaN(value)) return '';
                if (decimalprecision || decimalprecision === 0)
            
            
                var point_value = value.split('.');
                var in_length = (point_value.length == 2) ? '.' + point_value[1] : '';
            
            
                if (in_length.length - 1 < decimalprecision) {
            
                    decimalprecision = in_length.length - 1
                };
                if (in_length.length == 0) {
                    decimalprecision = 0;
                }
            
                value = Number(value).toFixed(decimalprecision);
            
                var ps = value.split('.');
                var sub = (ps.length == 2) ? '.' + ps[1] : '';
            
            
                var whole = ps[0];
                var r = /(\d+)(\d{3})/;
                while (r.test(whole)) {
                    whole = whole.replace(r, '$1' + ',' + '$2');
                }
            
                Math.round()
                v = whole + sub;
                return v;
            }
            
            function pur52105_formatNumber_render(value, record, name) {
                return formatNumber2(value, 8);
            }
            
            
            function sacpur5210_selectTab_fun(tabPanel, index, tab) {
                if (index == 1) {
                    $('sacpur52105_rfx_feedback_rfa_line_item_ds').query();
                }
            }
            
            //比较两个日期的大小
            
            function sacpur5210_compareDate(start, end) {
            
                if (typeof(start) == 'string') {
                    start = new Date(start.replace(/-/g, "/"));
                }
            
                if (typeof(end) == 'string') {
                    end = new Date(end.replace(/-/g, "/"));
                }
            
                if (start > end) {
                    return false;
                }
                return true;
            }
            
            
            function sacpur5210_dateValidator(record, name, value) {
            
            
            
                if (name == 'feedback_expiry_date_from' || name == 'feedback_expiry_date_to') {
                    var feedback_expiry_date_from = record.get('feedback_expiry_date_from');
                    var feedback_expiry_date_to = record.get('feedback_expiry_date_to');
                    if ( !! feedback_expiry_date_to) {
                        if (!sacpur5210_compareDate(feedback_expiry_date_from, feedback_expiry_date_to)) {
                            return '${l:SACPUR5210.CANNOT_BE_LATER_THE_END_TIME}';
                        }
                    }
                    return true;
                }
            
                if (name == 'promised_date') {
                    var promised_date = record.get('promised_date');
                    var sysdate = new Date();
            
                    if ( !! promised_date) {
                        if (!sacpur5210_compareDate(sysdate, promised_date)) {
                            return '${l:SACPUR5210.CANNOT_BE_EARLIER_THE_CURRENT_TIME}';
                        }
                    }
                    return true;
                }
            }
            
            function sacpur52105_rfxFeedbackVendorQuote_renderFun(value, record, name) {
                var quote_header_id = record.get('quote_header_id');
                var abandoned_flag = record.get('abandoned_flag');
            
                if (abandoned_flag == 'N' && !Ext.isEmpty(quote_header_id)) {
                    if (sacpur52101_line_status_check(record)) {
                        return '<a href="javascript:sacpur52105_rfxFeedbackVendorQuote_openEditFun(' + record.get('feedback_line_id') + ',' + quote_header_id + ')">${l:PUR_RFX_QUOTE_TITLE}</a>';
                    } else {
                        return '<a href="javascript:sacpur52105_rfxFeedbackVendorQuote_openViewFun(' + record.get('feedback_line_id') + ',' + quote_header_id + ')">${l:PUR_RFX_QUOTE_TITLE}</a>';
                    }
                }
                return '';
            }
            
            function sacpur52101_line_status_check(record) {
                var status = record.get('status');
                if (status == 'SUBMITTED') {
                    return false;
                }
                return true;
            }
            
            
            function sacpur52105_rfxFeedbackVendorQuote_openEditFun(feedback_line_id, quote_header_id) {
                new Aurora.Window({
                    url: $('sacpur52105_rfx_feedback_vendor_quote_edit_link').getUrl() + '?feedback_line_id=' + feedback_line_id + '&quote_header_id=' + quote_header_id,
                    title: '${l:PUR_RFX_QUOTE_TITLE}',
                    id: 'sacpur5210_rfx_feedback_vendor_quote_edit_window',
                    width: 900,
                    height: 430
                });
            }
            
            function sacpur52105_rfxFeedbackVendorQuote_openViewFun(feedback_line_id, quote_header_id) {
                new Aurora.Window({
                    url: $('sacpur52105_rfx_feedback_vendor_quote_view_link').getUrl() + '?feedback_line_id=' + feedback_line_id + '&quote_header_id=' + quote_header_id,
                    title: '${l:PUR_RFX_QUOTE_TITLE}',
                    id: 'sacpur5210_rfx_feedback_vendor_quote_view_window',
                    width: 900,
                    height: 430
                });
            }
            
            
            function sacpur5210_rfx_quote_header_go_import() {
                var quote_header_id = '${/parameter/@feedback_header_id}';
                new Aurora.Window({
                    url: $('sacpur52105_rfx_quote_import_link').getUrl() + '?quote_header_id=' + quote_header_id,
                    title: '${l:SACPUR5210.QUOTATION_IMPORT}',
                    id: 'sacpur5210_rfx_quote_header_go_import_window',
                    fullScreen: true
                }).on('close', function() {
                    $('sacpur52105_rfx_feedback_rfa_line_ds').query();
                });
            }
            
            //阶梯报价
            
            function pur5220_rfxLadderQuotationFunction(feedback_line_id, ladder_edit_flag) {
                new Aurora.Window({
                    url: $('pur5220_rfxLadderQuotation_link').getUrl() + '?feedback_line_id=' + feedback_line_id + '&ladder_edit_flag=' + ladder_edit_flag,
                    title: '${l:SACPUR5210.LADDER_QUOTES}',
                    id: 'pur5220_rfxLadderQuotation_window',
                    width: 500,
                    height: 300
                }).on('beforeclose', function() {
                    sacpur5210_rfxLadderQuotationDefaultPriceFunction();
                });
            }
            
            function pur5220_rfxLadderQuotationViewFunction(feedback_line_id) {
                new Aurora.Window({
                    url: $('pur5220_rfxLadderQuotationView_link').getUrl() + '?feedback_line_id=' + feedback_line_id,
                    title: '${l:SACPUR5210.LADDER_QUOTES}',
                    id: 'pur5220_rfxLadderQuotationView_window',
                    width: 500,
                    height: 300
                });
            }
            
            function sacpur52101_rfxLadderQuotationRenderFun(value, record, name) {
                if (name == 'ladder_quotation') {
                    var abandoned_flag = record.get('abandoned_flag');
                    var ladder_edit_flag = record.get('ladder_edit_flag');
                    var ladder_inquiry_flag = record.get('ladder_inquiry_flag');
                    if (ladder_inquiry_flag == 'N') {
                        return '-';
                    }
                    if (abandoned_flag == 'Y') {
                        return '<a href="javascript:pur5220_rfxLadderQuotationViewFunction(' + record.get('feedback_line_id') + ')">${l:SACPUR5210.LADDER_QUOTES}</a>';
                    }
                    return '<a href="javascript:pur5220_rfxLadderQuotationFunction(' + record.get('feedback_line_id') + ',\'' + ladder_edit_flag + '\')">${l:SACPUR5210.LADDER_QUOTES}</a>';
                }
            }
            
            function sacpur5210_rfxLadderQuotationDefaultPriceFunction() {
                Aurora.request({
                    url: $('sacpur5210_rfxLadderQuotationDefaultPrice_link').getUrl(),
                    para: {
                        'feedback_line_id': $('sacpur52105_rfx_feedback_rfa_line_ds').getCurrentRecord().get('feedback_line_id')
                    },
                    success: function(res) {
                        var feedback_price = res.result.feedback_price;
                        if (feedback_price != 'NONE') {
                            $('sacpur52105_rfx_feedback_rfa_line_ds').getCurrentRecord().set('current_fb_retail_price', feedback_price);
                        }
                        return;
                    },
                    failure: function() {
                        return;
                    },
                    error: function() {
                        return;
                    }
                });
            }
            
            //附件上传/下载
            
            function sacpur5210_RfxRender(value, record, name) {
                var rfx_line_item_id = record.get('rfx_line_item_id');
                var feedback_line_id = record.get('feedback_line_id');
                var item_atm_counts = record.get('item_atm_counts');
                var feedback_atm_counts = record.get('feedback_atm_counts');
            
                if (name == "item_attachment") {
                    if (!record.isNew && rfx_line_item_id) {
                        if (item_atm_counts == 0) {
                            return '<a href="javascript:sacpur5210_download_file(' + rfx_line_item_id + ')">${l:FND_ATM_LINES.ATM_DOWNLOAD}</a>';
                        } else {
                            return '<a href="javascript:sacpur5210_download_file(' + rfx_line_item_id + ')">${l:FND_ATM_LINES.ATM_DOWNLOAD}</a>' + '<img src="${/request/@context_path}/images/paperclip.png"/>';
                        }
            
                    }
                }
            
                if (name == "attachment") {
                    if (!record.isNew && feedback_line_id) {
                        if (feedback_atm_counts == 0) {
                            return '<a href="javascript:sacpur5210_upload_file(' + feedback_line_id + ')">${l:PROMPT.UPLOAD_DOWNLOAD}</a>';
                        } else {
                            return '<a href="javascript:sacpur5210_upload_file(' + feedback_line_id + ')">${l:PROMPT.UPLOAD_DOWNLOAD}</a>' + '<img src="${/request/@context_path}/images/paperclip.png"/>';
                        }
                    }
                }
            
                /* if (name == "atm_flag") {
                 if (item_atm_counts > 0 || feedback_atm_counts > 0) {
                 return '<div style="margin-top:3px;margin-left:auto;margin-right:auto;vertical-align:middle;height:20px;line-height:20px;"><img src="${/request/@context_path}/images/paperclip.png"/></div>';
                 }
                 } */
            }
            
            function sacpur5210_download_file(rfx_line_item_id) {
                var url = "${/request/@context_path}/check_uploadFile.screen?table_name=PUR_RFX_LN_ITEMS&header_id=" + rfx_line_item_id;
                new Aurora.Window({
                    url: url,
                    title: '${l:HAP_DOWNLOAD}',
                    id: 'sacpur5210_download_window',
                    width: 500,
                    height: 500
                });
            }
            
            function sacpur5210_upload_file(id) {
                var url = "${/request/@context_path}/attachment_file_upload.screen?table_name=PUR_RFX_FEEDBACK_LINES&pkvalue=" + id;
                new Aurora.Window({
                    url: url,
                    title: '${l:HAP_UPLOAD_TITLE}',
                    id: 'sacpur5210_upload_window',
                    width: 500,
                    height: 500
                });
            }
            
            //Add by Hunter.Wang at 2016-04-14
            //新增报价行数、报价总价字段的计算逻辑
            //报价行数，供应商未放弃报价（已经填写单价）的物品行的数量
            //报价总价，报价行总单价*需求数量，汇总出来的值
            
            function sacpur52101RfxFeedbackRfaCountsAndToalPrice() {
                var ds = $('sacpur52105_rfx_feedback_rfa_header_ds');
                var record = ds.getCurrentRecord();
                var feedback_counts = 0;
                var feedback_total_price = 0;
                var item_ds = $('sacpur52105_rfx_feedback_rfa_line_ds');
                var item_records = item_ds.getAll();
                for (var i = 0;i < item_records.length;i++) {
                    if (!Aurora.isEmpty(item_records[i].get('current_fb_retail_price'))) {
                        feedback_counts++;
                        var current_fb_retail_price = item_records[i].get('current_fb_retail_price') * 1;
                        var quantity = item_records[i].get('quantity') * 1;
                        feedback_total_price = feedback_total_price + (current_fb_retail_price * quantity);
                    }
                }
                record.set('feedback_counts', feedback_counts);
                record.set('feedback_total_price', feedback_total_price);
            }
            
            //Add by Hunter.Wang at 2016-05-03
            //新增报价明细页面，附件上传按钮
            
            function sacpur52101RfxFeedbackRfqHeaderAtmUpload() {
                var url = "${/request/@context_path}/attachment_file_upload.screen?table_name=PUR_RFX_FEEDBACK_HEADER&pkvalue=${/parameter/@feedback_header_id}";
                new Aurora.Window({
                    url: url,
                    title: '${l:HAP_UPLOAD_TITLE}',
                    id: 'sacpur52101_upload_window',
                    width: 500,
                    height: 500
                });
            }
            
            function pur52105_rfxLnItemsGridRenderer(value, record, name) {
                if (name == "item_note") {
                    if (!Aurora.isEmpty(value) && value.length > 20) {
                        return '<a href="javascript:pur52105_rfxLnItemsView()">' + value + '</a>';
                    } else if (!Aurora.isEmpty(value) && value.length <= 20) {
                        return '<div>' + value + '</div>';
                    } else {
                        return '';
                    }
                }
            }
            
            function pur52105_rfxLnItemsView() {
                new Aurora.Window({
                    url: $('sacpur52105_rfx_item_note_view_link').getUrl(),
                    title: '${l:SACPUR5210.VIEW_MATERIAL_DESCRIPTION}',
                    id: 'sacpur52105_rfx_item_note_view_link_window',
                    width: 500,
                    height: 400
                });
            }
            
            
            var feedback_end_time;
            
            
            
            
            var first_load = 'Y';
            
            function pur5210DocmHeader_loadFun(ds) {
                var rec = ds.getAt(0);
                left_time = rec.get('left_time');
                if (first_load == 'Y') {
                    jq('#countdown18').ClassyCountdown({
                        theme: "flat-colors-black",
                        end: jq.now() + left_time,
                    });
                }
                first_load = 'N';
            }
            
            
            function sacpur52101_trans_cost_tf(record, name) {
            
                var abandoned_flag = record.get('abandoned_flag');
                var trans_cost_flag = record.get('trans_cost_flag');
                if (trans_cost_flag != 'Y') {
                    return '';
                }
                return 'sacpur52105_current_fb_reason_tf';
            
            }
            
            function tax_edit_fn(record, name) {
                var tax_modify_flag = record.get('tax_modify_flag');
                if (tax_modify_flag == 'Y') {
                    return 'sacpur52101_tax_included_flag_cb';
                } else {
                    return '';
                }
            }
            
            function tax_edit_fn2(record, name) {
                var tax_modify_flag = record.get('tax_modify_flag');
                if (tax_modify_flag == 'Y') {
                    if (record.get('tax_included_flag') == 'Y') {
                        record.getMeta().getField('tax_type_rate').setRequired(true);
                        return 'sacpur52101_tax_type_rate_lov';
                    } else {
                        record.getMeta().getField('tax_type_rate').setRequired(false);
                        return '';
                    }
                } else {
                    return '';
                }
            }
            //附件下载
            
            function pur52102_upload_renderer(value, record, name) {
                var atm_line_id = record.get('atm_line_id');
                var atm_counts = record.get('atm_counts');
            
                if (name == "attachment") {
                    if (!record.isNew && atm_line_id) {
                        return '<a href="javascript:pur52102_upload_file(' + atm_line_id + ')">${l:FND_ATM_LINES.ATM_DOWNLOAD}</a>';
                    }
                }
            
                if (name == "atm_flag") {
                    if (atm_counts > 0) {
                        return '<div style="margin-top:3px;margin-left:auto;margin-right:auto;vertical-align:middle;height:20px;line-height:20px;"><img src="${/request/@context_path}/images/paperclip.png"/></div>';
                    }
                }
            }
            
            function pur52102_upload_file(id) {
                var url = "${/request/@context_path}/check_uploadFile.screen?table_name=PUR_RFX_HEADERS&header_id=" + id;
                new Aurora.Window({
                    url: url,
                    title: '${l:FND_ATM_LINES.ATM_DOWNLOAD}',
                    id: 'pur52102_upload_window',
                    width: 850,
                    height: 500
                })
                /* .on('beforeclose', function() {
                 $('pur52102_rfx_ln_attachments').query();
                 }); */
            
            }
            
            
            
            function sacpur52101_abandoned_flag_ef(record, name) {
                // if (!sacpur52101_line_status_check(record)) {
                // return '';
                // } else {
                return "sacpur52101_abandoned_flag_chb";
                //  }
            }
            
            function pur52105_rfxFeedbackRfqLineGridRendererNetPrice(value, record, name) {
                //获取“显示净价”配置项的值
                var item_value = '${/model/bg_item_rfx_14/record/@bg_config_item_value}';
            
                if (name == "net_price") {
                    //开启配置项则显示此字段
            
                    if (!Aurora.isEmpty(item_value) && item_value == "Y") {
                        var current_fb_retail_price = record.get("current_fb_retail_price");
                        var tax_type_rate = record.get("tax_type_rate");
                        if (Aurora.isEmpty(current_fb_retail_price)) {
                            current_fb_retail_price = 0;
                        }
                        if (Aurora.isEmpty(tax_type_rate)) {
                            tax_type_rate = 0;
                        }
            
                        //净价=单价/（1+税率%）
                        var net_price = current_fb_retail_price / (1 + (tax_type_rate / 100));
                        net_price = net_price.toFixed(2);
                        return '<div>' + net_price + '</div>';
                    } else {
                        return '';
                    }
                }
                if (name == "net_amount") {
                    //开启配置项则显示此字段
                    if (!Aurora.isEmpty(item_value) && item_value == "Y") {
                        var current_fb_retail_price = record.get("current_fb_retail_price");
                        var tax_type_rate = record.get("tax_type_rate");
                        var quantity = record.get("quantity");
                        if (Aurora.isEmpty(current_fb_retail_price)) {
                            current_fb_retail_price = 0;
                        }
                        if (Aurora.isEmpty(tax_type_rate)) {
                            tax_type_rate = 0;
                        }
            
                        //净价=单价/（1+税率%）
                        var net_price = current_fb_retail_price / (1 + (tax_type_rate / 100));
                        net_price = net_price.toFixed(2);
                        //税前金额=税前净价x数量
                        var net_amount = net_price * quantity;
                        net_amount = net_amount.toFixed(2);
                        return '<div>' + net_amount + '</div>';
                    } else {
                        return '';
                    }
                }
                if (name == "tax_amount") {
                    //开启配置项则显示此字段
                    if (!Aurora.isEmpty(item_value) && item_value == "Y") {
                        var current_fb_retail_price = record.get("current_fb_retail_price");
                        var tax_type_rate = record.get("tax_type_rate");
                        var quantity = record.get("quantity");
                        if (Aurora.isEmpty(current_fb_retail_price)) {
                            current_fb_retail_price = 0;
                        }
                        if (Aurora.isEmpty(tax_type_rate)) {
                            tax_type_rate = 0;
                        }
            
                        //净价=单价/（1+税率%）
                        var net_price = current_fb_retail_price / (1 + (tax_type_rate / 100));
                        net_price = net_price.toFixed(2);
                        //税前金额=税前净价x数量
                        var net_amount = net_price * quantity;
                        net_amount = net_amount.toFixed(2);
                        //税额=（单价-税前净价）x数量
                        var tax_amount = (current_fb_retail_price - net_price) * quantity;
                        tax_amount = tax_amount.toFixed(2);
                        return '<div>' + tax_amount + '</div>';
                    } else {
                        return '';
                    }
                }
                if (name == "total_amounts") {
                    //开启配置项则显示此字段
                    if (!Aurora.isEmpty(item_value) && item_value == "Y") {
                        var current_fb_retail_price = record.get("current_fb_retail_price");
                        var tax_type_rate = record.get("tax_type_rate");
                        var quantity = record.get("quantity");
                        if (Aurora.isEmpty(current_fb_retail_price)) {
                            current_fb_retail_price = 0;
                        }
                        if (Aurora.isEmpty(tax_type_rate)) {
                            tax_type_rate = 0;
                        }
            
                        //净价=单价/（1+税率%）
                        var net_price = current_fb_retail_price / (1 + (tax_type_rate / 100));
                        net_price = net_price.toFixed(2);
                        //税前金额=税前净价x数量
                        var net_amount = net_price * quantity;
                        //税额=（单价-税前净价）x数量
                        var tax_amount = (current_fb_retail_price - net_price) * quantity;
                        //总额=税前金额+税额
                        var total_amounts = net_amount + tax_amount;
                        total_amounts = total_amounts.toFixed(2);
                        return '<div>' + total_amounts + '</div>';
                    } else {
                        return '';
                    }
                }
                if (name == 'quotation_detail') {
                    var header_rec = $('sacpur52105_rfx_feedback_rfa_header_ds').getCurrentRecord();
                    if (!Aurora.isEmpty(header_rec.get('quotation_id'))) {
                        return '<a href="javascript:pur_quotation_detail(' + record.get('es_inv_org_id') + ')">报价</a>';
                    } else {
                        return '';
                    }
                }
            }
            
            function pur_quotation_detail(inv_org_id) {
                var header_rec = $('sacpur52105_rfx_feedback_rfa_header_ds').getCurrentRecord();
                var url = $('template_link').getUrl() + '?quotation_id=' + header_rec.get('quotation_id') + '&vendor_id=' + header_rec.get('coop_company_id') + '&currency_code=' + header_rec.get('currency_code') + '&business_unit_id=' + inv_org_id;
                new Aurora.Window({
                    id: 'rfx5010_template_win',
                    title: '模板',
                    url: url,
                    fullScreen: true
                });
            }
        ]]></script>
        <a:dataSets>
            <a:dataSet id="sacpur52105_rfx_feedback_rfa_header_ds" model="pur.SACPUR5210.pur_rfx_feedback_rfq_header" queryUrl="${/request/@context_path}/autocrud/pur.SACPUR5210.pur_rfx_feedback_rfq_header/query?feedback_header_id=${/parameter/@feedback_header_id}">
                <a:datas dataSource="/model/header_record_rp"/>
                <a:fields>
                    <a:field name="tax_included_flag" readOnly="true"/>
                    <a:field name="sealed_bid_flag" readOnly="true"/>
                    <a:field name="feedback_expiry_date_from" required="true" requiredMessage="${l:PUR5210.FEEDBACK_EXPIRY_DATE}" validator="sacpur5210_dateValidator"/>
                    <a:field name="feedback_expiry_date_to" required="true" requiredMessage="${l:PUR5210.FEEDBACK_EXPIRY_DATE}" validator="sacpur5210_dateValidator"/>
                </a:fields>
                <a:events>
                    <a:event name="load" handler="pur5210DocmHeader_loadFun"/>
                </a:events>
            </a:dataSet>
            <a:dataSet id="pur51303_currency_ds" autoCreate="true" fetchAll="true" loadData="true">
                <a:datas dataSource="/model/pur5130_currency_source"/>
            </a:dataSet>
            <a:dataSet id="sacpur52105_rfx_feedback_rfa_line_ds" autoQuery="true" fetchAll="true" model="pur.SACPUR5210.pur_rfx_feedback_rfa_line" queryUrl="${/request/@context_path}/autocrud/pur.SACPUR5210.pur_rfx_feedback_rfa_line/query?feedback_header_id=${/parameter/@feedback_header_id}">
                <a:fields>
                    <a:field name="currency_desc" defaultValue="人民币" displayField="currency_name" options="pur51303_currency_ds" returnField="currency_code" valueField="currency_code">
                        <a:mapping>
                            <a:map from="currency_name" to="currency_desc"/>
                            <a:map from="currency_code" to="currency_code"/>
                        </a:mapping>
                    </a:field>
                    <a:field name="exchange_rate" defaultValue="1"/>
                    <a:field name="currency_code" defaultValue="CNY"/>
                    <!-- <a:field name="abandoned_flag" checkedValue="Y" defaultValue="N" uncheckedValue="N"/> -->
                    <a:field name="promised_date"/>
                    <a:field name="current_fb_retail_price" required="true"/>
                    <a:field name="abandoned_flag" checkedValue="Y" defaultValue="N" uncheckedValue="N"/>
                    <a:field name="feedback_expiry_date_from" required="false" requiredMessage="${l:PUR5210.FEEDBACK_EXPIRY_DATE}" validator="sacpur5210_dateValidator"/>
                    <a:field name="feedback_expiry_date_to" required="false" requiredMessage="${l:PUR5210.FEEDBACK_EXPIRY_DATE}" validator="sacpur5210_dateValidator"/>
                    <a:field name="promised_date" validator="sacpur5210_dateValidator"/>
                    <a:field name="tax_included_flag" checkedValue="Y" defaultValue="N" uncheckedValue="N"/>
                    <a:field name="samples_requested" checkedValue="Y" defaultValue="N" uncheckedValue="N"/>
                    <a:field name="trans_cost_flag" checkedValue="Y" readOnly="true" uncheckedValue="N"/>
                    <a:field name="tax_type_rate" lovHeight="480" lovService="public.fnd_tax_type_code_lov" lovWidth="500" requiredMessage="${l:PUR5130.PLEASE_CHOOSE_TAX_CODE}" title="PUR_REQ_LINES.TAX_TYPE_RATE">
                        <a:mapping>
                            <a:map from="tax_type_id" to="tax_type_id"/>
                            <a:map from="tax_type_code" to="tax_type_code"/>
                            <a:map from="description" to="tax_type_desc"/>
                            <a:map from="tax_type_rate" to="tax_type_rate"/>
                        </a:mapping>
                    </a:field>
                </a:fields>
                <a:events>
                    <a:event name="update" handler="sacpur52105_rfx_feedback_rfa_line_ds_update"/>
                    <a:event name="load" handler="sacpur52105_rfx_feedback_rfa_line_ds_load"/>
                </a:events>
            </a:dataSet>
            <a:dataSet id="sacpur52105_rfx_feedback_rfa_line_item_ds" autoQuery="true" fetchAll="true" model="pur.SACPUR5210.pur_rfx_feedback_rfa_line" queryUrl="${/request/@context_path}/autocrud/pur.SACPUR5210.pur_rfx_feedback_rfa_line/query?feedback_header_id=${/parameter/@feedback_header_id}"/>
            <a:dataSet id="sacpur52105_rfx_feedback_rfa_record_ds" bindName="feedback_rfa_records" bindTarget="sacpur52105_rfx_feedback_rfa_line_item_ds" fetchAll="true" model="pur.SACPUR5210.pur_rfx_feedback_rfa_record"/>
            <a:dataSet id="sacpur52105_rfx_feedback_rfa_rank_ds" bindName="feedback_rfa_ranks" bindTarget="sacpur52105_rfx_feedback_rfa_line_item_ds" fetchAll="true" model="pur.SACPUR5210.pur_rfx_feedback_rfa_rank_query"/>
            <a:dataSet id="pur52102_rfx_ln_attachments1" autoQuery="true" fetchAll="true" model="public.fnd_atm_lines" queryUrl="${/request/@context_path}/autocrud/public.fnd_atm_lines/query?source_table_name=PUR_RFX_HEADERS&amp;source_pk_value=${/parameter/@rfx_header_id}">
                <a:fields>
                    <a:field name="atm_line_id"/>
                </a:fields>
            </a:dataSet>
        </a:dataSets>
        <a:screenBody>
            <a:screenTopToolbar>
                <a:toolbarButton click="sacpur52105RfxFeedbackRfqSave" text="HAP_SAVE" width="100"/>
                <a:toolbarButton click="sacpur52105RfxFeedbackRfqSubmit" text="HAP_SUBMIT" width="100"/>
                <a:gridButton bind="sacpur52105_rfx_feedback_rfa_line_grid" className="item-rbtn-blue button-excel" type="excel" width="100"/>
                <a:toolbarButton className="item-rbtn-blue button-excel" click="sacpur5210_rfx_quote_header_go_import" text="PROMPT.IMPORT" width="100"/>
                <a:toolbarButton click="sacpur52101RfxFeedbackRfqHeaderAtmUpload" text="ATM.UPLOAD_ATTACHMENT" width="100"/>
                <a:toolbarButton click="sacpur52105RfxFeedbackRfqReturn" text="HAP_BACK" width="100"/>
                <a:switch test="/parameter/@atm_counts">
                    <a:case value="1">
                        <div style="float:right;margin-top:10px;margin-left:auto;margin-right:20px;vertical-align:middle;">
                            <img src="${/request/@context_path}/images/paperclip.png"/>
                        </div>
                    </a:case>
                </a:switch>
            </a:screenTopToolbar>
            <a:hBox>
                <a:vBox labelWidth="120" padding="0">
                    <a:hBox labelWidth="120">
                        <a:textField name="rfx_number" bindTarget="sacpur52105_rfx_feedback_rfa_header_ds" prompt="PUR_RFX_HEADERS.RFX_NUMBER" readOnly="true"/>
                        <a:textField name="company_desc" bindTarget="sacpur52105_rfx_feedback_rfa_header_ds" prompt="FND_COMPANIES.CLIENT" readOnly="true"/>
                        <a:textField name="title" bindTarget="sacpur52105_rfx_feedback_rfa_header_ds" prompt="PUR_RFX_HEADERS.TITLE" readOnly="true"/>
                    </a:hBox>
                    <a:hBox labelWidth="120">
                        <a:comboBox name="rfx_category_desc" bindTarget="sacpur52105_rfx_feedback_rfa_header_ds" prompt="PUR_RFX_HEADERS.RFX_CATEGORY" readOnly="true"/>
                        <a:comboBox name="rfx_method_desc" bindTarget="sacpur52105_rfx_feedback_rfa_header_ds" prompt="PUR_RFX_HEADERS.RFX_METHOD" readOnly="true"/>
                        <a:comboBox name="payment_method_desc" bindTarget="sacpur52105_rfx_feedback_rfa_header_ds" prompt="PUR_RFX_HEADERS.PAYMENT_METHOD_ID" readOnly="true"/>
                    </a:hBox>
                    <a:hBox labelWidth="120">
                        <a:comboBox name="currency_desc" bindTarget="sacpur52105_rfx_feedback_rfa_header_ds" prompt="PUR_RFX_HEADERS.CURRENCY_CODE" readOnly="true"/>
                        <a:numberField name="exchange_rate" bindTarget="sacpur52105_rfx_feedback_rfa_header_ds" decimalPrecision="8" prompt="PUR_RFX_HEADERS.EXCHANGE_RATE" readOnly="true" renderer="Aurora.formatNumber"/>
                        <a:textField name="status_desc" bindTarget="sacpur52105_rfx_feedback_rfa_header_ds" prompt="PUR_RFX_HEADERS.STATUS" readOnly="true"/>
                    </a:hBox>
                    <a:hBox labelWidth="120">
                        <a:dateTimePicker name="feedback_end_time" bindTarget="sacpur52105_rfx_feedback_rfa_header_ds" prompt="PUR_RFX_HEADERS.FEEDBACK_END_TIME" readOnly="true"/>
                        <a:comboBox name="auction_direction_desc" bindTarget="sacpur52105_rfx_feedback_rfa_header_ds" prompt="PUR_RFX_HEADERS.AUCTION_DIRECTION" readOnly="true"/>
                    </a:hBox>
                    <a:hBox labelWidth="120">
                        <a:textField name="feedback_counts" bindTarget="sacpur52105_rfx_feedback_rfa_header_ds" prompt="PUR_RFX_FEEDBACK_HEADERS.FEEDBACK_COUNTS" readOnly="true"/>
                        <a:textField name="feedback_total_price" bindTarget="sacpur52105_rfx_feedback_rfa_header_ds" prompt="PUR_RFX_FEEDBACK_HEADERS.TOTAL_AMOUNT" readOnly="true"/>
                        <a:textField name="quotation_title" bindTarget="sacpur52105_rfx_feedback_rfa_header_ds" prompt="PUR_RFX_QUOTATION_TITLE" readOnly="true"/>
                    </a:hBox>
                    <a:hBox labelWidth="120">
                        <a:datePicker name="feedback_expiry_date_from" align="center" bindTarget="sacpur52105_rfx_feedback_rfa_header_ds" prompt="PUR_RFX_FEEDBACK_LINES.FEEDBACK_EXPIRY_DATE_FROM" renderer="Aurora.formatDate"/>
                        <a:datePicker name="feedback_expiry_date_to" align="center" bindTarget="sacpur52105_rfx_feedback_rfa_header_ds" prompt="PUR_RFX_FEEDBACK_LINES.FEEDBACK_EXPIRY_DATE_TO" renderer="Aurora.formatDate"/>
                    </a:hBox>
                    <a:hBox labelWidth="120">
                        <a:textField name="comments" bindTarget="sacpur52105_rfx_feedback_rfa_header_ds" prompt="PUR_RFX_HEADERS.COMMENTS" readOnly="true" width="707"/>
                    </a:hBox>
                    <a:hBox>
                        <a:accordionPanel id="pur5120_accordion_dim" height="150" showIcon="true" singleMode="false" width="900">
                            <a:accordions>
                                <a:accordion prompt="PROMPT.OTHER_INFO" selected="false">
                                    <a:vBox>
                                        <a:hBox labelWidth="120">
                                            <a:checkBox name="tax_included_flag" bindTarget="sacpur52105_rfx_feedback_rfa_header_ds" prompt="PUR_RFX_HEADERS.TAX_INCLUDED_FLAG" readOnly="true" width="152"/>
                                            <a:comboBox name="tax_type_desc" bindTarget="sacpur52105_rfx_feedback_rfa_header_ds" prompt="PUR_RFX_HEADERS.TAX_CODE" readOnly="true"/>
                                            <a:textField name="tax_type_rate" bindTarget="sacpur52105_rfx_feedback_rfa_header_ds" prompt="PUR_RFX_HEADERS.TAX_RATE" readOnly="true"/>
                                        </a:hBox>
                                        <a:hBox labelWidth="120">
                                            <a:checkBox name="sealed_bid_flag" bindTarget="sacpur52105_rfx_feedback_rfa_header_ds" prompt="PUR_RFX_HEADERS.SEALED_BID_FLAG" readOnly="true" width="152"/>
                                            <a:comboBox name="open_rule_desc" bindTarget="sacpur52105_rfx_feedback_rfa_header_ds" prompt="PUR_RFX_HEADERS.OPEN_RULE" readOnly="true"/>
                                            <a:comboBox name="auction_ranking_desc" bindTarget="sacpur52105_rfx_feedback_rfa_header_ds" prompt="PUR_RFX_HEADERS.AUCTION_RANKING" readOnly="true"/>
                                        </a:hBox>
                                        <a:hBox labelWidth="120">
                                            <a:dateTimePicker name="creation_date_desc" bindTarget="sacpur52105_rfx_feedback_rfa_header_ds" prompt="PUR_RFX_HEADERS.CREATION_DATE" readOnly="true"/>
                                            <a:textField name="place_of_delivery" bindTarget="sacpur52105_rfx_feedback_rfa_header_ds" prompt="PUR_RFX_HEADERS.PLACE_OF_DELIVERY" readOnly="true"/>
                                            <a:textField name="round" bindTarget="sacpur52105_rfx_feedback_rfa_header_ds" prompt="PUR_RFX_HEADERS.ROUND" readOnly="true"/>
                                        </a:hBox>
                                    </a:vBox>
                                </a:accordion>
                            </a:accordions>
                        </a:accordionPanel>
                    </a:hBox>
                </a:vBox>
                <div class="circle">
                    <span style="display:block;margin-left:10px; margin-top:20px;"><![CDATA[${l:SACPUR5210.HOW_LONG_IS_QUOTATION_DEADLINE}
                	]]></span>
                    <div id="countdown18" class="ClassyCountdownDemo"/>
                </div>
            </a:hBox>
            <a:tabPanel height="630" marginWidth="40">
                <a:tabs>
                    <a:tab prompt="PUR_RFX_HEADERS.BID" width="120">
                        <a:grid id="sacpur52105_rfx_feedback_rfa_line_grid" autoAppend="false" bindTarget="sacpur52105_rfx_feedback_rfa_line_ds" height="300" marginWidth="60" navBar="true" showRowNumber="true">
                            <a:columns>
                                <a:column name="line_num" align="right" lock="true" prompt="PUR_RFX_LN_ITEMS.LINE_NUM" width="30"/>
                                <a:column name="item_code" align="left" lock="true" prompt="PUR_RFX_FEEDBACK_LINES.ITEM_CODE" width="70"/>
                                <a:column name="item_desc" align="left" lock="true" prompt="PUR_RFX_FEEDBACK_LINES.ITEM_DESC" width="100"/>
                                <a:column name="item_note" align="left" prompt="PUR_RFX_LN_ITEMS.ITEM_NOTE" renderer="pur52105_rfxLnItemsGridRenderer" width="80"/>
                                <!-- <a:column name="item_parameter_config" align="left" prompt="PUR_RFX_LN_ITEMS.ITEM_PARAMETER_CONFIG" width="40"/> -->
                                <a:column name="abandoned_flag" align="left" editorFunction="sacpur52101_abandoned_flag_ef" prompt="PUR_RFX_FEEDBACK_LINES.ABANDONED_FLAG" width="40"/>
                                <a:column name="kw_customer" align="center" prompt="PUR_RFX_KW_CUSTOMER" width="50"/>
                                <a:column name="quotation_detail" align="center" prompt="PUR_RFX_QUOTATION_TITLE" renderer="pur52105_rfxFeedbackRfqLineGridRendererNetPrice" width="50"/>
                                <a:column name="current_fb_retail_price" align="right" editor="sacpur52105_current_fb_wholesale_price_nf" prompt="PUR_RFX_FEEDBACK_LINES.CURRENT_FB_RETAIL_PRICE" renderer="pur52105_formatNumber_render" width="40"/>
                                <a:column name="net_price" align="right" prompt="ACP_BILL.NET_PRICE" renderer="pur52105_rfxFeedbackRfqLineGridRendererNetPrice" width="50"/>
                                <a:column name="net_amount" align="right" prompt="ERP_AP_PAYMENT_CHECKS.BASE_AMOUNT" renderer="pur52105_rfxFeedbackRfqLineGridRendererNetPrice" width="50"/>
                                <a:column name="tax_amount" align="right" prompt="CON_CONTRACT_HEADERS.TAX_AMOUNT" renderer="pur52105_rfxFeedbackRfqLineGridRendererNetPrice" width="50"/>
                                <a:column name="total_amounts" align="right" prompt="BID_ENTRUSTMENT_LN_ITEMS.AMOUNT" renderer="pur52105_rfxFeedbackRfqLineGridRendererNetPrice" width="50"/>
                                <a:column name="valid_fb_retail_price" align="right" prompt="PUR_RFX_FEEDBACK_LINES.SUBMITTED_PRICE" renderer="pur52105_formatNumber_render" width="40"/>
                                <!-- <a:column name="tax_included_flag" editorFunction="tax_edit_fn" prompt="PUR_RFX_FEEDBACK_LINES.TAX_INCLUDED_FLAG" width="30"/> -->
                                <a:column name="tax_included_flag" prompt="PUR_RFX_FEEDBACK_LINES.TAX_INCLUDED_FLAG" width="30"/>
                                <a:column name="tax_type_rate" align="right" editorFunction="tax_edit_fn2" prompt="PUR_RFX_FEEDBACK_LINES.TAX_TYPE_RATE" width="40"/>
                                <a:column name="pur_uom_desc" align="left" prompt="PUR_RFX.PUR_UOM_DESC" width="40"/>
                                <a:column name="uom_desc" align="left" prompt="PUR_RFX_FEEDBACK_LINES.UOM_CODE" width="20"/>
                                <a:column name="brand" align="center" editor="sacpur52105_current_fb_reason_tf" prompt="MTL_SYSTEM_ITEMS.BRAND" width="60"/>
                                <a:column name="place_of_product" align="center" editor="sacpur52105_current_fb_reason_tf" prompt="MTL_SYSTEM_ITEMS.ORIGIN"/>
                                <a:column name="spec" align="center" editor="sacpur52105_current_fb_reason_tf" prompt="RFX.SPEC"/>
                                <a:column name="pur_cycle" align="center" editor="sacpur52105_current_fb_reason_tf" prompt="RFX.PUR_CYCLE"/>
                                <a:column name="warranty_period" align="center" editor="sacpur52105_current_fb_reason_tf" prompt="RFX.PLACE_OF_PRODUCT"/>
                                <a:column name="place_of_delivery" align="center" editor="sacpur52105_current_fb_reason_tf" prompt="PUR_RFX_HEADERS.PLACE_OF_DELIVERY"/>
                                <a:column name="currency_desc" align="center" editor="sacpur5210_currency_cmb" prompt="PUR_RFX_HEADERS.CURRENCY_CODE"/>
                                <a:column name="exchange_rate" align="center" editor="sacpur52105_exchange_rate_nf" prompt="PUR_RFX_HEADERS.EXCHANGE_RATE"/>
                                <a:column name="current_fb_reason" align="left" editor="sacpur52105_current_fb_reason_tf" prompt="PUR_RFX_FEEDBACK_LINES.CURRENT_FB_REASON" width="80"/>
                                <a:column name="quantity" align="right" prompt="PUR_RFX_FEEDBACK_LINES.QUANTITY" width="40"/>
                                <a:column name="need_by_date" align="center" prompt="PUR_RFX_FEEDBACK_LINES.NEED_BY_DATE" renderer="Aurora.formatDate" width="60"/>
                                <a:column name="ladder_inquiry_desc" align="right" prompt="PUR_RFX_LADDER_INQUIRY_TYPE" width="40"/>
                                <a:column name="ladder_quotation" align="center" prompt="SACPUR5210.LADDER_QUOTES" renderer="sacpur52101_rfxLadderQuotationRenderFun" width="40"/>
                                <!-- <a:column name="vendor_quote" align="center" prompt="PUR_RFX_QUOTE_TITLE" renderer="sacpur52105_rfxFeedbackVendorQuote_renderFun" width="40"/> -->
                                <!-- <a:column name="feedback_expiry_date_from" align="center" editor="sacpur52105_date_dp" prompt="PUR_RFX_FEEDBACK_LINES.FEEDBACK_EXPIRY_DATE_FROM" renderer="Aurora.formatDate" width="60"/> -->
                                <!-- <a:column name="feedback_expiry_date_to" align="center" editor="sacpur52105_date_dp" prompt="PUR_RFX_FEEDBACK_LINES.FEEDBACK_EXPIRY_DATE_TO" renderer="Aurora.formatDate" width="60"/> -->
                                <!-- <a:column name="promised_date" align="center" editor="sacpur52105_date_dp" prompt="PUR_RFX_FEEDBACK_LINES.PROMISED_DATE" renderer="Aurora.formatDate" width="60"/>
                                <a:column name="current_delivery_cycle" align="left" editor="sacpur52105_delivery_cycle_nb" prompt="PUR_RFX_LN_ITEMS.DELIVERY_CYCLE" width="60"/> -->
                                <!-- <a:column name="current_fb_wholesale_price" align="right" editor="sacpur52105_current_fb_wholesale_price_nf" prompt="PUR_RFX_FEEDBACK_LINES.CURRENT_FB_WHOLESALE_PRICE" renderer="pur52105_formatNumber_render" width="60"/>
                                <a:column name="trans_cost_flag" align="center" prompt="SACPUR5210.WHETHER_SHIPPING_IS_INCLUDED" width="50"/>
                                <a:column name="trans_cost" align="right" editorFunction="sacpur52101_trans_cost_tf" prompt="PUR_RFX_FEEDBACK_LINES.TRANS_COST" width="50"/>
                                <a:column name="limit_price" align="right" prompt="PUR_RFX_LN_ITEMS.LIMIT_PRICE" width="40"/>
                                <a:column name="samples_requested" prompt="PUR_RFX_LN_ITEMS.SAMPLES_REQUESTED" width="40"/>
                                <a:column name="feedback_range" align="left" prompt="PUR_RFX_FEEDBACK_LINES.FEEDBACK_RANGE" width="40"/> -->
                                <!-- <a:column name="work_num" prompt="PUR_RFX_LN_ITEMS.WORK_NUMBER" width="70"/>
                                <a:column name="bom_num" prompt="PUR_RFX_LN_ITEMS.BOM_NUMBER" width="70"/> -->
                                <!--  <a:column name="atm_flag" align="center" renderer="sacpur5210_RfxRender" width="20"/> -->
                                <a:column name="item_attachment" align="left" prompt="PUR_RFX_LN_ITEMS.REQ_ATTACHMENT" renderer="sacpur5210_RfxRender" width="60"/>
                                <a:column name="attachment" align="left" prompt="PUR_RFX_LINE_VENDOR.ATTACHMENT" renderer="sacpur5210_RfxRender" width="60"/>
                            </a:columns>
                            <a:editors>
                                <a:numberField id="sacpur52105_current_fb_wholesale_price_nf" allowNegative="false" decimalPrecision="8"/>
                                <a:numberField id="sacpur52105_delivery_cycle_nb" allowDecimals="false" allowNegative="false"/>
                                <a:numberField id="sacpur52105_exchange_rate_nf" allowNegative="false" decimalPrecision="4"/>
                                <a:datePicker id="sacpur52105_date_dp"/>
                                <a:checkBox id="sacpur52101_abandoned_flag_chb" checkedValue="Y" uncheckedValue="N"/>
                                <a:checkBox id="sacpur52101_tax_included_flag_cb"/>
                                <a:lov id="sacpur52101_tax_type_rate_lov"/>
                                <a:textField id="sacpur52105_current_fb_reason_tf"/>
                                <a:comboBox id="sacpur5210_currency_cmb"/>
                            </a:editors>
                        </a:grid>
                    </a:tab>
                    <a:tab prompt="PUR_RFX_HEADERS.BIDDING_RESULT" width="120">
                        <a:hBox>
                            <a:hBox width="420">
                                <a:grid id="sacpur52105_rfx_feedback_rfa_line_items_grid" autoAppend="false" bindTarget="sacpur52105_rfx_feedback_rfa_line_item_ds" height="300" navBar="true" showRowNumber="true" style="margin-left:20px" width="400">
                                    <a:columns>
                                        <a:column name="item_code" align="left" prompt="PUR_RFX_FEEDBACK_LINES.ITEM_CODE" width="100"/>
                                        <a:column name="item_desc" align="left" prompt="PUR_RFX_FEEDBACK_LINES.ITEM_DESC" width="110"/>
                                        <a:column name="feedback_by_count" align="left" prompt="PUR_RFX_FEEDBACK_HEADERS.FEEDBACK_BY_COUNT" renderer="sacpur52105_rfx_feedback_rfa_line_render" width="60"/>
                                        <a:column name="current_rank" align="left" prompt="PUR_RFX_FEEDBACK_HEADERS.CURRENT_RANK" renderer="sacpur52105_rfx_feedback_rfa_line_render" width="60"/>
                                    </a:columns>
                                </a:grid>
                            </a:hBox>
                            <a:hBox width="400">
                                <a:grid id="sacpur52105_rfx_feedback_rfa_record_grid" bindTarget="sacpur52105_rfx_feedback_rfa_record_ds" height="300" navBar="true" style="margin-left:20px" width="380">
                                    <a:toolBar>
                                        <a:button click="sacpur52105_rfx_feedback_rfa_record_grid_refresh" icon="${/request/@context_path}/images/undo.png" text="SACPUR5210.REFRESH_QUOTATION"/>
                                    </a:toolBar>
                                    <a:columns>
                                        <a:column name="feedback_count" align="center" prompt="PUR_RFX_HEADERS.FEEDBACK_COUNT" width="60"/>
                                        <a:column name="vendor_desc" align="left" prompt="PUR_RFX_FEEDBACK_RECORDS.FEEDBACK_BY" renderer="sacpur52105_rfx_feedback_rfa_record_render" width="100"/>
                                        <a:column name="feedback_retail_price" align="right" prompt="PUR_RFX_HEADERS.FEEDBACK_RETAIL_PRICE" renderer="sacpur52105_rfx_feedback_rfa_record_render" width="60"/>
                                        <a:column name="feedback_time" align="left" prompt="PUR_RFX_FEEDBACK_LINES.FEEDBACK_TIME" width="130"/>
                                    </a:columns>
                                </a:grid>
                            </a:hBox>
                            <a:hBox width="400">
                                <a:grid id="sacpur52105_rfx_feedback_rfa_rank_grid" bindTarget="sacpur52105_rfx_feedback_rfa_rank_ds" height="300" navBar="true" style="margin-left:20px" width="350">
                                    <a:toolBar>
                                        <a:button click="sacpur52105_rfx_feedback_rfa_rank_grid_refresh" icon="${/request/@context_path}/images/undo.png" text="SACPUR5210.REFRESH_RANK"/>
                                    </a:toolBar>
                                    <a:columns>
                                        <a:column name="rk" align="center" prompt="SACPUR5210.RANK" width="60"/>
                                        <a:column name="valid_fb_retail_price" align="right" prompt="PUR_RFX_HEADERS.VALID_FB_RETAIL_PRICE" renderer="sacpur52105_rfx_feedback_rfa_rank_render" width="60"/>
                                        <a:column name="vendor_desc" align="left" prompt="PUR_RFX_FEEDBACK_RECORDS.FEEDBACK_BY" renderer="sacpur52105_rfx_feedback_rfa_rank_render" width="200"/>
                                    </a:columns>
                                </a:grid>
                            </a:hBox>
                        </a:hBox>
                    </a:tab>
                    <a:tab prompt="SACPUR5210.ATM_FILE_LIST" width="120">
                        <a:grid id="pur52102_atm_grid1" bindTarget="pur52102_rfx_ln_attachments1" height="320" marginWidth="140" navBar="true">
                            <a:columns>
                                <!-- <a:column name="line_number" align="center" prompt="FND_ATM_LINES.LINE_NUMBER" width="50"/> -->
                                <!-- <a:column name="atm_file" align="left" prompt="FND_ATM_LINES.ATM_FILE" width="250"/> -->
                                <a:column name="atm_desc" align="center" prompt="FND_ATM_LINES.ATM_DESC" width="100"/>
                                <a:column name="upload_user_name" align="center" prompt="FND_ATM_LINES.UPLOAD_USER_NAME" width="100"/>
                                <!-- <a:column name="download_count" align="center" prompt="FND_ATM_LINES.DOWNLOAD_COUNT" width="100"/> -->
                                <a:column name="atm_flag" align="center" renderer="pur52102_upload_renderer" width="20"/>
                                <a:column name="attachment" align="center" prompt="FND_ATM_LINES.ATM_DOWNLOAD" renderer="pur52102_upload_renderer" width="100"/>
                            </a:columns>
                        </a:grid>
                    </a:tab>
                </a:tabs>
                <a:events>
                    <a:event name="select" handler="sacpur5210_selectTab_fun"/>
                </a:events>
            </a:tabPanel>
        </a:screenBody>
    </a:view>
</a:screen>
