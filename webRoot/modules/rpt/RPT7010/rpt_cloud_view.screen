<?xml version="1.0" encoding="UTF-8"?>
<!--
    $Author: libin 
    $Date: 2014-12-16 上午9:55:17  
    $Revision: 1.0  
    $Purpose: 
-->
<a:screen xmlns:a="http://www.aurora-framework.org/application">
    <a:init-procedure/>
    <a:view>
        <a:link id="rpt7010_detail_view_screen" url="${/request/@context_path}/modules/rpt/RPT7010/rpt_cloud_view_detail.screen"/>
        <a:link id="rpt7010_detail_view_vendor_screen" url="${/request/@context_path}/modules/rpt/RPT7010/rpt_cloud_view_vendor_detail.screen"/>
        <a:link id="rpt7010_detail_view_all_screen" url="${/request/@context_path}/modules/rpt/RPT7010/rpt_cloud_view_all_detail.screen"/>
        <!-- CSS样式引入 -->
        <link href="${/request/@context_path}/index/css/animate.css" rel="stylesheet" type="text/css"/>
        <link href="${/request/@context_path}/index/css/pricetable.css" rel="stylesheet" type="text/css"/>
        <link href="${/request/@context_path}/index/css/MetroJs.css" rel="stylesheet" type="text/css"/>
        <!-- js引入 -->
        <script language="JavaScript" src="${/request/@context_path}/index/js/jquery-1.8.3.min.js"/>
        <script><![CDATA[jQuery.noConflict();]]></script>
        <script src="http://echarts.baidu.com/build/dist/echarts.js" type="text/javascript"/>
        <script src="${/request/@context_path}/index/js/jquery.pricetable.min.js" type="text/javascript"/>
        <script src="${/request/@context_path}/index/js/MetroJs.js" type="text/javascript"/>
        <script src="${/request/@context_path}/index/js/kontext.js" type="text/javascript"/>
        <style><![CDATA[
           .rpt7010_pagination{
               display:inline-block;
               border-radius:4px;
               margin-top:5px;
               margin-bottom:5px
           }
           .rpt7010_pagination li{
               display: inline;
           }
           .rpt7010_pagination li:not([class]) a:hover{
               color: #23527C;
               background-color: #EEE;
           }
           .rpt7010_pagination li a{
               position: relative;
               float: left;
               margin-left: -1px;
               line-height:35px;
               width: 35px;
               height: 35px;
               text-align: center;
               color: #337AB7;
               cursor:pointer;
               text-decoration: none;
               background-color: #FFF;
               border: 1px solid #DDD;
           }
           .rpt7010_pagination li .fisrtChild{
               border-top-left-radius: 5px;
               border-bottom-left-radius: 5px;
           }
           .rpt7010_pagination li .lastChild{
               border-top-right-radius: 5px;
               border-bottom-right-radius: 5px;
           }
           .rpt7010_pagination .disabled a{
               cursor: not-allowed;
           }
           .rpt7010_pagination .active a{
               color: #FFF;
               cursor: default;
               background-color: #337AB7;
               border-color: #337AB7;
           }
        ]]></style>
        <script><![CDATA[
            var rpt7010_detail_show_flag = 1;
            //设置div颜色库
            var rpt7010_div_color = ['red', 'blue', 'green', 'yellow', 'purple', 'brown', 'cobalt', 'crimson', 'cyan', 'emerald', 'indigo', 'lime', 'magenta', 'mango', 'mauve', 'olive', 'orange', 'pink', 'sienna', 'steel'];
            var rpt_div_color_amount = rpt7010_div_color.length;
            //防止相邻颜色相同
            var rpt7010_div_color_index_pre;
            var rpt7010_amount_all_option = [];
            var rpt7010_newIn_metor_color = [];
            //截取过长的字符串,第一个字符的起始位置为0
            
            function rpt7010_substr(str, begin, length) {
                if (str.length - begin > length) {
                    return str.substr(begin, length) + '..';
                } else {
                    return str.substr(begin);
                }
            }
            
            function rpt7010_set_wordLength(str, length) {
                var substr;
                var word_sum = 0;
                var len = 0;
                //判断中文字符所占的空间大小
                for (var i = 0;i < str.length;i++) {
                    //中文字符
                    if (str.charCodeAt(i) > 127 || str.charCodeAt(i) == 94) {
                        len += 2;
                        word_sum++;
                    } else {
                        //英文字符
                        len++;
                        word_sum++;
                    }
                    if (len == length && i != str.length - 1) {
                        return str.substr(0, word_sum) + '...';
                    }
                }
                return str;
            }
            
            function rpt7010_chart_column1_x_format() {
                return rpt7010_substr(this.value, 0, 5);
            }
            
            function rpt7010_chart_column1_format() {
                return '<b>' + this.x + '</b><br/>' + this.series.name + ': ' + Aurora.formatNumber(this.y, 2);
            }
            
            function rpt7010_chart_column2_format() {
                return '<b>' + this.x + '</b><br/>' + this.series.name + ': ' + this.y;
            }
            
            function rpt_go_detail_screen(name_ds, list_ds, id, title, url) {
                var bg_name_ds = $(name_ds).getAll();
                var business_list = $('rpt7010_business_list_ds');
                var bg_name = [];
                var bg_display_name = [];
                business_list.removeAll();
                for (var i = 0;i < bg_name_ds.length;i++) {
                    bg_name.push(bg_name_ds[i].get('business_group_code'));
                    bg_display_name.push({
                        name: bg_name_ds[i].get('business_group_name'),
                        business_group_code: bg_name_ds[i].get('business_group_code'),
                        code: i,
                        parent_code: -1,
                        sequence: i + 1
                    });
                    business_list.create(bg_display_name[i]);
                }
                new Aurora.Window({
                    id: id,
                    title: title,
                    url: $(url).getUrl() + '?bg_name=' + bg_name,
                    fullScreen: true
                });
            }
            
            //采购企业chart图表点击事件
            
            function rpt7010_chart_click1() {
                rpt_go_detail_screen('rpt7010_pur_totaAmount_all_ds', 'rpt7010_business_list_ds', 'rpt7010_detail_view', '企业人脉', 'rpt7010_detail_view_screen');
            }
            
            function rpt7010_chart_click2() {
                rpt_go_detail_screen('rpt7010_pur_totaAmount_speed_ds', 'rpt7010_business_list_ds', 'rpt7010_detail_view', '企业人脉', 'rpt7010_detail_view_screen');
            }
            
            function rpt7010_chart_click3() {
                rpt_go_detail_screen('rpt7010_pur_amount_active_ds', 'rpt7010_business_list_ds', 'rpt7010_detail_view', '企业人脉', 'rpt7010_detail_view_screen');
            }
            
            function rpt_get_div_random_color() {
                //随机生成1到rpt_div_color_amount的任意整数
                var i = Math.floor(Math.random() * rpt_div_color_amount + 1);
                if (i == rpt7010_div_color_index_pre) {
                    //控制相邻的div块颜色不同，相同则递归
                    return rpt_get_div_random_color();
                } else {
                    rpt7010_div_color_index_pre = i;
                    return rpt7010_div_color[i - 1];
                }
            }
            
            //采购企业ds的load事件
            
            //当aurora的chart绑定的ds无数据时渲染页面效果，（将空数据赋给echarts）
            
            function rpt7010_chart_noData_set(id, div_id) {
                var div = document.createElement("div");
                //div.style.fontSize = 30 + 'px';
                div.style.width = 100 + '%';
                div.style.height = 100 + '%';
                div.id = div_id;
                /* div.style.textAlign = 'center';
                 div.style.lineHeight = 400 + 'px';
                 div.innerHTML = '暂无数据'; */
                document.getElementById(id).innerHTML = '';
                document.getElementById(id).appendChild(div);
                rpt7010_draw_echart_barType3([], [], div_id, '');
            }
            
            function rpt7010_pur_totaAmount_all_load() {
                var ds = $('rpt7010_pur_totaAmount_all_ds').getAll();
                if (ds.length == 0) {
                    //无数据时渲染报表页面
                    rpt7010_chart_noData_set('rpt7010_aurora_chart1', 'rpt7010_pur_chart1');
                }
            }
            
            function rpt7010_pur_totaAmount_speed_load() {
                var ds = $('rpt7010_pur_totaAmount_speed_ds').getAll();
                if (ds.length == 0) {
                    //无数据时渲染报表页面
                    rpt7010_chart_noData_set('rpt7010_aurora_chart2', 'rpt7010_pur_chart2');
                }
            }
            
            function rpt7010_pur_amount_active_load() {
                var ds = $('rpt7010_pur_amount_active_ds').getAll();
                if (ds.length == 0) {
                    //无数据时渲染报表页面
                    rpt7010_chart_noData_set('rpt7010_aurora_chart3', 'rpt7010_pur_chart3');
                }
            }
            
            //销售企业展示面的三个图表显示内容和点击事件
            
            function rpt7010_vendor_totaAmount_load() {
                var ds = $('rpt7010_pur_vendor_totaAmount_all_ds').getAll();
                var rpt7010_amount_all_x = [];
                var rpt7010_amount_all_y = [];
                var i;
                for (i = 0;i < ds.length;i++) {
                    rpt7010_amount_all_x.push(ds[i].get('business_group_name'));
                    rpt7010_amount_all_y.push(ds[i].get('sum'));
                    rpt7010_amount_all_option[i] = {
                        xAxis: i,
                        y: 350,
                        name: ds[i].get('business_group_name'),
                        symbolSize: 0
                    };
                }
            
                rpt7010_draw_echart_barType3(rpt7010_amount_all_x, rpt7010_amount_all_y, 'rpt7010_sell_main', '销售企业采购额排行榜');
                //rpt7010_draw_echart_bar();
                jQuery("#rpt7010_sell_main").click(function() {
                    rpt_go_detail_screen('rpt7010_pur_vendor_totaAmount_all_ds', 'rpt7010_business_list_ds', 'rpt7010_vendor_detail_view_id', '销售企业人脉', 'rpt7010_detail_view_vendor_screen');
                });
            }
            
            function rpt7010_vendor_speed_load() {
                var ds = $('rpt7010_pur_vendor_totaAmount_speed_ds').getAll();
                var x_data = [];
                var y_data = [];
                var i;
                if (ds.length == 0) {
                    x_data.push('无有效的数据');
                } else {
                    for (i = 0;i < ds.length;i++) {
                        x_data.push(ds[i].get('business_group_name'));
                        y_data.push(ds[i].get('speed'));
                    }
                }
                rpt7010_draw_echart_barType2(x_data, y_data);
                jQuery("#rpt7010_sell_main2").click(function() {
                    rpt_go_detail_screen('rpt7010_pur_vendor_totaAmount_speed_ds', 'rpt7010_business_list_ds', 'rpt7010_vendor_detail_view_id', '销售企业人脉', 'rpt7010_detail_view_vendor_screen');
                });
            }
            
            function rpt7010_vendor_active_load() {
                var ds = $('rpt7010_pur_vendor_amount_active_ds').getAll();
                var x_data = [];
                var y_data = [];
                var i;
                for (i = 0;i < ds.length;i++) {
                    x_data.push(ds[i].get('business_group_name'));
                    y_data.push(ds[i].get('amount'));
                }
                rpt7010_draw_echart_barType3(x_data, y_data, 'rpt7010_sell_main3', '销售企业活跃度排行榜');
                jQuery("#rpt7010_sell_main3").click(function() {
                    rpt_go_detail_screen('rpt7010_pur_vendor_amount_active_ds', 'rpt7010_business_list_ds', 'rpt7010_vendor_detail_view_id', '销售企业人脉', 'rpt7010_detail_view_vendor_screen');
                });
            }
            
            //获取屏幕可用宽高
            var rpt7010_screen_width = screen.availWidth;
            var rpt7010_screen_height = screen.availHeight;
            var line_amount;
            //根据分别率设置每行的div磁贴最大数量，超过就换行
            if (rpt7010_screen_width == 1366) {
                line_amount = 8;
            } else if (rpt7010_screen_width < 1366 && rpt7010_screen_width > 1024) {
                line_amount = 7;
            } else if (rpt7010_screen_width <= 1024) {
                line_amount = 6;
            } else {
                line_amount = 8;
            }
            //动态设置css样式，根据分别率自动设置
            function rpt7010_set_size() {
                document.getElementById('rpt7010_bg').style.height = document.body.scrollHeight + 'px';
                document.getElementById('rpt7010_aurora_chart1').style.width = rpt7010_screen_width * 0.45 + 'px';
                document.getElementById('rpt7010_aurora_chart1').style.height = rpt7010_screen_height * 0.53 + 'px';
                document.getElementById('rpt7010_aurora_chart2').style.width = rpt7010_screen_width * 0.45 + 'px';
                document.getElementById('rpt7010_aurora_chart2').style.height = rpt7010_screen_height * 0.53 + 'px';
                document.getElementById('rpt7010_aurora_chart3').style.width = rpt7010_screen_width * 0.45 + 'px';
                document.getElementById('rpt7010_aurora_chart3').style.height = rpt7010_screen_height * 0.53 + 'px';
                document.getElementById('rpt7010_sell_main').style.width = rpt7010_screen_width * 0.45 + 'px';
                document.getElementById('rpt7010_sell_main').style.height = rpt7010_screen_height * 0.53 + 'px';
                document.getElementById('rpt7010_sell_main2').style.width = rpt7010_screen_width * 0.45 + 'px';
                document.getElementById('rpt7010_sell_main2').style.height = rpt7010_screen_height * 0.53 + 'px';
                document.getElementById('rpt7010_sell_main3').style.width = rpt7010_screen_width * 0.45 + 'px';
                document.getElementById('rpt7010_sell_main3').style.height = rpt7010_screen_height * 0.53 + 'px';
            }
            /*
             ***************************************************************
             *根据后台查询出的新入企业在前台动态创建div磁贴
             *将企业信息附到磁贴正反面
             *创建点击事件：左击查看企业人脉
             ***************************************************************
             */
            var rpt7010_newIn_pageTurn_start_index = 1;
            var rpt7010_newIn_pageTurn_end_index = 5;
            var rpt7010_newIn_pageTurn_click_index = 1;
            //分页设置
            
            function rpt7010_page_size_set() {
                var result_ds = $('rpt7010_business_group_new_ds').getAll();
                var rows_num = Math.ceil(result_ds.length / (line_amount * 2));
                var html;
                if (rpt7010_newIn_pageTurn_click_index == 1) {
                    html = '<li class="disabled" ><a href="javascript:rpt7010_pageTurn_Previous()" class="fisrtChild"><span>&laquo;</span></a></li>';
                } else {
                    html = '<li><a href="javascript:rpt7010_pageTurn_Previous()" class="fisrtChild"><span>&laquo;</span></a></li>';
                }
                for (var i = rpt7010_newIn_pageTurn_start_index;i <= rpt7010_newIn_pageTurn_end_index;i++) {
                    if (i == rpt7010_newIn_pageTurn_click_index) {
                        html += '<li id="rpt7010_pageSize_li' + i + '" class="active" ><a style="width:35px;text-align:center" href="javascript:rpt7010_pageTurn_init(' + (i - 1) + ')">' + i + '</a></li>';
                    } else {
                        html += '<li id="rpt7010_pageSize_li' + i + '" ><a style="width:35px;text-align:center" href="javascript:rpt7010_pageTurn_init(' + (i - 1) + ')">' + i + '</a></li>';
                    }
                }
                if (rpt7010_newIn_pageTurn_click_index >= rows_num) {
                    html += '<li class="disabled"><a href="javascript:rpt7010_pageTurn_Next()" class="lastChild"><span>&raquo;</span></a></li>';
                } else {
                    html += '<li><a href="javascript:rpt7010_pageTurn_Next()" class="lastChild"><span>&raquo;</span></a></li>';
                }
                document.getElementById('rpt7010_newIn_pageSize_ul_id').innerHTML = html;
            }
            
            //向前翻页
            
            function rpt7010_pageTurn_Previous() {
                rpt7010_newIn_pageTurn_click_index--;
                if (rpt7010_newIn_pageTurn_click_index < (rpt7010_newIn_pageTurn_start_index + rpt7010_newIn_pageTurn_end_index) / 2) {
                    var pre_num = Math.ceil((rpt7010_newIn_pageTurn_start_index + rpt7010_newIn_pageTurn_end_index) / 2) - rpt7010_newIn_pageTurn_click_index;
                    if (rpt7010_newIn_pageTurn_start_index - pre_num < 1) {
                        pre_num = rpt7010_newIn_pageTurn_start_index - 1;
                    }
                    rpt7010_newIn_pageTurn_start_index -= pre_num;
                    rpt7010_newIn_pageTurn_end_index -= pre_num;
                }
                rpt7010_page_size_set();
                rpt7010_pageTurn_init(rpt7010_newIn_pageTurn_click_index - 1);
            }
            
            //向后翻页
            
            function rpt7010_pageTurn_Next() {
                var result_ds = $('rpt7010_business_group_new_ds').getAll();
                var rows_num = Math.ceil(result_ds.length / (line_amount * 2));
                rpt7010_newIn_pageTurn_click_index++;
                if (rpt7010_newIn_pageTurn_click_index > (rpt7010_newIn_pageTurn_start_index + rpt7010_newIn_pageTurn_end_index) / 2) {
                    var next_num = rpt7010_newIn_pageTurn_click_index - parseInt((rpt7010_newIn_pageTurn_start_index + rpt7010_newIn_pageTurn_end_index) / 2);
                    if (rpt7010_newIn_pageTurn_end_index + next_num > rows_num) {
                        next_num = rows_num - rpt7010_newIn_pageTurn_end_index;
                    }
                    rpt7010_newIn_pageTurn_start_index += next_num;
                    rpt7010_newIn_pageTurn_end_index += next_num;
                }
                rpt7010_page_size_set();
                rpt7010_pageTurn_init(rpt7010_newIn_pageTurn_click_index - 1);
            }
            
            function rpt7010_business_group_load() {
                var result_ds = $('rpt7010_business_group_new_ds').getAll();
                var rows_num = Math.ceil(result_ds.length / (line_amount * 2));
                rpt7010_newIn_pageTurn_start_index = 1;
                rpt7010_newIn_pageTurn_end_index = (5 > rows_num) ? rows_num : 5;
                rpt7010_newIn_pageTurn_click_index = 1;
                rpt7010_page_size_set();
                rpt7010_pageTurn_init(0);
            }
            
            //设置刷新时同个磁贴的颜色不变化
            
            function rpt7010_get_metro_color(record) {
                var flag = true;
                for (var j = 0;j < rpt7010_newIn_metor_color.length;j++) {
                    if (rpt7010_newIn_metor_color[j].code == record.get('business_group_code')) {
                        color = rpt7010_newIn_metor_color[j].color;
                        flag = false;
                    }
                }
                if (flag) {
                    color = rpt_get_div_random_color();
                    rpt7010_newIn_metor_color.push({
                        code: record.get('business_group_code'),
                        color: color
                    });
                }
                return color;
            }
            
            function rpt7010_pageTurn_init(rows_index) {
                var business_ds = $('rpt7010_business_group_new_ds').getAll();
                var start_index = rows_index * 2 * line_amount;
                var end_index = (start_index + line_amount * 2 > business_ds.length) ? business_ds.length : start_index + line_amount * 2;
                var table;
                var tr;
                var td;
                var div;
                var i;
                var color;
                //var length = (business_ds.length > (line_amount * 2)) ? (line_amount * 2) : business_ds.length;
                //分页效果重新渲染
                rpt7010_newIn_pageTurn_click_index = rows_index + 1;
                rpt7010_page_size_set();
                //动态增加div磁贴，超过一定数量换行
                table = document.createElement("table");
                for (i = start_index;i < end_index;i++) {
                    if (i % line_amount == 0) {
                        tr = table.insertRow();
                    }
                    //color = rpt_get_div_random_color();
                    color = rpt7010_get_metro_color(business_ds[i]);
                    td = tr.insertCell();
                    if (i % 2 == 0) {
                        td.innerHTML = '<div id="rpt7010_business_new' + i + '" class="live-tile ' + color + '" data-initdelay="10000" data-mode="flip">' + '<div id="rpt7010_business_new' + i + '_back" class="rpt7010_metro_back"></div>' + '<div id="rpt7010_business_new' + i + '_front" class="rpt7010_metro_front"></div>' + '</div>';
                    } else {
                        td.innerHTML = '<div id="rpt7010_business_new' + i + '" class="live-tile ' + color + '" data-direction="horizontal" data-initdelay="10000" data-mode="flip">' + '<div id="rpt7010_business_new' + i + '_back" class="rpt7010_metro_back"></div>' + '<div id="rpt7010_business_new' + i + '_front" class="rpt7010_metro_front"></div>' + '</div>';
                    }
                }
                document.getElementById('rpt7010_metro_div').innerHTML = '';
                document.getElementById('rpt7010_metro_div').appendChild(table);
                //div磁贴正反面加入内容
                for (i = start_index;i < end_index;i++) {
                    document.getElementById('rpt7010_business_new' + i + '_front').innerHTML = '昨日订单数量：' + business_ds[i].get('pur_amount_yesterday') + '<br/>' + '今日订单数量：' + business_ds[i].get('pur_amount_today') + '<br/>' + '昨日送货单数：' + business_ds[i].get('inv_amount_yesterday') + '<br/>' + '今日送货单数：' + business_ds[i].get('inv_amount_today');
                }
                for (i = start_index;i < end_index;i++) {
                    //document.getElementById('rpt7010_business_new' + i + '_back').innerHTML = business_ds[i].get('business_group_code') + '<br/>' + business_ds[i].get('business_group_name');
                    document.getElementById('rpt7010_business_new' + i + '_back').innerHTML = '<div class="rpt7010_metroFront_leftSet"><i class="fa icon-group" style="font-size:40px"></i></div><div class="rpt7010_metroFront_rightSet"><div>集团名称</div><div style="font-size:18px;white-space:nowrap;">' + rpt7010_set_wordLength(business_ds[i].get('business_group_name'), 8) + '</div><div>集团代码</div><div style="font-size:18px">' + rpt7010_set_wordLength(business_ds[i].get('business_group_code'), 6) + '</div></div>';
                }
                for (i = start_index;i < end_index;i++) {
                    jQuery("#rpt7010_business_new" + i).liveTile();
                }
                //jquery事件
                //jQuery(".live-tile").liveTile();
                jQuery('#rpt7010_metro_div').click(function() {
                    rpt_go_detail_screen('rpt7010_business_group_new_ds', 'rpt7010_business_list_ds', 'rpt7010_detail_view', '新入企业', 'rpt7010_detail_view_all_screen');
                });
            }
            
            /*
             ***************************************************************
             *自选企业动态创建前台div磁贴
             *将企业信息附到磁贴正反面
             *创建点击事件：左击查看企业人脉，右击可删除div磁贴
             *参数rpt7010_select_td_amount：记录最后一行上的div磁贴个数
             *参数rpt7010_select_bg_total_amount：记录总共添加的div磁贴个数，删除后的也算在内
             *参数rpt7010_select_bg_cancel_amount：记录删除的div磁贴个数
             *参数rpt7010_select_bg_id，rpt7010_select_bg_code，rpt7010_select_bg_name：记录企业信息
             *参数rpt7010_select_bg_detail：记录需要在div磁贴正反面显示的企业信息
             *参数rpt7010_select_bg_order：记录div磁贴的排序，从1开始。遇到被删除时，被删除的序号置0，删除之后的序号依次减一
             ***************************************************************
             */
            
            var rpt7010_select_td_amount = 0;
            var rpt7010_select_bg_total_amount = 0;
            var rpt7010_select_bg_cancel_amount = 0;
            var rpt7010_select_bg_id = [];
            var rpt7010_select_bg_code = [];
            var rpt7010_select_bg_name = [];
            var rpt7010_select_bg_detail = [];
            var rpt7010_select_bg_order = [];
            
            function rpt7010_show(id) {
                document.getElementById('rpt7010' + id).style.display = "block";
            }
            
            function rpt7010_hide(id) {
                document.getElementById('rpt7010' + id).style.display = "none";
            }
            
            function rpt7010_add_selected_bg() {
                var ds = $('rpt7010_business_group_select_ds').getAt(0);
                var length = $('rpt7010_business_group_select_ds').getAll().length;
                var table;
                var tr;
                var td;
                var i;
                var color = rpt_get_div_random_color();
                var flag = 0;
                //alert(length);
                if (length == 0) {
                    Aurora.showMessage('提示', '请先选择企业再添加');
                } else if (rpt7010_select_bg_total_amount - rpt7010_select_bg_cancel_amount <= (line_amount * 2 - 1)) {
                    //判断自选的企业是否已经存在
                    for (i = 0;i < rpt7010_select_bg_id.length;i++) {
                        if (ds.get('business_group_id') == rpt7010_select_bg_id[i]) {
                            Aurora.showMessage('提示', '您选择的企业已经存在');
                            flag = 1;
                        }
                    }
                    if (flag == 0) {
                        rpt7010_select_td_amount++;
                        rpt7010_select_bg_total_amount++;
                        rpt7010_select_bg_id.push(ds.get('business_group_id'));
                        rpt7010_select_bg_code.push(ds.get('business_group_code'));
                        rpt7010_select_bg_name.push(ds.get('business_group'));
                        rpt7010_select_bg_detail.push({
                            pur_amount_yesterday: ds.get('pur_amount_yesterday'),
                            pur_amount_today: ds.get('pur_amount_today'),
                            inv_amount_yesterday: ds.get('inv_amount_yesterday'),
                            inv_amount_today: ds.get('inv_amount_today')
                        });
                        rpt7010_select_bg_order.push(rpt7010_select_bg_total_amount - rpt7010_select_bg_cancel_amount);
                        //自选企业根据选择的企业增加div磁贴
                        if ((rpt7010_select_bg_total_amount - rpt7010_select_bg_cancel_amount) % line_amount == 1) {
                            tr = document.createElement("tr");
                            document.getElementById('rpt7010_select_table').appendChild(tr);
                            rpt7010_select_td_amount = rpt7010_select_bg_cancel_amount + 1;
                            //rpt7010_select_table_rownum++;
                        }
                        table = document.getElementById('rpt7010_select_table');
                        tr = table.rows[table.rows.length - 1];
                        td = tr.insertCell();
                        if (rpt7010_select_bg_total_amount % 2 == 1) {
                            td.innerHTML = '<div onmouseover="rpt7010_show(' + rpt7010_select_bg_total_amount + ')" onmouseout="rpt7010_hide(' + rpt7010_select_bg_total_amount + ')" class="rpt7010_self_set"><div id="rpt7010' + rpt7010_select_bg_total_amount + '" class="tooltip-content"><div id="rpt7010_' + rpt7010_select_bg_total_amount + '" class="close"><i class="fa icon-remove" style="font-size:40px"></i></div></div><div class="rpt7010_self_set_metro"><div id="rpt7010_business_select' + rpt7010_select_bg_total_amount + '" class="live-tile ' + color + '" data-initdelay="10000" data-mode="flip" >' + '<div id="rpt7010_business_select' + rpt7010_select_bg_total_amount + '_back" class="rpt7010_metro_back"></div>' + '<div id="rpt7010_business_select' + rpt7010_select_bg_total_amount + '_front" class="rpt7010_metro_front"></div>' + '</div></div></div>';
                        } else {
                            td.innerHTML = '<div onmouseover="rpt7010_show(' + rpt7010_select_bg_total_amount + ')" onmouseout="rpt7010_hide(' + rpt7010_select_bg_total_amount + ')" class="rpt7010_self_set"><div id="rpt7010' + rpt7010_select_bg_total_amount + '" class="tooltip-content"><div id="rpt7010_' + rpt7010_select_bg_total_amount + '" class="close"><i class="fa icon-remove" style="font-size:40px"></i></div></div><div class="rpt7010_self_set_metro"><div id="rpt7010_business_select' + rpt7010_select_bg_total_amount + '" class="live-tile ' + color + '" data-direction="horizontal" data-initdelay="10000" data-mode="flip" >' + '<div id="rpt7010_business_select' + rpt7010_select_bg_total_amount + '_back" class="rpt7010_metro_back"></div>' + '<div id="rpt7010_business_select' + rpt7010_select_bg_total_amount + '_front" class="rpt7010_metro_front"></div>' + '</div></div></div>';
                        }
                        //div磁贴正反面加入内容
                        document.getElementById('rpt7010_business_select' + rpt7010_select_bg_total_amount + '_front').innerHTML = '昨日订单数量：' + ds.get('pur_amount_yesterday') + '<br/>' + '今日订单数量：' + ds.get('pur_amount_today') + '<br/>' + '昨日送货单数：' + ds.get('inv_amount_yesterday') + '<br/>' + '今日送货单数：' + ds.get('inv_amount_today');
                        //document.getElementById('rpt7010_business_select' + rpt7010_select_bg_total_amount + '_back').innerHTML = ds.get('business_group_code') + '<br/>' + ds.get('business_group');
                        document.getElementById('rpt7010_business_select' + rpt7010_select_bg_total_amount + '_back').innerHTML = '<div class="rpt7010_metroFront_leftSet"><i class="fa icon-group" style="font-size:40px"></i></div><div class="rpt7010_metroFront_rightSet"><div>集团名称</div><div style="font-size:18px;white-space:nowrap;">' + rpt7010_set_wordLength(ds.get('business_group'), 6) + '</div><div>集团代码</div><div style="font-size:18px">' + rpt7010_set_wordLength(ds.get('business_group_code'), 6) + '</div></div>';
                        //jquery事件
                        jQuery("#rpt7010_business_select" + rpt7010_select_bg_total_amount).liveTile();
                        rpt7010_set_jquery_click(rpt7010_select_bg_total_amount);
                        rpt7010_set_jquery_cancel_metro(rpt7010_select_bg_total_amount);
                    }
                } else {
                    Aurora.showMessage('提示', '最多添加' + (line_amount * 2) + '个自选企业');
                }
            }
            
            /*
             ***************************************************************
             *根据id设置div磁贴的鼠标左击事件，显示企业关系界面
             ***************************************************************
             */
            
            function rpt7010_set_jquery_click(div_id) {
                //jquery点击事件
                jQuery("#rpt7010" + div_id).click(function() {
                    //var id = this.id;
                    var index = div_id - 1;
                    var business_list = $('rpt7010_business_list_ds');
                    var bg_name = [];
                    var bg_display_name = [];
                    business_list.removeAll();
                    bg_name.push(rpt7010_select_bg_code[index]);
                    bg_display_name.push({
                        name: rpt7010_select_bg_name[index],
                        business_group_code: rpt7010_select_bg_code[index],
                        code: 0,
                        parent_code: -1,
                        sequence: 1
                    });
                    business_list.create(bg_display_name[0]);
                    new Aurora.Window({
                        id: 'rpt7010_detail_view',
                        title: '企业人脉',
                        url: $('rpt7010_detail_view_all_screen').getUrl() + '?bg_name=' + bg_name,
                        fullScreen: true
                    });
                });
            }
            
            /*
             ***************************************************************
             *根据id设置div磁贴删除事件，被删除的div磁贴后的div磁贴补进，
             *多行情况下注意缩进
             ***************************************************************
             */
            
            function rpt7010_set_jquery_cancel_metro(div_id) {
                jQuery("#rpt7010_" + div_id).mousedown(function(e) {
                    if (1 == e.which) {
                        //鼠标左键点击删除
                        var table = document.getElementById('rpt7010_select_table');
                        var td;
                        //var id = this.id;
                        var index = div_id - 1;
                        var order = rpt7010_select_bg_order[index] - 1;
                        //被删除的位置，从0开始算
                        var tr_index = parseInt(order / line_amount);
                        var td_index = parseInt(order % line_amount);
                        var tr = table.rows[tr_index];
                        //删除div磁贴
                        tr.deleteCell(td_index);
                        var rpt7010_select_table_rownum = table.rows.length;
                        //删除后将删除节点后的div磁贴往前挪一位，注意换行的磁贴
                        if (rpt7010_select_table_rownum > 1 + tr_index) {
                            //将除第一行外的其它每行的第一个div磁贴移到上一行最后的位置
                            for (var rownum = tr_index + 1;rownum < rpt7010_select_table_rownum;rownum++) {
                                tr = table.rows[rownum - 1];
                                td = tr.insertCell();
                                //获取被移动的div磁贴的id
                                var remove_id = (rownum) * line_amount + 1 + rpt7010_select_bg_cancel_amount;
                                var color = rpt_get_div_random_color();
                                td.innerHTML = '<div onmouseover="rpt7010_show(' + remove_id + ')" onmouseout="rpt7010_hide(' + remove_id + ')" class="rpt7010_self_set"><div id="rpt7010' + remove_id + '" class="tooltip-content"><div id="rpt7010_' + remove_id + '" class="close"><i class="fa icon-remove" style="font-size:40px"></i></div></div><div class="rpt7010_self_set_metro"><div id="rpt7010_business_select' + remove_id + '" class="live-tile ' + color + '" data-initdelay="10000" data-mode="flip" >' + '<div id="rpt7010_business_select' + remove_id + '_back" class="rpt7010_metro_back"></div>' + '<div id="rpt7010_business_select' + remove_id + '_front" class="rpt7010_metro_front"></div>' + '</div></div></div>';
                                //移动后删除原位置上的div磁贴
                                tr = table.rows[rownum];
                                tr.deleteCell(0);
                                //移除后再将原div上的内容复制过去
                                document.getElementById('rpt7010_business_select' + remove_id + '_front').innerHTML = '昨日订单数量：' + rpt7010_select_bg_detail[remove_id - 1].pur_amount_yesterday + '<br/>' + '今日订单数量：' + rpt7010_select_bg_detail[remove_id - 1].pur_amount_today + '<br/>' + '昨日送货单数：' + rpt7010_select_bg_detail[remove_id - 1].inv_amount_yesterday + '<br/>' + '今日送货单数：' + rpt7010_select_bg_detail[remove_id - 1].inv_amount_today;
                                //document.getElementById('rpt7010_business_select' + remove_id + '_back').innerHTML = rpt7010_select_bg_code[remove_id - 1] + '<br/>' + rpt7010_select_bg_name[remove_id - 1];
                                document.getElementById('rpt7010_business_select' + remove_id + '_back').innerHTML = '<div class="rpt7010_metroFront_leftSet"><i class="fa icon-group" style="font-size:40px"></i></div><div class="rpt7010_metroFront_rightSet"><div>集团名称</div><div style="font-size:18px">' + rpt7010_set_wordLength(rpt7010_select_bg_name[remove_id - 1], 6) + '</div><div>集团代码</div><div style="font-size:18px">' + rpt7010_set_wordLength(rpt7010_select_bg_code[remove_id - 1], 6) + '</div></div>';
                                //绑定jquery事件
                                jQuery("#rpt7010_business_select" + remove_id).liveTile();
                                rpt7010_set_jquery_click(remove_id);
                                rpt7010_set_jquery_cancel_metro(remove_id);
                            }
                        }
                        //移动后判断是否要删除最后一行
                        if ((rpt7010_select_bg_total_amount - rpt7010_select_bg_cancel_amount) % line_amount == 1) {
                            //将table的最后一行移除
                            table.deleteRow(table.rows.length - 1);
                        }
                        //删除后修改删除节点后的div磁贴的排序号
                        rpt7010_select_bg_order[index] = 0;
                        for (var i = index + 1;i < rpt7010_select_bg_total_amount;i++) {
                            rpt7010_select_bg_order[i] = rpt7010_select_bg_order[i] - 1;
                        }
                        //将存放已存div的id的数组rpt7010_select_bg_id[]的对应值删除
                        rpt7010_select_bg_id[index] = '';
                        //删除的数量加一
                        rpt7010_select_bg_cancel_amount++;
                    }
                });
            }
        ]]></script>
        <a:dataSets>
            <a:dataSet id="rpt7010_business_list_ds"/>
            <!-- 采购企业 -->
            <a:dataSet id="rpt7010_pur_totaAmount_all_ds" autoQuery="true" fetchAll="true" model="rpt.RPT7010.pur_totalAmount">
                <a:fields>
                    <a:field name="business_group_name" prompt="企业名称"/>
                    <a:field name="sum" prompt="交易额"/>
                </a:fields>
                <a:events>
                    <a:event name="load" handler="rpt7010_pur_totaAmount_all_load"/>
                </a:events>
            </a:dataSet>
            <a:dataSet id="rpt7010_pur_totaAmount_speed_ds" autoQuery="true" fetchAll="true" model="rpt.RPT7010.pur_totalAmout_speed_up">
                <a:fields>
                    <a:field name="business_group_name" prompt="企业名称"/>
                    <a:field name="speed" prompt="交易额增长速度"/>
                </a:fields>
                <a:events>
                    <a:event name="load" handler="rpt7010_pur_totaAmount_speed_load"/>
                </a:events>
            </a:dataSet>
            <a:dataSet id="rpt7010_pur_amount_active_ds" autoQuery="true" fetchAll="true" model="rpt.RPT7010.pur_amount_active">
                <a:fields>
                    <a:field name="business_group_name" prompt="企业名称"/>
                    <a:field name="amount" prompt="活跃度"/>
                </a:fields>
                <a:events>
                    <a:event name="load" handler="rpt7010_pur_amount_active_load"/>
                </a:events>
            </a:dataSet>
            <!-- 销售企业 -->
            <a:dataSet id="rpt7010_pur_vendor_totaAmount_all_ds" autoQuery="true" fetchAll="true" model="rpt.RPT7010.pur_vendor_totalAmount">
                <a:fields>
                    <a:field name="business_group_name" prompt="企业名称"/>
                    <a:field name="sum" prompt="交易额"/>
                </a:fields>
                <a:events>
                    <a:event name="load" handler="rpt7010_vendor_totaAmount_load"/>
                </a:events>
            </a:dataSet>
            <a:dataSet id="rpt7010_pur_vendor_totaAmount_speed_ds" autoQuery="true" fetchAll="true" model="rpt.RPT7010.pur_vendor_totalAmout_speed_up">
                <a:fields>
                    <a:field name="business_group_name" prompt="企业名称"/>
                    <a:field name="speed" prompt="交易额增长速度"/>
                </a:fields>
                <a:events>
                    <a:event name="load" handler="rpt7010_vendor_speed_load"/>
                </a:events>
            </a:dataSet>
            <a:dataSet id="rpt7010_pur_vendor_amount_active_ds" autoQuery="true" fetchAll="true" model="rpt.RPT7010.pur_vendor_amount_active">
                <a:fields>
                    <a:field name="business_group_name" prompt="企业名称"/>
                    <a:field name="amount" prompt="活跃度"/>
                </a:fields>
                <a:events>
                    <a:event name="load" handler="rpt7010_vendor_active_load"/>
                </a:events>
            </a:dataSet>
            <!-- 新入企业 -->
            <a:dataSet id="rpt7010_business_group_new_ds" autoQuery="true" fetchAll="true" model="rpt.RPT7010.fnd_business_new_in">
                <a:fields>
                    <a:field name="business_group_code"/>
                    <a:field name="business_group_name"/>
                    <a:field name="pur_amount_yesterday"/>
                    <a:field name="pur_amount_today"/>
                    <a:field name="inv_amount_yesterday"/>
                    <a:field name="inv_amount_today"/>
                </a:fields>
                <a:events>
                    <a:event name="load" handler="rpt7010_business_group_load"/>
                </a:events>
            </a:dataSet>
            <!--自选企业-->
            <a:dataSet id="rpt7010_business_group_select_ds">
                <a:fields>
                    <a:field name="business_group" autoComplete="true" autoCompleteField="business_group_code" lovHeight="500" lovService="rpt.RPT7010.fnd_business_group_lov" lovWidth="600" title="自选集团">
                        <a:mapping>
                            <a:map from="business_group_id" to="business_group_id"/>
                            <a:map from="business_group_code" to="business_group_code"/>
                            <a:map from="business_group_name" to="business_group"/>
                            <a:map from="pur_amount_yesterday" to="pur_amount_yesterday"/>
                            <a:map from="pur_amount_today" to="pur_amount_today"/>
                            <a:map from="inv_amount_yesterday" to="inv_amount_yesterday"/>
                            <a:map from="inv_amount_today" to="inv_amount_today"/>
                        </a:mapping>
                    </a:field>
                </a:fields>
            </a:dataSet>
        </a:dataSets>
        <!-- <div style="width:100%;background-color:#fff;overflow:hidden"> -->
        <article id="rpt7010_bg" class="kontext" style="overflow:hidden;width:100%;height:100%;background-color:#fff">
            <div class="layer one show" style="width:100%">
                <div id="rpt7010_title1" style="width:100%;font-size:26px;color:red;text-align:center;margin-left:0">
                    <strong><![CDATA[采购企业]]></strong>
                </div>
                <div id="wrapper">
                    <ul id="rpt7010_priceTable1" style="width:100%">
                        <li class="priceItem active">
                            <ul>
                                <li id="rpt7010_aurora_chart1" data-animate="fadeInRightBig">
                                    <a:chart backgroundColor="" bindTarget="rpt7010_pur_totaAmount_all_ds" borderWidth="0" style="width:100%" type="column">
                                        <a:title style="font-size:16px;font-family:Microsoft YaHei" text="采购企业交易额排行榜-上周"/>
                                        <a:xAxis>
                                            <a:xAxi name="business_group_name">
                                                <a:labels formatter="rpt7010_chart_column1_x_format" rotation="-30" style="font-size:12px;font-family:Microsoft YaHei"/>
                                            </a:xAxi>
                                        </a:xAxis>
                                        <a:yAxis>
                                            <a:yAxi name="sum" allowDecimals="false" min="0">
                                                <a:title style="font-size:12px;font-family:Microsoft YaHei" text="交易金额"/>
                                            </a:yAxi>
                                        </a:yAxis>
                                        <a:tooltip formatter="rpt7010_chart_column1_format"/>
                                        <a:plotOptions>
                                            <a:chartcolumn stacking="normal"/>
                                        </a:plotOptions>
                                        <a:events>
                                            <a:event name="click" handler="rpt7010_chart_click1"/>
                                        </a:events>
                                    </a:chart>
                                </li>
                            </ul>
                        </li>
                        <li class="priceItem">
                            <ul>
                                <li id="rpt7010_aurora_chart2" data-animate="flip" style="width:180%">
                                    <a:chart backgroundColor="" bindTarget="rpt7010_pur_totaAmount_speed_ds" borderWidth="0" style="width:100%" type="column">
                                        <a:title style="font-size:16px;font-family:Microsoft YaHei" text="采购企业交易额增速排行榜-上周"/>
                                        <a:xAxis>
                                            <a:xAxi name="business_group_name">
                                                <a:labels formatter="rpt7010_chart_column1_x_format" rotation="-30" style="font-size:12px;font-family:Microsoft YaHei"/>
                                            </a:xAxi>
                                        </a:xAxis>
                                        <a:yAxis>
                                            <a:yAxi name="speed" allowDecimals="false" min="0">
                                                <a:title style="font-size:12px;font-family:Microsoft YaHei" text="增长速度"/>
                                            </a:yAxi>
                                        </a:yAxis>
                                        <a:tooltip formatter="rpt7010_chart_column2_format"/>
                                        <a:events>
                                            <a:event name="click" handler="rpt7010_chart_click2"/>
                                        </a:events>
                                    </a:chart>
                                </li>
                            </ul>
                        </li>
                        <li class="priceItem">
                            <ul>
                                <li id="rpt7010_aurora_chart3" data-animate="pulse" style="width:180%">
                                    <a:chart backgroundColor="" bindTarget="rpt7010_pur_amount_active_ds" borderWidth="0" style="width:100%" type="column">
                                        <a:title style="font-size:16px;font-family:Microsoft YaHei" text="采购企业交易活跃度-上周"/>
                                        <a:xAxis>
                                            <a:xAxi name="business_group_name">
                                                <a:labels formatter="rpt7010_chart_column1_x_format" rotation="-30" style="font-size:12px;font-family:Microsoft YaHei"/>
                                            </a:xAxi>
                                        </a:xAxis>
                                        <a:yAxis>
                                            <a:yAxi name="amount" allowDecimals="false" min="0">
                                                <a:title style="font-size:12px;font-family:Microsoft YaHei" text="活跃度"/>
                                            </a:yAxi>
                                        </a:yAxis>
                                        <a:tooltip formatter="rpt7010_chart_column2_format"/>
                                        <a:plotOptions>
                                            <a:chartcolumn stacking="normal"/>
                                        </a:plotOptions>
                                        <a:events>
                                            <a:event name="click" handler="rpt7010_chart_click3"/>
                                        </a:events>
                                    </a:chart>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="layer two" style="width:100%;">
                <div id="rpt7010_title2" style="width:100%;font-size:26px;color:red;text-align:center;">
                    <strong><![CDATA[销售企业]]></strong>
                </div>
                <div id="wrapper">
                    <ul id="rpt7010_priceTable2" style="width:100%">
                        <li class="priceItem active">
                            <ul>
                                <li data-animate="fadeIn">
                                    <div id="rpt7010_sell_main"/>
                                </li>
                            </ul>
                        </li>
                        <!-- <a:chart  bindTarget="rpt7010_pur_vendor_totaAmount_all_ds" borderWidth="0" height="400" type="column" width="430">
                            <a:title text="销售企业交易额排行榜"/>
                            <a:xAxis>
                                <a:xAxi name="business_group_name">
                                    <a:labels formatter="rpt7010_chart_column1_x_format" rotation="-30"/>
                                </a:xAxi>
                            </a:xAxis>
                            <a:yAxis>
                                <a:yAxi name="sum" allowDecimals="false" min="0">
                                    <a:title text="交易金额"/>
                                </a:yAxi>
                            </a:yAxis>
                            <a:tooltip formatter="rpt7010_chart_column1_format"/>
                            <a:plotOptions>
                                <a:chartcolumn stacking="normal"/>
                            </a:plotOptions>
                        </a:chart> -->
                        <li class="priceItem">
                            <ul>
                                <li data-animate="rotateIn">
                                    <div id="rpt7010_sell_main2"/>
                                    <!-- <a:chart bindTarget="rpt7010_pur_vendor_totaAmount_speed_ds" borderWidth="0" height="380" type="column" width="430">
                                            <a:title text="销售企业交易额增速排行榜"/>
                                            <a:xAxis>
                                                <a:xAxi name="business_group_name">
                                                    <a:labels formatter="rpt7010_chart_column1_x_format" rotation="-30"/>
                                                </a:xAxi>
                                            </a:xAxis>
                                            <a:yAxis>
                                                <a:yAxi name="speed" allowDecimals="false" min="0">
                                                    <a:title text="增长率%"/>
                                                </a:yAxi>
                                            </a:yAxis>
                                            <a:tooltip formatter="rpt7010_chart_column2_format"/>
                                            <a:plotOptions>
                                                <a:chartcolumn stacking="normal"/>
                                            </a:plotOptions>
                                        </a:chart> -->
                                </li>
                            </ul>
                        </li>
                        <li class="priceItem">
                            <ul>
                                <li data-animate="lightSpeedIn">
                                    <div id="rpt7010_sell_main3"/>
                                    <!-- <a:chart bindTarget="rpt7010_pur_vendor_amount_active_ds" borderWidth="0" height="380" type="column" width="430">
                                            <a:title text="销售企业企业交易活跃度"/>
                                            <a:xAxis>
                                                <a:xAxi name="business_group_name">
                                                    <a:labels formatter="rpt7010_chart_column1_x_format" rotation="-30"/>
                                                </a:xAxi>
                                            </a:xAxis>
                                            <a:yAxis>
                                                <a:yAxi name="amount" allowDecimals="false" min="0">
                                                    <a:title text="活跃度"/>
                                                </a:yAxi>
                                            </a:yAxis>
                                            <a:tooltip formatter="rpt7010_chart_column1_format"/>
                                            <a:plotOptions>
                                                <a:chartcolumn stacking="normal"/>
                                            </a:plotOptions>
                                        </a:chart> -->
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
            <script><![CDATA[
                // echarts路径配置
                require.config({
                    paths: {
                        echarts: 'http://echarts.baidu.com/build/dist'
                    }
                });
                
                //图标y轴显示过长时的优化设置
                
                function rpt7010_yaxis_value_set(value) {
                    value = parseInt(value);
                    if (value >= 100000000) {
                        value = value / 100000000 + '亿';
                    } else if (value >= 10000) {
                        value = value / 10000 + '万';
                    }
                    return value;
                }
                
                function rpt7010_draw_echart_barType2(x_data, y_data) {
                    // 使用
                    require(['echarts', 'echarts/chart/bar', // 使用柱状图就加载bar模块，按需加载
                    'echarts/chart/line'], function(ec) {
                        // 基于准备好的dom，初始化echarts图表
                        var myChart = ec.init(document.getElementById('rpt7010_sell_main2'));
                
                        option = {
                            title: {
                                x: 'center',
                                text: '销售企业增速排行榜-上周',
                                textStyle: {
                                    fontFamily: 'Microsoft YaHei'
                                }
                            },
                            tooltip: {
                                trigger: 'item'
                            },
                            toolbox: {
                                show: true,
                                feature: {
                                    dataView: {
                                        show: true,
                                        readOnly: false
                                    },
                                    magicType: {
                                        show: true,
                                        type: ['line', 'bar']
                                    },
                                    restore: {
                                        show: true
                                    }
                                }
                            },
                            calculable: true,
                            grid: {
                                x: 40,
                                y: 70,
                                x2: 20,
                                y2: 50
                            },
                            xAxis: [{
                                type: 'category',
                                data: x_data,
                                axisLabel: {
                                    interval: 0,
                                    rotate: 30,
                                    textStyle: {
                                        fontSize: 12,
                                        fontFamily: 'Microsoft YaHei'
                                    },
                                    formatter: function(value) {
                                        return rpt7010_substr(value, 0, 5);
                                    }
                                }
                            }],
                            yAxis: [{
                                type: 'value',
                                axisLabel: {
                                    textStyle: {
                                        fontSize: 12,
                                        fontFamily: 'Microsoft YaHei'
                                    },
                                    formatter: function(value) {
                                        return rpt7010_yaxis_value_set(value);
                                    }
                                }
                            }],
                            series: [{
                                name: '销售企业增速排行榜-上周',
                                type: 'bar',
                                itemStyle: {
                                    normal: {
                                        color: 'rgba(193,35,43,0.5)',
                                        barBorderRadius: 10,
                                        label: {
                                            show: true,
                                            formatter: function(a, b, c) {
                                                return c > 0 ? (c + '\n') : '';
                                            }
                                        }
                                    },
                                    emphasis: {
                                        barBorderRadius: 10
                                    }
                                },
                                data: y_data
                            }]
                        };
                        // 为echarts对象加载数据
                        myChart.setOption(option);
                    });
                }
                
                function rpt7010_draw_echart_barType3(x_data, y_data, main_id, title_name) {
                    // 使用
                    require(['echarts', 'echarts/chart/bar', // 使用柱状图就加载bar模块，按需加载
                    'echarts/chart/line'], function(ec) {
                        // 基于准备好的dom，初始化echarts图表
                        var myChart = ec.init(document.getElementById(main_id));
                
                        option = {
                            title: {
                                x: 'center',
                                text: title_name + '-上周',
                                textStyle: {
                                    fontFamily: 'Microsoft YaHei'
                                }
                            },
                            tooltip: {
                                trigger: 'item'
                            },
                            toolbox: {
                                show: true,
                                feature: {
                                    dataView: {
                                        show: true,
                                        readOnly: false
                                    },
                                    magicType: {
                                        show: true,
                                        type: ['line', 'bar']
                                    },
                                    restore: {
                                        show: true
                                    }
                                }
                            },
                            grid: {
                                x: 50,
                                y: 70,
                                x2: 42,
                                y2: 50
                            },
                            calculable: true,
                            xAxis: [{
                                type: 'category',
                                data: x_data,
                                axisLabel: {
                                    interval: 0,
                                    rotate: 30,
                                    textStyle: {
                                        fontSize: 12,
                                        fontFamily: 'Microsoft YaHei'
                                    },
                                    formatter: function(value) {
                                        return rpt7010_substr(value, 0, 5);
                                    }
                                }
                            }],
                            yAxis: [{
                                type: 'value',
                                axisLabel: {
                                    textStyle: {
                                        fontSize: 12,
                                        fontFamily: 'Microsoft YaHei'
                                    },
                                    formatter: function(value) {
                                        return rpt7010_yaxis_value_set(value);
                                    }
                                }
                            }],
                            series: [{
                                name: title_name + '-上周',
                                type: 'bar',
                                itemStyle: {
                                    normal: {
                                        color: function(params) {
                                            // build a color map as your need.
                                            var colorList = ['#C1232B', '#B5C334', '#FCCE10', '#E87C25', '#27727B', '#FE8463', '#9BCA63', '#FAD860', '#F3A43B', '#60C0DD', '#D7504B', '#C6E579', '#F4E001', '#F0805A'];
                                            return colorList[params.dataIndex];
                                        },
                                        barBorderRadius: 10
                                    },
                                    emphasis: {
                                        barBorderRadius: 10
                                    }
                                },
                                data: y_data
                            }]
                        };
                        if (x_data.length > 0) {
                            option.series[0].markPoint = {
                                data: [{
                                    type: 'max',
                                    name: '最大值'
                                }, {
                                    type: 'min',
                                    name: '最小值'
                                }]
                            };
                            option.series[0].markLine = {
                                data: [{
                                    type: 'average',
                                    name: '平均值'
                                }]
                            };
                        }
                        // 为echarts对象加载数据
                        myChart.setOption(option);
                    });
                }
            ]]></script>
            <div class="layer three" style="width:100%">
                <div id="rpt7010_title3" style="width:100%x;height:80px;line-height:80px;font-size:26px;color:red;text-align:center;">
                    <strong><![CDATA[新入企业]]></strong>
                </div>
                <div id="rpt7010_metro_div" class="tiles white" style="color:#ffffff;height:380px;background-color:#fff"/>
                <div style="position:absolute;bottom:50px;width:100%;text-align:center;display:none">
                    <ul id="rpt7010_newIn_pageSize_ul_id" class="rpt7010_pagination"><![CDATA[
                            ]]></ul>
                </div>
            </div>
            <div class="layer four" style="width:100%">
                <div id="rpt7010_title4" style="width:100%;height:80px;line-height:80px;font-size:26px;color:red;text-align:center">
                    <strong><![CDATA[自选企业]]></strong>
                </div>
                <div id="rpt7010_hBox1" style="width:100%;text-align:center;">
                    <a:hBox style="margin:0 auto">
                        <a:lov name="business_group" bindTarget="rpt7010_business_group_select_ds" prompt="自选企业"/>
                        <a:toolbarButton click="rpt7010_add_selected_bg" text="添加磁贴" width="90"/>
                        <!-- <input class="button-rectangle small easy-black" onclick="rpt7010_add_selected_bg()" type="button" value="添加磁贴"/> -->
                    </a:hBox>
                </div>
                <div id="rpt7010_metro_div2" class="tiles white" style="color:#ffffff;background-color:#fff">
                    <table id="rpt7010_select_table"><![CDATA[
                        ]]></table>
                </div>
                <nav style="position:absolute;width:500px;text-align:left;">
                    <ul id="rpt7010_self_pageSize_ul_id" class="pagination"><![CDATA[
                            ]]></ul>
                </nav>
            </div>
        </article>
        <!-- </div> -->
        <ul class="bullets"/>
        <script><![CDATA[
            //设置报表放大缩小效果
            jQuery(document).ready(function() {
                jQuery('#rpt7010_priceTable1').priceTable();
                jQuery('#rpt7010_priceTable2').priceTable();
            });
            rpt7010_set_size();
            //分页效果设置
            
            function rpt7010_refresh() {
                var k = kontext(document.querySelector('.kontext'));
            
                var bulletsContainer = document.body.querySelector('.bullets');
            
                //分页设置
                for (var i = 0,
                    len = k.getTotal();i < len;i++) {
                    var bullet = document.createElement('li');
                    bullet.className = i === 0 ? 'active' : '';
                    bullet.setAttribute('index', i);
                    bullet.onclick = function(event) {
                        k.show(event.target.getAttribute('index'));
                    };
                    bullet.ontouchstart = function(event) {
                        k.show(event.target.getAttribute('index'));
                    };
                    bulletsContainer.appendChild(bullet);
                }
            
                k.changed.add(function(layer, index) {
                    var bullets = document.body.querySelectorAll('.bullets li');
                    for (var i = 0,
                        len = bullets.length;i < len;i++) {
                        bullets[i].className = i === index ? 'active' : '';
                    }
                });
            
                //绑定键盘左右键
                document.addEventListener('keyup', function(event) {
                    //键盘上的左右键
                    if (event.keyCode === 37) {
                        k.prev();
                    }
                    if (event.keyCode === 39) {
                        k.next();
                    }
                }, false);
            
                var touchX = 0;
                var touchConsumed = false;
            }
            rpt7010_refresh();
        ]]></script>
    </a:view>
</a:screen>
