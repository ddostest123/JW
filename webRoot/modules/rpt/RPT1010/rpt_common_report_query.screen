<?xml version="1.0" encoding="UTF-8"?>
<a:screen xmlns:a="http://www.aurora-framework.org/application" trace="true">
    <a:init-procedure>
        <a:model-update model="rpt.RPT1080.rpt_setting_headers"/>
        <a:model-execute model="db.rpt_common_report_query_pkg.rpt_common_frequency_query"/>
    </a:init-procedure>
    <a:view>
        <!--css引入  -->
        <link href="${/request/@context_path}/index/css/rpt1010_view.css?v=1.1" rel="stylesheet" type="text/css"/>
        <link href="${/request/@context_path}/component/handReceiveFairComponent/handReceiveFairComponent.css?v=1.1" rel="stylesheet" type="text/css"/>
        <script language="JavaScript" src="${/request/@context_path}/index/js/jquery-1.8.3.min.js"/>
        <script language="JavaScript" src="${/request/@context_path}/component/handMove.js"/>
        <script><![CDATA[jQuery.noConflict();]]></script>
        <!--点击报表打开的串口  -->
        <a:link id="rpt1010_5010_screen" url="${/request/@context_path}/modules/rpt/RPT5010/pur_po_item_rpt.screen"/>
        <a:link id="rpt1010_5020_screen" url="${/request/@context_path}/modules/rpt/RPT5020/pur_po_vender_rpt.screen"/>
        <a:link id="rpt1010_5030_screen" url="${/request/@context_path}/modules/rpt/RPT5030/pur_po_item_list_rpt.screen"/>
        <a:link id="rpt1010_5040_screen" url="${/request/@context_path}/modules/rpt/RPT5040/pur_po_vender_list.screen"/>
        <a:link id="rpt1010_5050_screen" url="${/request/@context_path}/modules/rpt/RPT5050/pur_po_item_org_form.screen"/>
        <a:link id="rpt1010_5060_screen" url="${/request/@context_path}/modules/rpt/RPT5060/pur_po_item_vender_form.screen"/>
        <a:link id="rpt1010_btn_refresh_link" model="db.rpt_common_report_query_pkg.rpt_common_frequency_query" modelaction="execute"/>
        <a:link id="rpt1010_mtl_screen" url="${/request/@context_path}/modules/mtl/MTL1050/mtl_category_user_defined_main.screen"/>
        <a:link id="rpt1010_auto_refresh_link" model="db.rpt_common_report_query_pkg.rpt_common_frequency_query" modelaction="update"/>
        <a:link id="rpt1010_enable_back_link" model="db.rpt_common_report_query_pkg.rpt_common_frequency_query" modelaction="insert"/>
        <a:link id="rpt1010_single_refresh_link" model="db.rpt_common_report_query_pkg.rpt_common_frequency_query" modelaction="delete"/>
        <script><![CDATA[
            var rpt1010_category_name_index = -1;
            var rpt1010_vendor_name_index = -1;
            var rptCode = ['RPT5010', 'RPT5020', 'RPT5030', 'RPT5040', 'RPT5050', 'RPT5060'];
            var rpttype = ['line', 'line', 'column', 'column', 'pie', 'pie'];
            var rptObject = [];
            //搜索下拉框设置
            var rptSerch = {
                input: null,
                inputInitValue: null,
                searchUl: null,
                searchTypeName: null,
                searchContent: null,
                listOnshowFlag: false,
                selectType: 'item',
                selectId: null,
                onShowTab: null,
                queryVendorFlag: false,
                keyBindFunction: null
            };
            
            function rpt1010_query_init() {
                rpt5010Init();
                rpt5020Init();
                rpt5030Init();
                rpt5040Init();
                rpt5050Init();
                rpt5060Init();
                $('rpt1010_setting_ds').query();
                initWidth();
                rptObjectInit();
            }
            
            function initWidth() {
                var input = getId('rpt1010_query_input');
                input.style.width = input.parentNode.offsetWidth - 230 + 'px';
            }
            
            function rptObjectInit() {
                for (var i = 0;i < rptCode.length;i++) {
                    rptObject.push({
                        code: rptCode[i],
                        obj: getId(rptCode[i] + '_chart'),
                        type: rpttype[i],
                        showFlag: true
                    });
                }
            }
            
            function rptInit(id) {
                var li = getId(id).children[0];
                rptSettingSwitch(li);
            }
            
            function rptWholeRefresh(){
                if(Aurora.isEmpty(rptSerch.selectId)){
                    showRptType(['RPT5010', 'RPT5020', 'RPT5030', 'RPT5040', 'RPT5050', 'RPT5060']);
                }
                for(var i = 1;i <= 6;i ++){
                    rptInit('rpt_setting_' + i);
                }
            }
            
            function rpt5010Init() {
                rpt1010_category_name_index = -1;
                var chart = getId('rpt1010_5010_chart');
                Aurora.Masker.mask(chart, '查询中..');
                var ds = $('rpt1010_5010_data_option');
                var dds = $('rpt1010_5010_chart_data_ds');
                ds.setQueryParameter('item_category_id', rptSerch.selectId);
                dds.setQueryParameter('item_category_id', rptSerch.selectId);
                $('rpt1010_5010_data_option').query();
            }
            
            function rpt5020Init() {
                rpt1010_vendor_name_index = -1;
                var chart = getId('rpt1010_5020_chart');
                Aurora.Masker.mask(chart, '查询中..');
                var ds = $('rpt1010_5020_data_option');
                var dds = $('rpt1010_5020_chart_data_ds');
                ds.setQueryParameter('vendor_id', rptSerch.selectId);
                dds.setQueryParameter('vendor_id', rptSerch.selectId);
                $('rpt1010_5020_data_option').query();
            }
            
            function rpt5030Init() {
                var chart = getId('rpt1010_5030_chart');
                Aurora.Masker.mask(chart, '查询中..');
                var ds = $('rpt1010_5030_chart_data_ds');
                ds.setQueryParameter('item_category_id', rptSerch.selectId);
                $('rpt1010_5030_chart_data_ds').query();
            }
            
            function rpt5040Init() {
                var chart = getId('rpt1010_5040_chart');
                Aurora.Masker.mask(chart, '查询中..');
                var ds = $('rpt1010_5040_chart_data_ds');
                ds.setQueryParameter('vendor_id', rptSerch.selectId);
                $('rpt1010_5040_chart_data_ds').query();
            }
            
            function rpt5050Init() {
                var chart = getId('rpt1010_5050_chart');
                Aurora.Masker.mask(chart, '查询中..');
                var ds = $('rpt1010_5050_chart_data_ds');
                ds.setQueryParameter('item_category_id', rptSerch.selectId);
                $('rpt1010_5050_chart_data_ds').query();
            }
            
            function rpt5060Init() {
                var chart = getId('rpt1010_5060_chart');
                Aurora.Masker.mask(chart, '查询中..');
                var ds = $('rpt1010_5060_chart_data_ds');
                ds.setQueryParameter('item_category_id', rptSerch.selectId);
                $('rpt1010_5060_chart_data_ds').query();
            }
            
            function rpt1010_refrsh() {
                rpt1010_btn_click_flag = 1;
                rpt1010_category_name_index = -1;
                rpt1010_vendor_name_index = -1;
                Aurora.request({
                    url: $('rpt1010_btn_refresh_link').getUrl() + '?p_btn_click_flag=' + rpt1010_btn_click_flag,
                    success: function() {
                        rpt1010_query_init();
                    },
                    scope: this
                });
            }
            
            function getId(id) {
                return document.getElementById(id);
            }
            
            function rptOpenSelectWindow(_this) {
                var w = _this.nextSibling;
                if (w.style.display != 'block') {
                    w.style.display = 'block';
                } else {
                    w.style.display = 'none';
                }
            }
            
            function rpt_setting_load(ds) {
                var records = ds.getAll();
                for (var i = 0;i < records.length;i++) {
                    var data = records[i].data;
                    rptUsualSetting(data);
                }
            }
            
            function rptUsualSetting(data) {
                for (var i = 0;i < rptCode.length;i++) {
                    if (data.rpt_code == rptCode[i]) {
                        var ul = getId('rpt_setting_' + (i + 1));
                        var li = document.createElement('LI');
                        if (data.enable_flag == 'Y') {
                            li.className = 'active';
                            ul.setAttribute('onIndex', ul.children.length);
                        }
                        li.innerText = data.rpt_setting_desc;
                        li.setAttribute('id', data.rpt_line_id);
                        li.setAttribute('index', ul.children.length);
                        li.onclick = function() {
                            rptSettingSwitch(this);
                        };
                        ul.appendChild(li);
                    }
                }
            }
            
            function rptSettingSwitch(_this) {
                /* if (_this.className == 'active') {
                 return;
                 } */
                var lis = _this.parentNode.children;
                var ul = _this.parentNode;
                var onIndex = ul.getAttribute('onIndex');
                lis[onIndex].className = '';
                _this.className = 'active';
                ul.setAttribute('onIndex', _this.getAttribute('index'));
                //刷新报表数据
                Aurora.request({
                    url: $('rpt1010_auto_refresh_link').getUrl(),
                    para: {
                        'line_id': _this.id
                    },
                    success: function(result) {
                        var header_id = result.result.header_id;
                        var rpt_code = result.result.rpt_code;
                        var ds;
                        switch (rpt_code) {
                        case rptCode[0]:
                            rpt5010Init();
                            break;
                        case rptCode[1]:
                            rpt5020Init();
                            break;
                        case rptCode[2]:
                            rpt5030Init();
                            break;
                        case rptCode[3]:
                            rpt5040Init();
                            break;
                        case rptCode[4]:
                            rpt5050Init();
                            break;
                        case rptCode[5]:
                            rpt5060Init();
                            break;
                        }
                    }
                });
            }
            
            function openDetailRptWindow1() {
                new Aurora.Window({
                    id: 'rpt1010_go5010_screen',
                    title: '${l:RPT.RPT1010_ITEM_DEVELOPE_ANALYSE_RPT}',
                    url: $('rpt1010_5010_screen').getUrl(),
                    fullScreen: true
                });
            }
            
            function openDetailRptWindow2() {
                new Aurora.Window({
                    id: 'rpt1010_go5020_screen',
                    title: '${l:RPT.RPT1010_VENDOR_DEVELOPE_ANALYSE_RPT}',
                    url: $('rpt1010_5020_screen').getUrl(),
                    fullScreen: true
                });
            }
            
            function openDetailRptWindow3() {
                new Aurora.Window({
                    id: 'rpt1010_go5030_screen',
                    title: '${l:RPT.RPT1010_ITEM_LIST_RPT}',
                    url: $('rpt1010_5030_screen').getUrl(),
                    fullScreen: true
                });
            }
            
            function openDetailRptWindow4() {
                new Aurora.Window({
                    id: 'rpt1010_go5040_screen',
                    title: '${l:RPT.RPT1010_VENDOR_LIST_RPT}',
                    url: $('rpt1010_5040_screen').getUrl(),
                    fullScreen: true
                });
            }
            
            function openDetailRptWindow5() {
                new Aurora.Window({
                    id: 'rpt1010_go5050_screen',
                    title: '${l:RPT.RPT1010_ITEM_ORG_FORM_RPT}',
                    url: $('rpt1010_5050_screen').getUrl(),
                    fullScreen: true
                });
            }
            
            function openDetailRptWindow6() {
                new Aurora.Window({
                    id: 'rpt1010_go5060_screen',
                    title: '${l:RPT.RPT1010_VENDOR_ORG_FORM_RPT}',
                    url: $('rpt1010_5060_screen').getUrl(),
                    fullScreen: true
                });
            }
            //折线图的legend的展示信息设置
            
            function rpt1010_label_format1() {
                var name_ds = $('rpt1010_5010_data_option').getAll();
                rpt1010_category_name_index++;
                return rpt1010_substr(name_ds[rpt1010_category_name_index].get('item_category_name'), 0, 5);
            }
            
            function rpt1010_label_format2() {
                var name_ds = $('rpt1010_5020_data_option').getAll();
                rpt1010_vendor_name_index++;
                return rpt1010_substr(name_ds[rpt1010_vendor_name_index].get('vendor_name'), 0, 5);
            }
            //鼠标滑过报表内容时显示的信息-折线图
            
            function rpt1010_toolFormat1() {
                var html = ['<table><caption>', this.x, '</caption><br>'];
                var name_ds = $('rpt1010_5010_data_option').getAll();
                if(name_ds.length == 0){
                    html.push();
                    return html.join('<br></table>');
                }
                var y;
                for (var i = 0;i < this.points.length;i++) {
                    html.push('<tr>', '<td style="color:', this.points[i].series.color, '">', rpt1010_substr(name_ds[i].get('item_category_name'), 0, 5), ': ', '</td>', '<td style="text-align:right"><b>', this.points[i].y, '万</b></td>', '</tr><br>');
                }
                html.push('</table>');
                return html.join('');
            }
            
            function rpt1010_toolFormat2() {
                var html = ['<table><caption>', this.x, '</caption><br>'];
                var name_ds = $('rpt1010_5020_data_option').getAll();
                if(name_ds.length == 0){
                    html.push();
                    return html.join('<br></table>');
                }
                for (var i = 0;i < this.points.length;i++) {
                    html.push('<tr>', '<td style="color:', this.points[i].series.color, '">', rpt1010_substr(name_ds[i].get('vendor_name'), 0, 5), ': ', '</td>', '<td style="text-align:right"><b>', this.points[i].y, '万</b></td>', '</tr><br>');
                }
                html.push('</table>');
                return html.join('');
            }
            
            //鼠标滑过报表内容时显示的信息-柱状图
            
            function rpt1010_formatter1() {
                return '<b>' + this.x + '</b><br/>' + this.series.name + ': ' + this.y + '万';
            }
            
            //鼠标滑过报表内容时显示的信息-饼状图
            
            function rpt1010_formatter2() {
                return '<b>' + rpt1010_substr(this.point.name, 0, 5) + '</b>: ' + Aurora.formatNumber(this.percentage, 2) + ' %';
            }
            
            //截取过长的字符串,第一个字符的起始位置为0
            
            function rpt1010_substr(str, begin, length) {
                if(Aurora.isEmpty(str.length)){
                    return str;
                }
                if (str.length - begin > length) {
                    return str.substr(begin, length) + '...';
                } else {
                    return str.substr(begin);
                }
            }
            
            function rpt1010_column_label_format1() {
                return rpt1010_substr(this.value, 0, 5);
            }
            
            function rpt5010_data_pre_load() {
                $('rpt1010_5010_chart_data_ds').query();
            }
            
            function rpt5010_data_load() {
                enableBack('RPT5010');
                var chart = getId('rpt1010_5010_chart');
                Aurora.Masker.unmask(chart);
            }
            
            function rpt5020_data_pre_load() {
                $('rpt1010_5020_chart_data_ds').query();
            }
            
            function rpt5020_data_load() {
                enableBack('RPT5020');
                var chart = getId('rpt1010_5020_chart');
                Aurora.Masker.unmask(chart);
            }
            
            function rpt5030_data_load() {
                enableBack('RPT5030');
                var chart = getId('rpt1010_5030_chart');
                Aurora.Masker.unmask(chart);
            }
            
            function rpt5040_data_load() {
                enableBack('RPT5040');
                var chart = getId('rpt1010_5040_chart');
                Aurora.Masker.unmask(chart);
            }
            
            function rpt5050_data_load() {
                enableBack('RPT5050');
                var chart = getId('rpt1010_5050_chart');
                Aurora.Masker.unmask(chart);
            }
            
            function rpt5060_data_load() {
                enableBack('RPT5060');
                var chart = getId('rpt1010_5060_chart');
                Aurora.Masker.unmask(chart);
            }
            
            function enableBack(rpt_code) {
                Aurora.request({
                    url: $('rpt1010_enable_back_link').getUrl(),
                    para: {
                        'rpt_code': rpt_code
                    }
                });
            }
            
            function queryInputOnfocus(_this) {
                if (_this.value == rptSerch.inputInitValue) {
                    _this.value = '';
                    rptSerch.searchContent = '';
                    rptSerch.selectId = null;
                }else{
                    eval(rptSerch.keyBindFunction);
                }
            }
            
            function queryInputOnBlur(_this, e) {
                if (_this.value == '') {
                    _this.value = rptSerch.inputInitValue;
                    rptSerch.searchContent = '';
                    rptSerch.selectId = null;
                }
            }
            
            function queryInItem() {
                var value = getId('rpt1010_query_input').value;
            }
            
            function QueryItmeLoad(ds) {
                var ul = getId('rptQueryUl');
                var tab = getId('queryTab1');
                rptSerch.input = getId('rpt1010_query_input');
                rptSerch.inputInitValue = '请输入品类';
                rptSerch.input.value = rptSerch.inputInitValue;
                rptSerch.searchTypeName = 'item_category_id';
                rptSerch.searchUl = ul;
                rptSerch.onShowTab = tab;
                rptSerch.selectType = tab.getAttribute('type');
                rptSerch.input.onkeydown = searchKeyDown;
                rptSerch.input.onkeyup = searchKeyUp;
                rptSerch.keyBindFunction = 'createQueryUlContent()';
                jDawn.bindEvent(document, 'mousedown', function(e) {
                    e = e || window.event;
                    var target = e.srcElement || e.target;
                    if (target.tagName != 'LI' && target.tagName != 'INPUT' && target.id != 'rptQueryUl') {
                        rptSerch.searchUl.style.display = 'none';
                    }
                });
            }
            
            function QueryVendorLoad(ds) {
                rptSerch.queryVendorFlag = true;
            }
            //键盘按下事件
            function searchKeyDown(e) {
                e = e || event;
                var currKey = e.keyCode || e.which || e.charCode;
                rptSerch.searchContent = rptSerch.input.value;
                if (currKey == 32 || (currKey >= 48 && currKey <= 57) || (currKey >= 65 && currKey <= 90)) {
                    eval(rptSerch.keyBindFunction);
                }
            }
            //键盘抬起事件
            function searchKeyUp(e) {
                e = e || event;
                var currKey = e.keyCode || e.which || e.charCode;
                rptSerch.searchContent = rptSerch.input.value;
                if (currKey == 32 || (currKey >= 48 && currKey <= 57) || (currKey >= 65 && currKey <= 90)) {
                    eval(rptSerch.keyBindFunction);
                } else if (currKey == 8) {
                    eval(rptSerch.keyBindFunction);
                }
            }
            
            function createQueryUlContent() {
                var records = $('rpt1010_query_item_ds').getAll();
                rptSerch.listOnshowFlag = false;
                rptSerch.searchUl.innerHTML = '';
                if (!Aurora.isEmpty(rptSerch.searchContent)) {
                    for (var i = 0;i < records.length;i++) {
                        var data = records[i].data;
                        if (queryMatch(data.category_name, rptSerch.searchContent)) {
                            createSearchList(data.category_name, data.category_udf_id);
                            rptSerch.listOnshowFlag = true;
                        }
                    }
                }
                if (rptSerch.listOnshowFlag) {
                    rptSerch.searchUl.style.display = 'block';
                } else {
                    rptSerch.searchUl.style.display = 'none';
                }
            }
            
            function createQueryUlVendorContent() {
                var records = $('rpt1010_query_vendor_ds').getAll();
                rptSerch.listOnshowFlag = false;
                rptSerch.searchUl.innerHTML = '';
                if (!Aurora.isEmpty(rptSerch.searchContent)) {
                    for (var i = 0;i < records.length;i++) {
                        var data = records[i].data;
                        if (queryMatch(data.vendor_name, rptSerch.searchContent)) {
                            createSearchList(data.vendor_name, data.vendor_id);
                            rptSerch.listOnshowFlag = true;
                        }
                    }
                }
                if (rptSerch.listOnshowFlag) {
                    rptSerch.searchUl.style.display = 'block';
                } else {
                    rptSerch.searchUl.style.display = 'none';
                }
            }
            
            function queryMatch(str1, str2) {
                if(Aurora.isEmpty(str1)){
                    return false;
                }
                if (str1.indexOf(str2) >= 0) {
                    return true;
                }
                return false;
            }
            
            function createSearchList(name, id) {
                var li = document.createElement('LI');
                li.innerText = name;
                li.onclick = querySelectFucntion;
                li.id = id;
                rptSerch.searchUl.appendChild(li);
            }
            
            function querySelectFucntion() {
                rptSerch.input.value = this.innerText;
                rptSerch.searchContent = this.innerText;
                rptSerch.selectId = this.id;
                rptSerch.searchUl.style.display = 'none';
            }
            //切换搜索类型
            function queryTabSelect(_this) {
                rptSerch.onShowTab.className = null;
                _this.className = 'active';
                rptSerch.onShowTab = _this;
                rptSerch.selectType = _this.getAttribute('type');
                rptSerch.inputInitValue = _this.getAttribute('iText');
                rptSerch.input.value = rptSerch.inputInitValue;
                rptSerch.searchUl.style.display = 'none';
                if (rptSerch.selectType == 'item') {
                    rptSerch.keyBindFunction = 'createQueryUlContent()';
                    rptSerch.searchTypeName = 'item_category_id';
                } else if (rptSerch.selectType == 'vendor') {
                    rptSerch.keyBindFunction = 'createQueryUlVendorContent()';
                    rptSerch.searchTypeName = 'vendor_id';
                }
                rptSerch.searchContent = null;
                rptSerch.selectId = null;
                if (!rptSerch.queryVendorFlag && rptSerch.selectType == 'vendor') {
                    $('rpt1010_query_vendor_ds').query();
                }
            }
            
            function rptQuery() {
                if (rptSerch.input.value == rptSerch.inputInitValue || Aurora.isEmpty(rptSerch.selectId)) {
                    showRptType(['RPT5010', 'RPT5020', 'RPT5030', 'RPT5040', 'RPT5050', 'RPT5060']);
                    rpt5010Init();
                    rpt5020Init();
                    rpt5030Init();
                    rpt5040Init();
                    rpt5050Init();
                    rpt5060Init();
                    return;
                }
                if (rptSerch.selectType == 'item') {
                    showRptType(['RPT5010', 'RPT5030', 'RPT5050', 'RPT5060']);
                    rpt5010Init(rptSerch.selectId);
                    rpt5030Init(rptSerch.selectId);
                    rpt5050Init(rptSerch.selectId);
                    rpt5060Init(rptSerch.selectId);
                } else if (rptSerch.selectType == 'vendor') {
                    showRptType(['RPT5020', 'RPT5040']);
                    rpt5020Init(rptSerch.selectId);
                    rpt5040Init(rptSerch.selectId);
                }
            }
            
            function showRptType(array) {
                for (var i = 0;i < rptObject.length;i++) {
                    if (array.indexOf(rptObject[i].code) >= 0) {
                        rptObject[i].obj.style.display = 'block';
                    } else {
                        rptObject[i].obj.style.display = 'none';
                    }
                }
            }
        ]]></script>
        <a:dataSets>
            <a:dataSet id="rpt1010_query_item_ds" autoQuery="true" fetchAll="true" model="rpt.RPT5050.pur_purchase_categories">
                <a:events>
                    <a:event name="load" handler="QueryItmeLoad"/>
                </a:events>
            </a:dataSet>
            <a:dataSet id="rpt1010_query_vendor_ds" autoQuery="false" fetchAll="true" model="public.pur_vendors_lov">
                <a:events>
                    <a:event name="load" handler="QueryVendorLoad"/>
                </a:events>
            </a:dataSet>
            <a:dataSet id="rpt1010_5010_chart_data_ds" autoQuery="false" fetchAll="true" queryUrl="${/request/@context_path}/modules/rpt/RPT1010/rpt_commom_report_category_query.svc">
                <a:fields>
                    <a:field name="period_name" prompt="RPT.RPT_PERIOD"/>
                </a:fields>
                <a:events>
                    <a:event name="load" handler="rpt5010_data_load"/>
                </a:events>
            </a:dataSet>
            <a:dataSet id="rpt1010_5010_data_option" autoQuery="false" fetchAll="true" model="rpt.RPT1010.pur_po_rp_category_name">
                <a:events>
                    <a:event name="load" handler="rpt5010_data_pre_load"/>
                </a:events>
            </a:dataSet>
            <a:dataSet id="rpt1010_5020_chart_data_ds" autoQuery="false" fetchAll="true" queryUrl="${/request/@context_path}/modules/rpt/RPT1010/rpt_commom_report_vendor_query.svc">
                <a:fields>
                    <a:field name="period_name" prompt="RPT.RPT_PERIOD"/>
                </a:fields>
                <a:events>
                    <a:event name="load" handler="rpt5020_data_load"/>
                </a:events>
            </a:dataSet>
            <a:dataSet id="rpt1010_5020_data_option" autoQuery="false" fetchAll="true" model="rpt.RPT1010.pur_po_rp_vendor_name">
                <a:events>
                    <a:event name="load" handler="rpt5020_data_pre_load"/>
                </a:events>
            </a:dataSet>
            <a:dataSet id="rpt1010_5030_chart_data_ds" autoQuery="false" fetchAll="true" model="rpt.RPT1010.pur_po_rp_column_chart_datas">
                <a:fields>
                    <a:field name="item_category_name" prompt="RPT.RPT_ITEM_CATEGORY_NAME"/>
                    <a:field name="total_amount" prompt="累计交易金额(万元)"/>
                </a:fields>
                <a:events>
                    <a:event name="load" handler="rpt5030_data_load"/>
                </a:events>
            </a:dataSet>
            <a:dataSet id="rpt1010_5040_chart_data_ds" autoQuery="false" fetchAll="true" model="rpt.RPT1010.pur_po_rp_vendor_column_chart_datas">
                <a:fields>
                    <a:field name="vendor_name" prompt="RPT.RPT_VENDOR_NAME"/>
                    <a:field name="total_amount" prompt="累计交易金额(万元)"/>
                </a:fields>
                <a:events>
                    <a:event name="load" handler="rpt5040_data_load"/>
                </a:events>
            </a:dataSet>
            <a:dataSet id="rpt1010_5050_chart_data_ds" autoQuery="false" fetchAll="true" model="rpt.RPT1010.pur_po_rp_pie_chart_datas">
                <a:fields>
                    <a:field name="company_short_name" prompt="RPT.RPT_COMPANY"/>
                    <a:field name="total_ratio" prompt="占总采购额比重"/>
                </a:fields>
                <a:events>
                    <a:event name="load" handler="rpt5050_data_load"/>
                </a:events>
            </a:dataSet>
            <a:dataSet id="rpt1010_5060_chart_data_ds" autoQuery="false" fetchAll="true" model="rpt.RPT1010.pur_po_rp_vendor_pie_chart_datas">
                <a:fields>
                    <a:field name="vendor_name" prompt="RPT.RPT_VENDOR_NAME"/>
                    <a:field name="total_ratio" prompt="占总采购额比重"/>
                </a:fields>
                <a:events>
                    <a:event name="load" handler="rpt5060_data_load"/>
                </a:events>
            </a:dataSet>
            <a:dataSet id="rpt1010_setting_ds" autoCreate="false" fetchAll="true" model="rpt.RPT1080.rpt_setting_lines">
                <a:events>
                    <a:event name="load" handler="rpt_setting_load"/>
                </a:events>
            </a:dataSet>
        </a:dataSets>
        <div class="row-query-field">
            <div class="query-tab">
                <span id="queryTab1" class="active" iText="请输入品类" onclick="queryTabSelect(this)" style="border-right:0" type="item"><![CDATA[品类]]></span>
                <span iText="请输入供应商" onclick="queryTabSelect(this)" type="vendor"><![CDATA[供应商]]></span>
            </div>
            <input id="rpt1010_query_input" onblur="queryInputOnBlur(this)" onfocus="queryInputOnfocus(this)" type="text"/>
            <ul id="rptQueryUl"/>
            <div class="query-btn" onclick="rptQuery()"><![CDATA[查询]]></div>
            <div class="query-btn" onclick="rptWholeRefresh()"><![CDATA[全部刷新]]></div>
            <div style="clear:both"/>
        </div>
        <div class="row">
            <div id="RPT5010_chart" class="handRecFairCp_widget white">
                <div class="handRecFairCp_widget_title">
                    <div class="title_left">
                        <i class="fa icon-pencil"/>
                        <span style="margin-left:5px;"><![CDATA[采购品交易额发展分析报表]]></span>
                    </div>
                    <div class="title_right">
                        <div class="widget-btn-b" onclick="openDetailRptWindow1()"><![CDATA[报表明细]]></div>
                        <div class="widget-btn-list">
                            <div class="font-refresh"><![CDATA[常用方案]]></div>
                            <div class="query-set" onclick="rptOpenSelectWindow(this)">
                                <i class="icon-caret-down"/>
                            </div>
                            <div class="query-field">
                                <ul id="rpt_setting_1"/>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="rpt1010_5010_chart" class="handRecFairCp_widget_body">
                    <a:chart backgroundColor="" bindTarget="rpt1010_5010_chart_data_ds" borderWidth="0" height="260" plotBackgroundColor="" plotBorderWidth="0" style="margin-right:10px">
                        <a:title style="font-weight:normal;font-size:14px;font-family:Microsoft YaHei" text="" x="25"/>
                        <a:legend align="right" backgroundColor="rgba(255,255,255,0.9)" borderWidth="1" floating="true" labelFormatter="rpt1010_label_format1" layout="vertical" verticalAlign="top"/>
                        <a:xAxis>
                            <a:xAxi name="period_name" gridLineWidth="0" tickLength="0">
                                <a:plotBands>
                                    <a:plotBand color="rgba(68,170,213,.2)" from="4.5" to="6.5"/>
                                </a:plotBands>
                                <a:labels rotation="-45" style="font-weight:normal;font-size:12px;font-family:Microsoft YaHei"/>
                            </a:xAxi>
                        </a:xAxis>
                        <a:yAxis>
                            <a:yAxi name="item_category_name" bindTarget="rpt1010_5010_data_option" gridLineWidth="1" minorGridLineWidth="0" tickLength="0">
                                <a:title style="font-size:12px;font-family:Microsoft YaHei" text="金额(万元)"/>
                            </a:yAxi>
                        </a:yAxis>
                        <a:tooltip formatter="rpt1010_toolFormat1" shared="true" valueSuffix="RPT.RPT1010_TEN_THOUSANDS"/>
                        <a:seriesList name="total_amount">
                            <a:seriesItem>
                                <a:fillColor linearGradient="0,0,0,300" stops="[0,Aurora.Charts.getOptions().colors[0]],                                            [1,Aurora.Charts.Color(Aurora.Charts.getOptions().colors[0]).setOpacity(0).get(&apos;rgba&apos;)]"/>
                            </a:seriesItem>
                        </a:seriesList>
                    </a:chart>
                </div>
            </div>
            <div id="RPT5020_chart" class="handRecFairCp_widget white">
                <div class="handRecFairCp_widget_title">
                    <div class="title_left">
                        <i class="fa icon-pencil"/>
                        <span style="margin-left:5px;"><![CDATA[供应商交易额发展分析报表]]></span>
                    </div>
                    <div class="title_right">
                        <div class="widget-btn-b" onclick="openDetailRptWindow2()"><![CDATA[报表明细]]></div>
                        <div class="widget-btn-list">
                            <div class="font-refresh"><![CDATA[常用方案]]></div>
                            <div class="query-set" onclick="rptOpenSelectWindow(this)">
                                <i class="icon-caret-down"/>
                            </div>
                            <div class="query-field">
                                <ul id="rpt_setting_2"/>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="rpt1010_5020_chart" class="handRecFairCp_widget_body">
                    <a:chart backgroundColor="" bindTarget="rpt1010_5020_chart_data_ds" borderWidth="0" height="260" plotBackgroundColor="" plotBorderWidth="0" style="margin-right:10px">
                        <a:title style="font-weight:normal;font-size:14px;font-family:Microsoft YaHei" text=""/>
                        <a:legend align="right" backgroundColor="rgba(255,255,255,0.9)" borderWidth="1" floating="true" labelFormatter="rpt1010_label_format2" layout="vertical" verticalAlign="top"/>
                        <a:xAxis>
                            <a:xAxi name="period_name" gridLineWidth="0" tickLength="0">
                                <a:plotBands>
                                    <a:plotBand color="rgba(68,170,213,.2)" from="4.5" to="6.5"/>
                                </a:plotBands>
                                <a:labels rotation="-45" style="font-weight:normal;font-size:12px;font-family:Microsoft YaHei"/>
                            </a:xAxi>
                        </a:xAxis>
                        <a:yAxis>
                            <a:yAxi name="vendor_name" bindTarget="rpt1010_5020_data_option" gridLineWidth="1" minorGridLineWidth="0" tickLength="0">
                                <a:title style="font-size:12px;font-family:Microsoft YaHei" text="金额(万元)"/>
                                <a:labels/>
                            </a:yAxi>
                        </a:yAxis>
                        <a:tooltip formatter="rpt1010_toolFormat2" shared="true" valueSuffix="RPT.RPT1010_TEN_THOUSANDS"/>
                        <a:seriesList name="total_amount">
                            <a:seriesItem>
                                <a:fillColor linearGradient="0,0,0,300" stops="[0,Aurora.Charts.getOptions().colors[0]],                                            [1,Aurora.Charts.Color(Aurora.Charts.getOptions().colors[0]).setOpacity(0).get(&apos;rgba&apos;)]"/>
                            </a:seriesItem>
                        </a:seriesList>
                    </a:chart>
                </div>
            </div>
            <!-- </div>
        <div class="row"> -->
            <div id="RPT5030_chart" class="handRecFairCp_widget white">
                <div class="handRecFairCp_widget_title">
                    <div class="title_left">
                        <i class="fa icon-pencil"/>
                        <span style="margin-left:5px;"><![CDATA[采购品交易额榜单报表]]></span>
                    </div>
                    <div class="title_right">
                        <div class="widget-btn-b" onclick="openDetailRptWindow3()"><![CDATA[报表明细]]></div>
                        <div class="widget-btn-list">
                            <div class="font-refresh"><![CDATA[常用方案]]></div>
                            <div class="query-set" onclick="rptOpenSelectWindow(this)">
                                <i class="icon-caret-down"/>
                            </div>
                            <div class="query-field">
                                <ul id="rpt_setting_3"/>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="rpt1010_5030_chart" class="handRecFairCp_widget_body">
                    <a:chart backgroundColor="" bindTarget="rpt1010_5030_chart_data_ds" borderWidth="0" height="260" plotBackgroundColor="" plotBorderWidth="0" style="margin-right:10px" type="column">
                        <a:title style="font-weight:normal;font-size:14px;font-family:Microsoft YaHei" text="${l:RPT.RPT1010_ITEM_LIST_RPT}"/>
                        <a:xAxis>
                            <a:xAxi name="item_category_name" gridLineWidth="0" tickLength="0">
                                <a:labels rotation="-30" style="font-weight:normal;font-size:12px;font-family:Microsoft YaHei"/>
                            </a:xAxi>
                        </a:xAxis>
                        <a:yAxis>
                            <a:yAxi name="total_amount" allowDecimals="false" gridLineWidth="1" min="0" minorGridLineWidth="0" tickLength="0">
                                <a:title style="font-size:12px;font-family:Microsoft YaHei" text="金额(万元)"/>
                                <a:labels/>
                            </a:yAxi>
                        </a:yAxis>
                        <a:tooltip formatter="rpt1010_formatter1"/>
                        <a:plotOptions>
                            <a:chartcolumn stacking="normal"/>
                        </a:plotOptions>
                    </a:chart>
                </div>
            </div>
            <div id="RPT5040_chart" class="handRecFairCp_widget white">
                <div class="handRecFairCp_widget_title">
                    <div class="title_left">
                        <i class="fa icon-pencil"/>
                        <span style="margin-left:5px;"><![CDATA[供应商交易额榜单报表]]></span>
                    </div>
                    <div class="title_right">
                        <div class="widget-btn-b" onclick="openDetailRptWindow4()"><![CDATA[报表明细]]></div>
                        <div class="widget-btn-list">
                            <div class="font-refresh"><![CDATA[常用方案]]></div>
                            <div class="query-set" onclick="rptOpenSelectWindow(this)">
                                <i class="icon-caret-down"/>
                            </div>
                            <div class="query-field">
                                <ul id="rpt_setting_4"/>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="rpt1010_5040_chart" class="handRecFairCp_widget_body">
                    <a:chart backgroundColor="" bindTarget="rpt1010_5040_chart_data_ds" borderWidth="0" height="260" plotBackgroundColor="" plotBorderWidth="0" style="margin-right:10px" type="column">
                        <a:title style="font-weight:normal;font-size:14px;font-family:Microsoft YaHei" text="${l:RPT.RPT1010_VENDOR_LIST_RPT}"/>
                        <a:xAxis>
                            <a:xAxi name="vendor_name" gridLineWidth="0" tickLength="0">
                                <a:labels formatter="rpt1010_column_label_format1" rotation="-30" style="font-weight:normal;font-size:12px;font-family:Microsoft YaHei"/>
                            </a:xAxi>
                        </a:xAxis>
                        <a:yAxis>
                            <a:yAxi name="total_amount" allowDecimals="false" gridLineWidth="1" min="0" minorGridLineWidth="0" tickLength="0">
                                <a:title style="font-size:12px;font-family:Microsoft YaHei" text="金额(万元)"/>
                                <a:labels/>
                            </a:yAxi>
                        </a:yAxis>
                        <a:tooltip formatter="rpt1010_formatter1"/>
                        <a:plotOptions>
                            <a:chartcolumn stacking="normal"/>
                        </a:plotOptions>
                    </a:chart>
                </div>
            </div>
            <!-- </div>
        <div class="row"> -->
            <div id="RPT5050_chart" class="handRecFairCp_widget white">
                <div class="handRecFairCp_widget_title">
                    <div class="title_left">
                        <i class="fa icon-pencil"/>
                        <span style="margin-left:5px;"><![CDATA[采购品各机构占比分析报表]]></span>
                    </div>
                    <div class="title_right">
                        <div class="widget-btn-b" onclick="openDetailRptWindow5()"><![CDATA[报表明细]]></div>
                        <div class="widget-btn-list">
                            <div class="font-refresh"><![CDATA[常用方案]]></div>
                            <div class="query-set" onclick="rptOpenSelectWindow(this)">
                                <i class="icon-caret-down"/>
                            </div>
                            <div class="query-field">
                                <ul id="rpt_setting_5"/>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="rpt1010_5050_chart" class="handRecFairCp_widget_body">
                    <a:chart backgroundColor="" bindTarget="rpt1010_5050_chart_data_ds" borderWidth="0" height="260" plotBackgroundColor="" plotBorderWidth="null" plotShadow="false" style="margin-right:10px" type="pie">
                        <a:title style="font-weight:normal;font-size:14px;font-family:Microsoft YaHei" text="${l:RPT.RPT1010_ITEM_ORG_FORM_RPT}"/>
                        <a:tooltip pointFormat="{series.name}: &lt;b&gt;{point.percentage:.1f}%&lt;/b&gt;"/>
                        <a:plotOptions>
                            <a:pie allowPointSelect="true" cursor="pointer">
                                <a:dataLabels color="#000" connectorColor="#000" enabled="true" formatter="rpt1010_formatter2" style="font-weight:normal;font-size:12px;font-family:Microsoft YaHei"/>
                            </a:pie>
                        </a:plotOptions>
                        <a:xAxis>
                            <a:xAxi name="company_short_name"/>
                        </a:xAxis>
                        <a:yAxis>
                            <a:yAxi name="total_ratio" allowDecimals="true"/>
                        </a:yAxis>
                        <a:seriesList>
                            <a:seriesItem name="total_ratio">
                                <a:seriesDatas>
                                    <a:seriesData dataIndex="2" selected="true" sliced="true"/>
                                </a:seriesDatas>
                            </a:seriesItem>
                        </a:seriesList>
                        <a:plotOptions>
                            <a:pie borderWidth="0"/>
                        </a:plotOptions>
                    </a:chart>
                </div>
            </div>
            <div id="RPT5060_chart" class="handRecFairCp_widget white">
                <div class="handRecFairCp_widget_title">
                    <div class="title_left">
                        <i class="fa icon-pencil"/>
                        <span style="margin-left:5px;"><![CDATA[采购品供应商占比分析报表]]></span>
                    </div>
                    <div class="title_right">
                        <div class="widget-btn-b" onclick="openDetailRptWindow6()"><![CDATA[报表明细]]></div>
                        <div class="widget-btn-list">
                            <div class="font-refresh"><![CDATA[常用方案]]></div>
                            <div class="query-set" onclick="rptOpenSelectWindow(this)">
                                <i class="icon-caret-down"/>
                            </div>
                            <div class="query-field">
                                <ul id="rpt_setting_6"/>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="rpt1010_5060_chart" class="handRecFairCp_widget_body">
                    <a:chart backgroundColor="" bindTarget="rpt1010_5060_chart_data_ds" borderWidth="0" height="260" plotBackgroundColor="" plotBorderWidth="null" plotShadow="false" style="margin-right:10px" type="pie">
                        <a:title style="font-weight:normal;font-size:14px;font-family:Microsoft YaHei" text="${l:RPT.RPT1010_VENDOR_ORG_FORM_RPT}"/>
                        <a:tooltip pointFormat="{series.name}: &lt;b&gt;{point.percentage:.1f}%&lt;/b&gt;"/>
                        <a:plotOptions>
                            <a:pie allowPointSelect="true" cursor="pointer">
                                <a:dataLabels color="#000" connectorColor="#000" enabled="true" formatter="rpt1010_formatter2" style="font-weight:normal;font-size:12px;font-family:Microsoft YaHei"/>
                            </a:pie>
                        </a:plotOptions>
                        <a:xAxis>
                            <a:xAxi name="vendor_name"/>
                        </a:xAxis>
                        <a:yAxis>
                            <a:yAxi name="total_ratio" allowDecimals="true"/>
                        </a:yAxis>
                        <a:seriesList>
                            <a:seriesItem name="total_ratio">
                                <a:seriesDatas>
                                    <a:seriesData dataIndex="2" selected="true" sliced="true"/>
                                </a:seriesDatas>
                            </a:seriesItem>
                        </a:seriesList>
                    </a:chart>
                </div>
            </div>
        </div>
        <script><![CDATA[
            Aurora.onReady(function() {
                rpt1010_query_init();
            });
        ]]></script>
    </a:view>
</a:screen>
