<?xml version="1.0" encoding="UTF-8"?>
<ns1:model xmlns:ns1="http://www.aurora-framework.org/schema/bm">
    <ns1:fields>
        <ns1:field name="qms_8d_snap_id" databaseType="NUMBER" datatype="java.lang.Long" physicalName="QMS_8D_SNAP_ID" prompt="快照ID"/>
        <ns1:field name="qms_8d_id" databaseType="NUMBER" datatype="java.lang.Long" physicalName="QMS_8D_ID" prompt="QMS_8D.QMS_8D_ID"/>
        <ns1:field name="qms_8d_code" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="QMS_8D_CODE" prompt="QMS_8D.QMS_8D_CODE"/>
        <ns1:field name="qms_8d_title" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="QMS_8D_TITLE" prompt="QMS_8D.QMS_8D_TITLE"/>
        <ns1:field name="status" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="STATUS" prompt="QMS_8D.STATUS_DISPLAY"/>
        <ns1:field name="issue_type" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="ISSUE_TYPE"/>
        <ns1:field name="vendor_id" databaseType="NUMBER" datatype="java.lang.Long" physicalName="VENDOR_ID" prompt="供应商ID"/>
        <ns1:field name="vendor_code" prompt="PUR_VENDORS.VENDOR_CODE"/>
        <ns1:field name="vendor_desc" prompt="PUR_VENDORS.VENDOR_NAME"/>
        <ns1:field name="company_id" databaseType="NUMBER" datatype="java.lang.Long" physicalName="COMPANY_ID" prompt="公司ID"/>
        <ns1:field name="company_code" prompt="FND_COMPANIES.COMPANY_CODE"/>
        <ns1:field name="company_desc" prompt="FND_COMPANIES.NAME"/>
        <ns1:field name="inv_organization_id" databaseType="NUMBER" datatype="java.lang.Long" physicalName="INV_ORGANIZATION_ID" prompt="工厂ID"/>
        <ns1:field name="inv_organization_code" prompt="INV_ORGANIZATIONS.INV_ORGANIZATION_CODE"/>
        <ns1:field name="inv_organization_desc" prompt="INV_ORGANIZATIONS.DESCRIPTION"/>
        <ns1:field name="item_id" databaseType="NUMBER" datatype="java.lang.Long" physicalName="ITEM_ID" prompt="物品ID"/>
        <ns1:field name="item_code" prompt="MTL_SYSTEM_ITEMS.ITEM_CODE"/>
        <ns1:field name="item_name" prompt="MTL_SYSTEM_ITEMS.ITEM_NAME"/>
        <ns1:field name="ica_require_date" databaseType="DATE" datatype="java.util.Date" physicalName="ICA_REQUIRE_DATE" prompt="QMS_8D.ICA_REQUIRE_DATE"/>
        <ns1:field name="pca_require_date" databaseType="DATE" datatype="java.util.Date" physicalName="PCA_REQUIRE_DATE" prompt="QMS_8D.PCA_REQUIRE_DATE"/>
        <ns1:field name="release_date" databaseType="DATE" datatype="java.util.Date" physicalName="RELEASE_DATE" prompt="QMS_8D.RELEASE_DATE"/>
        <ns1:field name="release_by" databaseType="NUMBER" datatype="java.lang.Long" physicalName="RELEASE_BY" prompt="QMS_8D.RELEASE_BY"/>
        <ns1:field name="finish_date" databaseType="DATE" datatype="java.util.Date" physicalName="FINISH_DATE" prompt="QMS_8D.FINISH_DATE"/>
        <ns1:field name="comments" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="COMMENTS" prompt="QMS_8D.COMMENTS"/>
        <ns1:field name="issue_desc" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="ISSUE_DESC" prompt="QMS_8D.ISSUE_DESC"/>
        <ns1:field name="importance_degree" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="IMPORTANCE_DEGREE" prompt="QMS_8D.IMPORTANCE_DEGREE"/>
        <ns1:field name="urgency_degree" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="URGENCY_DEGREE" prompt="QMS_8D.URGENCY_DEGREE"/>
        <ns1:field name="version" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="VERSION" prompt="QMS_8D.VERSION"/>
        <ns1:field name="inventory_affect_flag" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="INVENTORY_AFFECT_FLAG" prompt="QMS_8D.INVENTORY_AFFECT_FLAG"/>
        <ns1:field name="inventory_affect_measure" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="INVENTORY_AFFECT_MEASURE" prompt="QMS_8D.INVENTORY_AFFECT_MEASURE"/>
        <ns1:field name="inventory_affect_desc" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="INVENTORY_AFFECT_DESC" prompt="QMS_8D.INVENTORY_AFFECT_DESC"/>
        <ns1:field name="process_affect_flag" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="PROCESS_AFFECT_FLAG" prompt="QMS_8D.PROCESS_AFFECT_FLAG"/>
        <ns1:field name="process_affect_measure" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="PROCESS_AFFECT_MEASURE" prompt="QMS_8D.PROCESS_AFFECT_MEASURE"/>
        <ns1:field name="process_affect_desc" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="PROCESS_AFFECT_DESC" prompt="QMS_8D.PROCESS_AFFECT_DESC"/>
        <ns1:field name="transporting_affect_flag" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="TRANSPORTING_AFFECT_FLAG" prompt="QMS_8D.TRANSPORTING_AFFECT_FLAG"/>
        <ns1:field name="transporting_affect_measure" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="TRANSPORTING_AFFECT_MEASURE" prompt="QMS_8D.TRANSPORTING_AFFECT_MEASURE"/>
        <ns1:field name="transporting_affect_desc" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="TRANSPORTING_AFFECT_DESC" prompt="QMS_8D.TRANSPORTING_AFFECT_DESC"/>
        <ns1:field name="custom_stock_affect_flag" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="CUSTOM_STOCK_AFFECT_FLAG" prompt="QMS_8D.CUSTOM_STOCK_AFFECT_FLAG"/>
        <ns1:field name="custom_stock_affect_measure" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="CUSTOM_STOCK_AFFECT_MEASURE" prompt="QMS_8D.CUSTOM_STOCK_AFFECT_MEASURE"/>
        <ns1:field name="custom_stock_affect_desc" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="CUSTOM_STOCK_AFFECT_DESC" prompt="QMS_8D.CUSTOM_STOCK_AFFECT_DESC"/>
        <ns1:field name="item_reivew_count" databaseType="NUMBER" datatype="java.lang.Long" physicalName="ITEM_REIVEW_COUNT" prompt="QMS_8D.ITEM_REIVEW_COUNT"/>
        <ns1:field name="item_trouble_count" databaseType="NUMBER" datatype="java.lang.Long" physicalName="ITEM_TROUBLE_COUNT" prompt="QMS_8D.ITEM_TROUBLE_COUNT"/>
        <ns1:field name="measure_desc" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="MEASURE_DESC" prompt="QMS_8D.MEASURE_DESC"/>
        <ns1:field name="measure_check" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="MEASURE_CHECK" prompt="QMS_8D.MEASURE_CHECK"/>
        <ns1:field name="reason_type" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="REASON_TYPE" prompt="QMS_8D.REASON_TYPE"/>
        <ns1:field name="reason_desc" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="REASON_DESC" prompt="QMS_8D.REASON_DESC"/>
        <ns1:field name="unhappen_desc" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="UNHAPPEN_DESC" prompt="QMS_8D.UNHAPPEN_DESC"/>
        <ns1:field name="prevent_occur_measure" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="PREVENT_OCCUR_MEASURE" prompt="QMS_8D.PREVENT_OCCUR_MEASURE"/>
        <ns1:field name="prevent_check_measure" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="PREVENT_CHECK_MEASURE" prompt="QMS_8D.PREVENT_CHECK_MEASURE"/>
        <ns1:field name="other_item_flag" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="OTHER_ITEM_FLAG" prompt="QMS_8D.OTHER_ITEM_FLAG"/>
        <ns1:field name="other_process_flag" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="OTHER_PROCESS_FLAG" prompt="QMS_8D.OTHER_PROCESS_FLAG"/>
        <ns1:field name="other_place_flag" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="OTHER_PLACE_FLAG" prompt="QMS_8D.OTHER_PLACE_FLAG"/>
        <ns1:field name="project_deal_flag" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="PROJECT_DEAL_FLAG" prompt="QMS_8D.PROJECT_DEAL_FLAG"/>
        <ns1:field name="permanent_measure_effect" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="PERMANENT_MEASURE_EFFECT" prompt="QMS_8D.PERMANENT_MEASURE_EFFECT"/>
        <ns1:field name="prevent_desc" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="PREVENT_DESC" prompt="QMS_8D.PREVENT_DESC"/>
        <ns1:field name="fmea_flag" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="FMEA_FLAG" prompt="FMEA"/>
        <ns1:field name="control_flag" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="CONTROL_FLAG" prompt="QMS_8D.CONTROL_FLAG"/>
        <ns1:field name="flowchart_flag" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="FLOWCHART_FLAG" prompt="QMS_8D.FLOWCHART_FLAG"/>
        <ns1:field name="cooperation_effect" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="COOPERATION_EFFECT" prompt="QMS_8D.COOPERATION_EFFECT"/>
        <ns1:field name="approve_action" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="APPROVE_ACTION" prompt="QMS_8D.APPROVE_ACTION"/>
        <ns1:field name="approve_opinion" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="APPROVE_OPINION" prompt="QMS_8D.APPROVE_OPINION"/>
        <ns1:field name="delete_by" databaseType="NUMBER" datatype="java.lang.Long" physicalName="DELETE_BY" prompt="QMS_8D.DELETE_BY"/>
        <ns1:field name="delete_date" databaseType="DATE" datatype="java.util.Date" physicalName="DELETE_DATE" prompt="QMS_8D.DELETE_DATE"/>
        <ns1:field name="ica_delay_days" databaseType="NUMBER" datatype="java.lang.Double" physicalName="ICA_DELAY_DAYS" prompt="QMS_8D.ICA_DELAY_DAYS"/>
        <ns1:field name="pca_delay_days" databaseType="NUMBER" datatype="java.lang.Double" physicalName="PCA_DELAY_DAYS" prompt="QMS_8D.PCA_DELAY_DAYS"/>
        <ns1:field name="open_days" databaseType="NUMBER" datatype="java.lang.Double" physicalName="OPEN_DAYS" prompt="QMS_8D.OPEN_DAYS"/>
        <ns1:field name="processing_status" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="PROCESSING_STATUS" prompt="QMS_8D.PROCESSING_STATUS"/>
        <ns1:field name="data_source" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="DATA_SOURCE" prompt="PROMPT.DATA_SOURCE"/>
        <ns1:field name="data_source_id" databaseType="NUMBER" datatype="java.lang.Long" physicalName="DATA_SOURCE_ID" prompt="QMS_8D.DATA_SOURCE_ID"/>
        <ns1:field name="data_source_code" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="DATA_SOURCE_CODE" prompt="QMS_8D.DATA_SOURCE_CODE"/>
        <ns1:field name="data_source_desc" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="DATA_SOURCE_DESC" prompt="QMS_8D.DATA_SOURCE_DESC"/>
        <ns1:field name="project_code" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="PROJECT_CODE" prompt="QMS_8D.PROJECT_CODE"/>
        <ns1:field name="attribute_1" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="ATTRIBUTE_1"/>
        <ns1:field name="attribute_2" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="ATTRIBUTE_2"/>
        <ns1:field name="attribute_3" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="ATTRIBUTE_3"/>
        <ns1:field name="attribute_4" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="ATTRIBUTE_4"/>
        <ns1:field name="attribute_5" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="ATTRIBUTE_5"/>
        <ns1:field name="attribute_6" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="ATTRIBUTE_6"/>
        <ns1:field name="attribute_7" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="ATTRIBUTE_7"/>
        <ns1:field name="attribute_8" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="ATTRIBUTE_8"/>
        <ns1:field name="attribute_9" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="ATTRIBUTE_9"/>
        <ns1:field name="attribute_10" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="ATTRIBUTE_10"/>
        <ns1:field name="created_by_name" prompt="QMS_8D.USER_NAME"/>
        <ns1:field name="created_date" prompt="QMS_8D.CREATED_DATE"/>
        <ns1:field name="owner_business_group" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="OWNER_BUSINESS_GROUP"/>
        <ns1:field name="owner_company_id" databaseType="NUMBER" datatype="java.lang.Long" physicalName="OWNER_COMPANY_ID"/>
        <ns1:field name="coop_business_group" databaseType="VARCHAR2" datatype="java.lang.String" physicalName="COOP_BUSINESS_GROUP"/>
        <ns1:field name="coop_company_id" databaseType="NUMBER" datatype="java.lang.Long" physicalName="COOP_COMPANY_ID"/>
        <ns1:field name="coop_company_code" prompt="PUR_VENDORS.VENDOR_CODE"/>
        <ns1:field name="coop_company_desc" prompt="PUR_VENDORS.VENDOR_NAME"/>
        <ns1:field name="coop_partner_id" databaseType="NUMBER" datatype="java.lang.Long" physicalName="COOP_PARTNER_ID"/>
        <ns1:field name="send_date"/>
        <ns1:field name="discovery"/>
        <ns1:field name="discovery_date"/>
        <ns1:field name="customer_name"/>
        <ns1:field name="complaints"/>
        <ns1:field name="complaint_location"/>
        <ns1:field name="order_num"/>
        <ns1:field name="shipments"/>
        <ns1:field name="shipping_qty"/>
        <ns1:field name="bad_quantity"/>
        <ns1:field name="adverse_rate"/>
        <ns1:field name="sampling_quantity"/>
        <ns1:field name="repeat_happen_flag"/>
        <ns1:field name="abnormal_source_code"/>
        <ns1:field name="abnormal_source"/>
    </ns1:fields>
    <ns1:query-fields>
        <ns1:query-field name="user_id" queryExpression="v.created_by = ${@user_id}"/>
        <ns1:query-field name="qms_8d_snap_id" queryExpression="v.qms_8d_snap_id = ${@qms_8d_snap_id}"/>
        <ns1:query-field name="qms_8d_code" queryExpression="v.qms_8d_code like &apos;%&apos;||upper(${@qms_8d_code})||&apos;%&apos;"/>
        <ns1:query-field name="qms_8d_id" queryExpression="v.qms_8d_id = ${@qms_8d_id}"/>
        <ns1:query-field name="vendor_id" queryExpression="v.vendor_id = ${@vendor_id}"/>
        <ns1:query-field name="item_id" queryExpression="v.item_id = ${@item_id}"/>
        <ns1:query-field name="coop_company_id" queryExpression="v.coop_company_id = ${@coop_company_id}"/>
        <ns1:query-field name="inv_organization_id" queryExpression="v.inv_organization_id = ${@inv_organization_id}"/>
        <ns1:query-field name="creation_date_from" queryExpression="trunc(v.creation_date) &gt;= to_date(${@creation_date_from}, &apos;yyyy-mm-dd&apos;)"/>
        <ns1:query-field name="creation_date_to" queryExpression="trunc(v.creation_date) &lt;= to_date(${@creation_date_to}, &apos;yyyy-mm-dd&apos;)"/>
        <ns1:query-field name="pca_require_date_from" queryExpression="trunc(v.pca_require_date) &gt;= to_date(${@pca_require_date_from}, &apos;yyyy-mm-dd&apos;)"/>
        <ns1:query-field name="pca_require_date_to" queryExpression="trunc(v.pca_require_date) &lt;= to_date(${@pca_require_date_to}, &apos;yyyy-mm-dd&apos;)"/>
        <ns1:query-field name="ica_delay_days_from" queryExpression=" to_number(nvl(v.ica_delay_days,0)) &gt;= to_number(${@ica_delay_days_from}) "/>
        <ns1:query-field name="pca_delay_days_from" queryExpression=" to_number(nvl(v.pca_delay_days,0)) &gt;= to_number(${@pca_delay_days_from})"/>
        <ns1:query-field name="open_days_from" queryExpression="to_number(nvl(v.open_days,0)) &gt;= to_number(${@open_days_from})"/>
        <ns1:query-field name="status" queryExpression="v.status = ${@status}"/>
        <ns1:query-field name="issue_type" queryExpression="v.issue_type = ${@issue_type}"/>
        <ns1:query-field name="project_code" queryExpression="v.project_code like &apos;%&apos;||${@project_code}||&apos;%&apos;"/>
    </ns1:query-fields>
    <!--     
    <ns1:data-filters>
        <ns1:data-filter name="filter" expression="t1.status in (&apos;MEASURE_APPROVING&apos;, &apos;PER_MEASURE_APPROVING&apos;) and t1.owner_business_group = ${/session/@business_group}"/>
    </ns1:data-filters>  -->
    <ns1:operations>
        <ns1:operation name="query">
            <ns1:query-sql><![CDATA[
	    		select * from (select t1.qms_8d_snap_id,
	    		   t1.qms_8d_id,
			       t1.qms_8d_code,
			       t1.qms_8d_title,
			       t1.status,
			       t1.issue_type,
			       t1.vendor_id,
			       (select pvv.display_vendor_code vendor_code
			          from pur_vendors_vl pvv
			         where pvv.vendor_id = t1.vendor_id) as vendor_code,
			       (select nvl(pvv.short_name, pvv.full_name)
			          from pur_vendors_vl pvv
			         where pvv.vendor_id = t1.vendor_id) as vendor_desc,
			       t1.company_id,
			       (select fcv.company_code
			          from fnd_companies_vl fcv
			         where fcv.company_id = t1.company_id) as company_code,
			       (select nvl(fcv.company_short_name, fcv.company_full_name) company_desc
			          from fnd_companies_vl fcv
			         where fcv.company_id = t1.company_id) as company_desc,
			       t1.inv_organization_id,
			       (select iov.inv_organization_code
			          from inv_organizations_vl iov
			         where iov.inv_organization_id = t1.inv_organization_id) as inv_organization_code,
			       (select iov.description
			          from inv_organizations_vl iov
			         where iov.inv_organization_id = t1.inv_organization_id) as inv_organization_desc,
			       t1.item_id,
			       (select msiv.display_item_code item_code
			          from mtl_system_items_vl msiv
			         where msiv.item_id = t1.item_id) as item_code,
			       (select msiv.item_name description
			          from mtl_system_items_vl msiv
			         where msiv.item_id = t1.item_id) as item_name,
			       t1.ica_require_date,
			       t1.pca_require_date,
			       t1.release_date,
			       (round(sysdate - release_date, 2)) as open_days,
			       t1.release_by,
			       t1.finish_date,
			       t1.comments,
			       t1.importance_degree,
			       t1.urgency_degree,
			       t1.version,
			       t1.issue_desc,
			       t1.inventory_affect_flag,
			       t1.inventory_affect_measure,
			       t1.inventory_affect_desc,
			       t1.process_affect_flag,
			       t1.process_affect_measure,
			       t1.process_affect_desc,
			       t1.transporting_affect_flag,
			       t1.transporting_affect_measure,
			       t1.transporting_affect_desc,
			       t1.custom_stock_affect_flag,
			       t1.custom_stock_affect_measure,
			       t1.custom_stock_affect_desc,
			       t1.item_reivew_count,
			       t1.item_trouble_count,
			       t1.measure_desc,
			       t1.measure_check,
			       t1.reason_type,
			       t1.reason_desc,
			       t1.unhappen_desc,
			       t1.prevent_occur_measure,
			       t1.prevent_check_measure,
			       t1.other_item_flag,
			       t1.other_process_flag,
			       t1.other_place_flag,
			       t1.project_deal_flag,
			       t1.permanent_measure_effect,
			       t1.prevent_desc,
			       t1.fmea_flag,
			       t1.control_flag,
			       t1.flowchart_flag,
			       t1.cooperation_effect,
			       t1.approve_action,
			       t1.approve_opinion,
			       t1.delete_by,
			       t1.delete_date,
			       (qms_8d_pkg.get_ica_delay_days(t1.status,
			                                      t1.ica_require_date,
			                                      t1.ica_delay_days)) as ica_delay_days,
			       (qms_8d_pkg.get_pca_delay_days(t1.status,
			                                      t1.pca_require_date,
			                                      t1.pca_delay_days)) as pca_delay_days,
			       t1.processing_status,
			       t1.data_source,
			       t1.data_source_id,
			       t1.data_source_code,
			       t1.data_source_desc,
			       t1.project_code,
			       t1.attribute_1,
			       t1.attribute_2,
			       t1.attribute_3,
			       t1.attribute_4,
			       t1.attribute_5,
			       t1.attribute_6,
			       t1.attribute_7,
			       t1.attribute_8,
			       t1.attribute_9,
			       t1.attribute_10,
			       t1.created_by,
			       (select su.description
			          from sys_user su
			         where su.user_id = t1.created_by) as created_by_name,
			       (to_char(t1.creation_date, 'yyyy-mm-dd ')) as created_date,
			       t1.owner_business_group,
			       t1.owner_company_id,
			       t1.coop_business_group,
			       t1.coop_company_id,
			       (select fcv.company_code
			          from fnd_companies_vl fcv
			         where fcv.company_id = t1.coop_company_id) as coop_company_code,
			       (select nvl(fcv.company_short_name, fcv.company_full_name) company_desc
			          from fnd_companies_vl fcv
			         where fcv.company_id = t1.coop_company_id) as coop_company_desc,
			       t1.coop_partner_id,
			       to_char(t1.send_date,'yyyy-mm-dd') as send_date,
          		   t1.discovery,
       			   to_char(t1.discovery_date,'yyyy-mm-dd') as discovery_date,
        		   t1.customer_name,
                   t1.complaints,
                   t1.complaint_location,
        		   t1.order_num,
        		   t1.shipments,
        		   t1.shipping_qty,
         	       t1.bad_quantity,
        		   t1.adverse_rate,
        		   t1.sampling_quantity,
        		   t1.repeat_happen_flag,
        		   (SELECT v.flex_desc 
        		      FROM fnd_flex_values_vl v,
        		           fnd_flex_value_sets s 
        		     WHERE v.flex_value_set_id = s.flex_value_set_id
        		       AND s.enabled_flag = 'Y' 
        		       AND s.flex_value_set_code = 'ABNORMAL_SOURCE' 
        		       AND v.flex_value = t1.abnormal_source) abnormal_source,
        		    abnormal_source abnormal_source_code
			  from qms_8d_snap t1
			 where  t1.owner_business_group = ${/session/@business_group}) v
			 #WHERE_CLAUSE#
	    	]]></ns1:query-sql>
        </ns1:operation>
        <!--   <ns1:operation name="insert">
            <ns1:update-sql><![CDATA[
    			begin
				  qms_8d_pkg.approval_8d(p_qms_8d_id       => ${@qms_8d_id},
				                         p_approve_action  => ${@approve_action},
				                         p_approve_opinion => ${@approve_opinion},
				                         p_user_id         => ${/session/@user_id});
				end;
    		]]></ns1:update-sql>
        </ns1:operation>
        <ns1:operation name="update">
            <ns1:update-sql><![CDATA[
    			begin
				  qms_8d_pkg.reject_8d(p_qms_8d_id       => ${@qms_8d_id},
			                           p_approve_action  => ${@approve_action},
			                           p_approve_opinion => ${@approve_opinion},
			                           p_user_id         => ${/session/@user_id});
				end;
    		]]></ns1:update-sql>
        </ns1:operation>
        <ns1:operation name="execute">
            <ns1:update-sql><![CDATA[
    			begin
				  qms_8d_pkg.disable_8d(p_qms_8d_id       => ${@qms_8d_id},
			                            p_approve_opinion => ${@approve_opinion},
			                            p_user_id         => ${/session/@user_id});
				end;
    		]]></ns1:update-sql>
        </ns1:operation>  -->
    </ns1:operations>
</ns1:model>
